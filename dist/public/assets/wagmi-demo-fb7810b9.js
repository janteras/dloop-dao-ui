import{a5 as G,a6 as F,a7 as Q,a8 as Y,a9 as z,aa as J,ab as le,ac as ce,ad as oe,ae as de,af as me,ag as V,r as j,R as X,j as e,h as x,ah as xe,B,ai as Z,aj as ee}from"./index-e1be7c10.js";import{g as ue,u as M,a as he,b as fe,c as je,S as ge}from"./switch-ca05c69b.js";import{S as O}from"./skeleton-77e1d972.js";import{T as be,a as pe,b as ye,c as Ne}from"./tooltip-1e1e2a4e.js";import{C as we}from"./index-c43f57c1.js";import{C as ve}from"./countdown-timer-3cae2c82.js";import{E as Te}from"./external-link-3b92b860.js";import{P as I,U as se}from"./UnifiedProposalCard-a5b0458b.js";import{T as q,a as H,b,c as p}from"./tabs-02bc0b10.js";import"./vote-helpers-5e69d632.js";import"./contracts-3445139a.js";import"./clock-8783fbb7.js";import"./card-3ad46239.js";import"./provider-infura-b77f0efa.js";import"./useWallet-45da9ffa.js";import"./useTokenInfo-41555799.js";import"./contracts-7ce1c1bb.js";import"./circle-check-big-e37d016f.js";async function Ce(t,n){const{address:a,chainId:r,formatUnits:o=18}=n;function m(i){return[{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"name",stateMutability:"view",inputs:[],outputs:[{type:i}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:i}]},{type:"function",name:"totalSupply",stateMutability:"view",inputs:[],outputs:[{type:"uint256"}]}]}try{const i=m("string"),l={address:a,abi:i,chainId:r},[d,c,h,u]=await G(t,{allowFailure:!0,contracts:[{...l,functionName:"decimals"},{...l,functionName:"name"},{...l,functionName:"symbol"},{...l,functionName:"totalSupply"}]});if(c.error instanceof F)throw c.error;if(h.error instanceof F)throw h.error;if(d.error)throw d.error;if(u.error)throw u.error;return{address:a,decimals:d.result,name:c.result,symbol:h.result,totalSupply:{formatted:Q(u.result,Y(o)),value:u.result}}}catch(i){if(i instanceof F){const l=m("bytes32"),d={address:a,abi:l,chainId:r},[c,h,u,f]=await G(t,{allowFailure:!1,contracts:[{...d,functionName:"decimals"},{...d,functionName:"name"},{...d,functionName:"symbol"},{...d,functionName:"totalSupply"}]});return{address:a,decimals:c,name:z(J(h,{dir:"right"})),symbol:z(J(u,{dir:"right"})),totalSupply:{formatted:Q(f,Y(o)),value:f}}}throw i}}function ke(t,n={}){return{async queryFn({queryKey:a}){const{address:r,scopeKey:o,...m}=a[1];if(!r)throw new Error("address is required");return Ce(t,{...m,address:r})},queryKey:Se(n)}}function Se(t={}){return["token",le(t)]}function Ve(t={}){const{address:n,query:a={}}=t,r=ce(t),o=oe({config:r}),m=ke(r,{...t,chainId:t.chainId??o}),i=!!(n&&(a.enabled??!0));return de({...a,...m,enabled:i})}function ne(t){const n=t?ue(t):{address:"0x0",abi:[]},{data:a,isLoading:r}=M({...n,functionName:"symbol",query:{enabled:!!t}}),{data:o,isLoading:m}=M({...n,functionName:"name",query:{enabled:!!t}}),{data:i,isLoading:l}=M({...n,functionName:"decimals",query:{enabled:!!t}});return{symbol:a,name:o,decimals:i?Number(i):18,isLoading:r||m||l}}function Ie(t,n){const{data:a,isLoading:r,error:o,refetch:m}=me({address:n,token:t}),{decimals:i}=ne(t);return{balance:a?Q(a.value,a.decimals||i):"0",rawBalance:a==null?void 0:a.value,isLoading:r,error:o,refetch:m}}function Ee(t){const n=V(i=>i.useWagmi),a=V(i=>i.markComponentMigrated);j.useEffect(()=>{a("TokenHandling")},[a]);const{data:r,isLoading:o}=Ve({address:t,query:{enabled:n}});return n&&r?{symbol:r.symbol,name:r.name,decimals:r.decimals,isLoading:o}:{...he(t),isLoading:!1}}const E=({tokenAddress:t,amount:n,showIcon:a=!0,showSymbol:r=!0,showName:o=!1,clickableAddress:m=!1,size:i="md",className:l="",amountFormatter:d,...c})=>{const[h,u]=X.useState(!1),{symbol:f,name:W,isLoading:$}=Ee(t),R=()=>{navigator.clipboard.writeText(t),u(!0),setTimeout(()=>u(!1),2e3)},U=()=>`https://sepolia.etherscan.io/token/${t}`,L={sm:"text-xs",md:"text-sm",lg:"text-base"};if($)return e.jsxs("div",{className:x("flex items-center space-x-2",l),...c,children:[a&&e.jsx(O,{className:"h-6 w-6 rounded-full"}),e.jsxs("div",{className:"flex flex-col",children:[r&&e.jsx(O,{className:"h-4 w-16"}),o&&e.jsx(O,{className:"h-3 w-24 mt-1"})]})]});const T=X.useMemo(()=>n?d?d(n):(Number(n)/10**18).toLocaleString(void 0,{maximumFractionDigits:6}):"",[n,d]);return e.jsxs("div",{className:x("flex items-center",L[i],l),...c,children:[a&&e.jsx("div",{className:"mr-2 rounded-full overflow-hidden bg-dark-gray flex-shrink-0",children:e.jsx("div",{className:x("flex items-center justify-center text-white font-medium",i==="sm"?"h-5 w-5 text-[10px]":i==="md"?"h-6 w-6 text-xs":"h-8 w-8 text-sm"),children:f==null?void 0:f.slice(0,1)})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center",children:[n&&e.jsx("span",{className:"font-medium text-white mr-1",children:T}),r&&e.jsx("span",{className:"text-gray-300",children:f||"???"}),m&&e.jsxs("div",{className:"flex items-center ml-2",children:[e.jsx(be,{children:e.jsxs(pe,{children:[e.jsx(ye,{asChild:!0,children:e.jsx("button",{onClick:R,className:"text-gray-400 hover:text-white transition-colors",children:h?e.jsx(we,{className:x("text-green-500",i==="sm"?"h-3 w-3":i==="md"?"h-4 w-4":"h-5 w-5")}):e.jsx(ve,{className:x(i==="sm"?"h-3 w-3":i==="md"?"h-4 w-4":"h-5 w-5")})})}),e.jsx(Ne,{children:h?"Copied!":"Copy address"})]})}),e.jsx("a",{href:U(),target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white transition-colors ml-1",children:e.jsx(Te,{className:x(i==="sm"?"h-3 w-3":i==="md"?"h-4 w-4":"h-5 w-5")})})]})]}),o&&W&&e.jsx("span",{className:x("text-gray-400",i==="sm"?"text-[10px]":i==="md"?"text-xs":"text-sm"),children:W})]})]})},ae=j.forwardRef(({className:t,...n},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:x("w-full caption-bottom text-sm",t),...n})}));ae.displayName="Table";const ie=j.forwardRef(({className:t,...n},a)=>e.jsx("thead",{ref:a,className:x("[&_tr]:border-b",t),...n}));ie.displayName="TableHeader";const re=j.forwardRef(({className:t,...n},a)=>e.jsx("tbody",{ref:a,className:x("[&_tr:last-child]:border-0",t),...n}));re.displayName="TableBody";const De=j.forwardRef(({className:t,...n},a)=>e.jsx("tfoot",{ref:a,className:x("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...n}));De.displayName="TableFooter";const _=j.forwardRef(({className:t,...n},a)=>e.jsx("tr",{ref:a,className:x("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...n}));_.displayName="TableRow";const k=j.forwardRef(({className:t,...n},a)=>e.jsx("th",{ref:a,className:x("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...n}));k.displayName="TableHead";const S=j.forwardRef(({className:t,...n},a)=>e.jsx("td",{ref:a,className:x("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...n}));S.displayName="TableCell";const We=j.forwardRef(({className:t,...n},a)=>e.jsx("caption",{ref:a,className:x("mt-4 text-sm text-muted-foreground",t),...n}));We.displayName="TableCaption";const y=({children:t,className:n=""})=>e.jsx("div",{className:`bg-white rounded-lg shadow ${n}`,children:t}),N=({children:t,className:n=""})=>e.jsx("div",{className:`p-4 border-b ${n}`,children:t}),w=({children:t,className:n=""})=>e.jsx("h3",{className:`text-lg font-semibold ${n}`,children:t}),v=({children:t,className:n=""})=>e.jsx("div",{className:`p-4 ${n}`,children:t}),te=({children:t,className:n=""})=>e.jsx("div",{className:`p-4 border-t ${n}`,children:t}),K=({className:t=""})=>e.jsx("div",{className:`animate-spin h-5 w-5 border-2 border-gray-300 rounded-full border-t-blue-600 ${t}`}),D=({children:t,variant:n="default",className:a=""})=>{const r={default:"bg-gray-100 text-gray-800",success:"bg-green-100 text-green-800",destructive:"bg-red-100 text-red-800",outline:"border border-gray-300 text-gray-800"};return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r[n]} ${a}`,children:t})};function Je(){const{address:t,isConnected:n,connect:a,balance:r,chainId:o,isNetworkSupported:m}=xe(),i="0xd093d7331448766923fe7ab270a9f6bce63cefda",{proposals:l,isLoading:d,error:c}=fe({limit:5}),{symbol:h,name:u,decimals:f,isLoading:W}=ne(i),{balance:$,isLoading:R}=Ie(i,t),{castVote:U,isPending:L}=je(),T=async(s,C)=>{if(!n){alert("Please connect your wallet first");return}try{await U(s,C),alert(`Vote cast successfully! ${C?"Supported":"Opposed"} proposal ${s}`)}catch(g){console.error("Error voting:",g),g instanceof Error&&g.message.includes("network")?alert(`Network Error: ${g.message}`):alert("Failed to vote. See console for details.")}};return e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Wagmi Integration Demo"}),e.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Implementation Toggle"}),e.jsx("p",{className:"text-gray-500",children:"Switch between Ethers.js and Wagmi implementations to see the components in action"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`text-sm ${V.getState().useWagmi?"":"font-bold"}`,children:"Ethers"}),e.jsx(ge,{checked:V.getState().useWagmi,onCheckedChange:V.getState().setUseWagmi}),e.jsx("span",{className:`text-sm ${V.getState().useWagmi?"font-bold":""}`,children:"Wagmi"})]})]}),e.jsxs(q,{defaultValue:"side-by-side",className:"mb-8",children:[e.jsxs(H,{className:"mb-4",children:[e.jsx(b,{value:"side-by-side",children:"Side by Side"}),e.jsx(b,{value:"unified",children:"Unified Component"})]}),e.jsx(p,{value:"side-by-side",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(y,{className:"border-blue-900/30",children:[e.jsxs(N,{children:[e.jsx(D,{variant:"outline",className:"bg-blue-900/20 text-blue-500 mb-2",children:"Ethers Implementation"}),e.jsx(w,{children:"Wallet Connection"})]}),e.jsx(v,{children:n?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",t]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Chain ID:"})," ",o]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Network:"})," ",m?"Supported":"Not Supported"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ETH Balance:"})," ",r]})]}):e.jsx("p",{children:"Wallet not connected"})}),e.jsx(te,{children:n?e.jsx(B,{variant:"outline",onClick:()=>window.location.reload(),children:"Refresh Data"}):e.jsx(B,{onClick:a,children:"Connect Wallet"})})]}),e.jsxs(y,{className:"border-purple-900/30",children:[e.jsxs(N,{children:[e.jsx(D,{variant:"outline",className:"bg-purple-900/20 text-purple-500 mb-2",children:"Wagmi Implementation"}),e.jsx(w,{children:"Wallet Connection"})]}),e.jsx(v,{children:e.jsx("div",{className:"flex flex-col items-center justify-center py-4",children:e.jsx(Z,{showBalance:!0,showNetwork:!0,showFullAddress:!0,size:"md",useWagmi:!0})})}),e.jsx(te,{className:"flex justify-center",children:e.jsx("p",{className:"text-sm text-gray-500",children:"Wallet controls integrated into the button component"})})]})]})}),e.jsx(p,{value:"unified",children:e.jsxs(y,{children:[e.jsx(N,{children:e.jsx(w,{children:"Unified Web3Button Component"})}),e.jsxs(v,{children:[e.jsx("div",{className:"flex flex-col items-center justify-center py-6",children:e.jsx(Z,{showBalance:!0,showNetwork:!0,showFullAddress:!1,size:"md",customActions:[{label:"View on Etherscan",onClick:()=>window.open(`https://sepolia.etherscan.io/address/${ee().address}`)},{label:"Copy Address",onClick:()=>{navigator.clipboard.writeText(ee().address||""),alert("Address copied to clipboard!")}}]})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-500",children:"This component seamlessly switches between Ethers and Wagmi implementations based on the toggle above"})})]})]})})]}),e.jsxs(q,{defaultValue:"side-by-side",className:"mb-8",children:[e.jsxs(H,{className:"mb-4",children:[e.jsx(b,{value:"side-by-side",children:"Side by Side"}),e.jsx(b,{value:"unified",children:"Unified Component"})]}),e.jsx(p,{value:"side-by-side",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(y,{className:"border-blue-900/30",children:[e.jsxs(N,{children:[e.jsx(D,{variant:"outline",className:"bg-blue-900/20 text-blue-500 mb-2",children:"Ethers Implementation"}),e.jsx(w,{children:"Token Information"})]}),e.jsx(v,{children:W?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(K,{})}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Token Address:"})," ",i]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",u||"Unknown"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Symbol:"})," ",h||"Unknown"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Decimals:"})," ",f]}),n&&e.jsxs("p",{children:[e.jsx("strong",{children:"Your Balance:"})," ",R?e.jsx(K,{className:"h-4 w-4 inline"}):$]})]})})]}),e.jsxs(y,{className:"border-purple-900/30",children:[e.jsxs(N,{children:[e.jsx(D,{variant:"outline",className:"bg-purple-900/20 text-purple-500 mb-2",children:"Wagmi Implementation"}),e.jsx(w,{children:"Token Information"})]}),e.jsx(v,{children:e.jsx("div",{className:"flex flex-col items-center justify-center py-4",children:e.jsx(E,{tokenAddress:i,amount:"10000000000000000000",showIcon:!0,showSymbol:!0,showName:!0,clickableAddress:!0,size:"lg"})})})]})]})}),e.jsx(p,{value:"unified",children:e.jsxs(y,{children:[e.jsx(N,{children:e.jsx(w,{children:"Unified TokenDisplay Component"})}),e.jsx(v,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-6",children:[e.jsx(E,{tokenAddress:i,amount:"10000000000000000000",showIcon:!0,showSymbol:!0,showName:!0,clickableAddress:!0,size:"lg",className:"mb-4"}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-4 mt-6",children:[e.jsx(E,{tokenAddress:i,amount:"123456789000000000000",showIcon:!0,showSymbol:!0,size:"sm"}),e.jsx(E,{tokenAddress:i,amount:"5000000000000000000",showIcon:!0,showSymbol:!0,size:"md"}),e.jsx(E,{tokenAddress:i,showIcon:!0,showSymbol:!0,showName:!0,size:"md"})]})]})})]})})]}),e.jsxs(q,{defaultValue:"side-by-side",className:"mb-8",children:[e.jsxs(H,{className:"mb-4",children:[e.jsx(b,{value:"side-by-side",children:"Side by Side"}),e.jsx(b,{value:"unified",children:"Unified Component"}),e.jsx(b,{value:"grid",children:"Grid View"})]}),e.jsx(p,{value:"side-by-side",children:e.jsxs(y,{children:[e.jsx(N,{children:e.jsx(w,{children:"Latest Proposals"})}),e.jsx(v,{children:d?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(K,{})}):c?e.jsxs("div",{className:"text-red-500",children:["Error loading proposals: ",typeof c=="string"?c:String(c)]}):l.length===0?e.jsx("div",{className:"text-center py-4",children:"No proposals found"}):e.jsxs(ae,{children:[e.jsx(ie,{children:e.jsxs(_,{children:[e.jsx(k,{children:"ID"}),e.jsx(k,{children:"Description"}),e.jsx(k,{children:"Status"}),e.jsx(k,{children:"Type"}),e.jsx(k,{children:"Actions"})]})}),e.jsx(re,{children:l.map(s=>e.jsxs(_,{children:[e.jsx(S,{children:s.id}),e.jsx(S,{className:"max-w-xs truncate",children:s.description}),e.jsx(S,{children:e.jsx(D,{variant:s.executed?"outline":s.canceled?"destructive":s.forVotes>s.againstVotes?"success":"default",children:s.executed?"Executed":s.canceled?"Canceled":s.forVotes>s.againstVotes?"Passed":"Active"})}),e.jsx(S,{children:s.proposalType===0?"Investment":s.proposalType===1?"Divestment":s.proposalType===2?"Parameter Change":"Other"}),e.jsx(S,{children:!s.executed&&!s.canceled&&n&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(B,{size:"sm",variant:"outline",onClick:()=>T(s.id,!0),disabled:L,children:"For"}),e.jsx(B,{size:"sm",variant:"outline",onClick:()=>T(s.id,!1),disabled:L,children:"Against"})]})})]},s.id))})]})})]})}),e.jsx(p,{value:"unified",children:d?e.jsxs("div",{className:"space-y-4",children:[e.jsx(I,{}),e.jsx(I,{})]}):c?e.jsxs("div",{className:"text-red-500 p-4 border border-red-300 rounded-md",children:["Error loading proposals: ",typeof c=="string"?c:String(c)]}):l.length===0?e.jsx("div",{className:"text-center py-4 border border-gray-300 rounded-md",children:"No proposals found"}):e.jsx("div",{className:"space-y-4",children:l.slice(0,2).map(s=>{const C=s.executed?"executed":s.canceled?"failed":s.forVotes>s.againstVotes?"passed":"active",g={id:s.id,title:s.description.slice(0,50)+(s.description.length>50?"...":""),description:s.description,status:C,type:s.proposalType===0?"invest":"divest",token:i,amount:1e19,forVotes:Math.round(s.forVotes/(s.forVotes+s.againstVotes||1)*100)||0,againstVotes:Math.round(s.againstVotes/(s.forVotes+s.againstVotes||1)*100)||0,proposer:s.proposer||"0x1234...",createdAt:Date.now(),endTime:new Date(Date.now()+864e5).getTime(),executed:s.executed||!1,canceled:s.canceled||!1,endsIn:"1 day",endTimeISO:new Date(Date.now()+864e5).toISOString()};return e.jsx(se,{proposal:g,onVote:async(A,P)=>T(A,P),onExecute:async()=>{},expanded:!0},s.id)})})}),e.jsx(p,{value:"grid",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d?e.jsxs(e.Fragment,{children:[e.jsx(I,{}),e.jsx(I,{}),e.jsx(I,{})]}):l.slice(0,3).map(s=>{const C=s.executed?"executed":s.canceled?"failed":s.forVotes>s.againstVotes?"passed":"active",g={id:s.id,title:s.description.slice(0,50)+(s.description.length>50?"...":""),description:s.description,status:C,type:s.proposalType===0?"invest":"divest",token:i,amount:1e19,forVotes:Math.round(s.forVotes/(s.forVotes+s.againstVotes||1)*100)||0,againstVotes:Math.round(s.againstVotes/(s.forVotes+s.againstVotes||1)*100)||0,proposer:s.proposer||"0x1234...",createdAt:Date.now(),endTime:new Date(Date.now()+864e5).getTime(),executed:s.executed||!1,canceled:s.canceled||!1,endsIn:"1 day",endTimeISO:new Date(Date.now()+864e5).toISOString()};return e.jsx(se,{proposal:g,onVote:async(A,P)=>T(A,P),onExecute:async()=>{}},s.id)})})})]}),e.jsxs("div",{className:"mt-8 bg-gray-100 p-4 rounded-md",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Technical Information"}),e.jsx("p",{className:"text-sm text-gray-700",children:"This demo page uses the new wagmi hooks to interact with the blockchain. The implementation is completely separate from the existing application code and demonstrates how we can progressively migrate to wagmi without disrupting current functionality."}),e.jsxs("div",{className:"mt-2 text-sm text-gray-700",children:[e.jsx("p",{children:e.jsx("strong",{children:"Key benefits demonstrated:"})}),e.jsxs("ul",{className:"list-disc pl-5 mt-1",children:[e.jsx("li",{children:"Automatic loading and error states"}),e.jsx("li",{children:"Declarative data fetching"}),e.jsx("li",{children:"Simplified transaction handling"}),e.jsx("li",{children:"Better type safety"}),e.jsx("li",{children:"Integration with ethers.js for backward compatibility"})]})]})]})]})}export{Je as default};
