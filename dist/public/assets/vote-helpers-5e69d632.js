import{ct as P,cI as Ae,cJ as We,cK as ue,cL as de,_ as Ke,cx as fe,cM as Be,cr as Q,cN as Te,cO as J,cP as U,cQ as je,cp as S,cR as Qe,cS as Je,cT as ke,cU as Ie,cV as Xe,cW as te,cy as x,cX as Ye,cH as Ze,cY as et,cZ as he,c_ as Fe,c$ as Ne,d0 as tt,d1 as X,d2 as nt,d3 as oe,d4 as be,d5 as st,d6 as rt,d7 as ot,d8 as le,d9 as it,da as v,db as at,dc as ct,dd as ut,de as dt,df as ft,dg as lt,dh as ht,di as mt,dj as gt,dk as yt,dl as bt,dm as pt,cC as wt,ac as xt,y as Pt,G as Et,a as Ct,e as B,d as Ge,i as ie,bX as pe,dn as vt,dp as At,ad as Bt,af as Tt,ah as kt,cG as It,a7 as K}from"./index-e1be7c10.js";import{a as T}from"./contracts-3445139a.js";class Le extends P{constructor({docsPath:t}={}){super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client."].join(`
`),{docsPath:t,docsSlug:"account",name:"AccountNotFoundError"})}}class ae extends P{constructor({docsPath:t,metaMessages:n,type:s}){super(`Account type "${s}" is not supported.`,{docsPath:t,metaMessages:n,name:"AccountTypeNotSupportedError"})}}function Ft(e){const t=Ae(`0x${e.substring(4)}`).substring(26);return We(`0x${t}`)}async function Nt({hash:e,signature:t}){const n=ue(e)?e:de(e),{secp256k1:s}=await Ke(()=>import("./secp256k1-60aaee49.js"),["assets/secp256k1-60aaee49.js","assets/index-e1be7c10.js","assets/index-39892867.css","assets/contracts-3445139a.js"]);return`0x${(()=>{if(typeof t=="object"&&"r"in t&&"s"in t){const{r:u,s:l,v:d,yParity:f}=t,g=Number(f??d),m=we(g);return new s.Signature(fe(u),fe(l)).addRecoveryBit(m)}const i=ue(t)?t:de(t);if(Be(i)!==65)throw new Error("invalid signature length");const a=Q(`0x${i.slice(130)}`),c=we(a);return s.Signature.fromCompact(i.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function we(e){if(e===0||e===1)return e;if(e===27)return 0;if(e===28)return 1;throw new Error("Invalid yParityOrV value")}async function Gt({hash:e,signature:t}){return Ft(await Nt({hash:e,signature:t}))}function Lt(e,t="hex"){const n=Re(e),s=Te(new Uint8Array(n.length));return n.encode(s),t==="hex"?J(s.bytes):s.bytes}function Re(e){return Array.isArray(e)?Rt(e.map(t=>Re(t))):Vt(e)}function Rt(e){const t=e.reduce((r,o)=>r+o.length,0),n=Ve(t);return{length:(()=>t<=55?1+t:1+n+t)(),encode(r){t<=55?r.pushByte(192+t):(r.pushByte(192+55+n),n===1?r.pushUint8(t):n===2?r.pushUint16(t):n===3?r.pushUint24(t):r.pushUint32(t));for(const{encode:o}of e)o(r)}}}function Vt(e){const t=typeof e=="string"?U(e):e,n=Ve(t.length);return{length:(()=>t.length===1&&t[0]<128?1:t.length<=55?1+t.length:1+n+t.length)(),encode(r){t.length===1&&t[0]<128?r.pushBytes(t):t.length<=55?(r.pushByte(128+t.length),r.pushBytes(t)):(r.pushByte(128+55+n),n===1?r.pushUint8(t.length):n===2?r.pushUint16(t.length):n===3?r.pushUint24(t.length):r.pushUint32(t.length),r.pushBytes(t))}}}function Ve(e){if(e<2**8)return 1;if(e<2**16)return 2;if(e<2**24)return 3;if(e<2**32)return 4;throw new P("Length is too large.")}function _t(e){const{chainId:t,nonce:n,to:s}=e,r=e.contractAddress??e.address,o=Ae(je(["0x05",Lt([t?S(t):"0x",r,n?S(n):"0x"])]));return s==="bytes"?U(o):o}async function _e(e){const{authorization:t,signature:n}=e;return Gt({hash:_t(t),signature:n??t})}function $t({chain:e,currentChainId:t}){if(!e)throw new Qe;if(t!==e.id)throw new Je({chain:e,currentChainId:t})}function Ot(e,{docsPath:t,...n}){const s=(()=>{const r=ke(e,n);return r instanceof Ie?e:r})();return new Xe(s,{docsPath:t,...n})}async function $e(e){const t=await e.request({method:"eth_chainId"},{dedupe:!0});return Q(t)}class Dt extends P{constructor(){super("`baseFeeMultiplier` must be greater than 1.",{name:"BaseFeeScalarError"})}}class me extends P{constructor(){super("Chain does not support EIP-1559 fees.",{name:"Eip1559FeesNotSupportedError"})}}class Mt extends P{constructor({maxPriorityFeePerGas:t}){super(`\`maxFeePerGas\` cannot be less than the \`maxPriorityFeePerGas\` (${te(t)} gwei).`,{name:"MaxFeePerGasTooLowError"})}}class Ut extends P{constructor({blockHash:t,blockNumber:n}){let s="Block";t&&(s=`Block at hash "${t}"`),n&&(s=`Block at number "${n}"`),super(`${s} could not be found.`,{name:"BlockNotFoundError"})}}const St={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function zt(e){const t={...e,blockHash:e.blockHash?e.blockHash:null,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,chainId:e.chainId?Q(e.chainId):void 0,gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,maxFeePerBlobGas:e.maxFeePerBlobGas?BigInt(e.maxFeePerBlobGas):void 0,maxFeePerGas:e.maxFeePerGas?BigInt(e.maxFeePerGas):void 0,maxPriorityFeePerGas:e.maxPriorityFeePerGas?BigInt(e.maxPriorityFeePerGas):void 0,nonce:e.nonce?Q(e.nonce):void 0,to:e.to?e.to:null,transactionIndex:e.transactionIndex?Number(e.transactionIndex):null,type:e.type?St[e.type]:void 0,typeHex:e.type?e.type:void 0,value:e.value?BigInt(e.value):void 0,v:e.v?BigInt(e.v):void 0};return e.authorizationList&&(t.authorizationList=Ht(e.authorizationList)),t.yParity=(()=>{if(e.yParity)return Number(e.yParity);if(typeof t.v=="bigint"){if(t.v===0n||t.v===27n)return 0;if(t.v===1n||t.v===28n)return 1;if(t.v>=35n)return t.v%2n===0n?1:0}})(),t.type==="legacy"&&(delete t.accessList,delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,delete t.yParity),t.type==="eip2930"&&(delete t.maxFeePerBlobGas,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas),t.type==="eip1559"&&delete t.maxFeePerBlobGas,t}function Ht(e){return e.map(t=>({address:t.address,chainId:Number(t.chainId),nonce:Number(t.nonce),r:t.r,s:t.s,yParity:Number(t.yParity)}))}function qt(e){const t=(e.transactions??[]).map(n=>typeof n=="string"?n:zt(n));return{...e,baseFeePerGas:e.baseFeePerGas?BigInt(e.baseFeePerGas):null,blobGasUsed:e.blobGasUsed?BigInt(e.blobGasUsed):void 0,difficulty:e.difficulty?BigInt(e.difficulty):void 0,excessBlobGas:e.excessBlobGas?BigInt(e.excessBlobGas):void 0,gasLimit:e.gasLimit?BigInt(e.gasLimit):void 0,gasUsed:e.gasUsed?BigInt(e.gasUsed):void 0,hash:e.hash?e.hash:null,logsBloom:e.logsBloom?e.logsBloom:null,nonce:e.nonce?e.nonce:null,number:e.number?BigInt(e.number):null,size:e.size?BigInt(e.size):void 0,timestamp:e.timestamp?BigInt(e.timestamp):void 0,transactions:t,totalDifficulty:e.totalDifficulty?BigInt(e.totalDifficulty):null}}async function se(e,{blockHash:t,blockNumber:n,blockTag:s,includeTransactions:r}={}){var l,d,f;const o=s??"latest",i=r??!1,a=n!==void 0?S(n):void 0;let c=null;if(t?c=await e.request({method:"eth_getBlockByHash",params:[t,i]},{dedupe:!0}):c=await e.request({method:"eth_getBlockByNumber",params:[a||o,i]},{dedupe:!!a}),!c)throw new Ut({blockHash:t,blockNumber:n});return(((f=(d=(l=e.chain)==null?void 0:l.formatters)==null?void 0:d.block)==null?void 0:f.format)||qt)(c)}async function Oe(e){const t=await e.request({method:"eth_gasPrice"});return BigInt(t)}async function Wt(e,t){var o,i;const{block:n,chain:s=e.chain,request:r}=t||{};try{const a=((o=s==null?void 0:s.fees)==null?void 0:o.maxPriorityFeePerGas)??((i=s==null?void 0:s.fees)==null?void 0:i.defaultPriorityFee);if(typeof a=="function"){const u=n||await x(e,se,"getBlock")({}),l=await a({block:u,client:e,request:r});if(l===null)throw new Error;return l}if(typeof a<"u")return a;const c=await e.request({method:"eth_maxPriorityFeePerGas"});return fe(c)}catch{const[a,c]=await Promise.all([n?Promise.resolve(n):x(e,se,"getBlock")({}),x(e,Oe,"getGasPrice")({})]);if(typeof a.baseFeePerGas!="bigint")throw new me;const u=c-a.baseFeePerGas;return u<0n?0n:u}}async function xe(e,t){var f,g;const{block:n,chain:s=e.chain,request:r,type:o="eip1559"}=t||{},i=await(async()=>{var m,b;return typeof((m=s==null?void 0:s.fees)==null?void 0:m.baseFeeMultiplier)=="function"?s.fees.baseFeeMultiplier({block:n,client:e,request:r}):((b=s==null?void 0:s.fees)==null?void 0:b.baseFeeMultiplier)??1.2})();if(i<1)throw new Dt;const c=10**(((f=i.toString().split(".")[1])==null?void 0:f.length)??0),u=m=>m*BigInt(Math.ceil(i*c))/BigInt(c),l=n||await x(e,se,"getBlock")({});if(typeof((g=s==null?void 0:s.fees)==null?void 0:g.estimateFeesPerGas)=="function"){const m=await s.fees.estimateFeesPerGas({block:n,client:e,multiply:u,request:r,type:o});if(m!==null)return m}if(o==="eip1559"){if(typeof l.baseFeePerGas!="bigint")throw new me;const m=typeof(r==null?void 0:r.maxPriorityFeePerGas)=="bigint"?r.maxPriorityFeePerGas:await Wt(e,{block:l,chain:s,request:r}),b=u(l.baseFeePerGas);return{maxFeePerGas:(r==null?void 0:r.maxFeePerGas)??b+m,maxPriorityFeePerGas:m}}return{gasPrice:(r==null?void 0:r.gasPrice)??u(await x(e,Oe,"getGasPrice")({}))}}class Kt extends P{constructor(t,{account:n,docsPath:s,chain:r,data:o,gas:i,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:u,nonce:l,to:d,value:f}){var m;const g=Ye({from:n==null?void 0:n.address,to:d,value:typeof f<"u"&&`${Ze(f)} ${((m=r==null?void 0:r.nativeCurrency)==null?void 0:m.symbol)||"ETH"}`,data:o,gas:i,gasPrice:typeof a<"u"&&`${te(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${te(c)} gwei`,maxPriorityFeePerGas:typeof u<"u"&&`${te(u)} gwei`,nonce:l});super(t.shortMessage,{cause:t,docsPath:s,metaMessages:[...t.metaMessages?[...t.metaMessages," "]:[],"Estimate Gas Arguments:",g].filter(Boolean),name:"EstimateGasExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=t}}function jt(e,{docsPath:t,...n}){const s=(()=>{const r=ke(e,n);return r instanceof Ie?e:r})();return new Kt(s,{docsPath:t,...n})}async function Qt(e,t){var r,o,i;const{account:n=e.account}=t,s=n?X(n):void 0;try{let A=function(L){const{block:W,request:R,rpcStateOverride:O}=L;return e.request({method:"eth_estimateGas",params:O?[R,W??"latest",O]:W?[R,W]:[R]})};const{accessList:a,authorizationList:c,blobs:u,blobVersionedHashes:l,blockNumber:d,blockTag:f,data:g,gas:m,gasPrice:b,maxFeePerBlobGas:I,maxFeePerGas:h,maxPriorityFeePerGas:p,nonce:E,value:Y,stateOverride:Z,...C}=await He(e,{...t,parameters:(s==null?void 0:s.type)==="local"?void 0:["blobVersionedHashes"]}),G=(typeof d=="bigint"?S(d):void 0)||f,z=et(Z),ee=await(async()=>{if(C.to)return C.to;if(c&&c.length>0)return await _e({authorization:c[0]}).catch(()=>{throw new P("`to` is required. Could not infer from `authorizationList`")})})();he(t);const H=(i=(o=(r=e.chain)==null?void 0:r.formatters)==null?void 0:o.transactionRequest)==null?void 0:i.format,q=(H||Fe)({...Ne(C,{format:H}),from:s==null?void 0:s.address,accessList:a,authorizationList:c,blobs:u,blobVersionedHashes:l,data:g,gas:m,gasPrice:b,maxFeePerBlobGas:I,maxFeePerGas:h,maxPriorityFeePerGas:p,nonce:E,to:ee,value:Y});let $=BigInt(await A({block:G,request:q,rpcStateOverride:z}));if(c){const L=await tt(e,{address:q.from}),W=await Promise.all(c.map(async R=>{const{address:O}=R,qe=await A({block:G,request:{authorizationList:void 0,data:g,from:s==null?void 0:s.address,to:O,value:S(L)},rpcStateOverride:z}).catch(()=>100000n);return 2n*BigInt(qe)}));$+=W.reduce((R,O)=>R+O,0n)}return $}catch(a){throw jt(a,{...t,account:s,chain:e.chain})}}async function Jt(e,{address:t,blockTag:n="latest",blockNumber:s}){const r=await e.request({method:"eth_getTransactionCount",params:[t,typeof s=="bigint"?S(s):n]},{dedupe:!!s});return Q(r)}function De(e){const{kzg:t}=e,n=e.to??(typeof e.blobs[0]=="string"?"hex":"bytes"),s=typeof e.blobs[0]=="string"?e.blobs.map(o=>U(o)):e.blobs,r=[];for(const o of s)r.push(Uint8Array.from(t.blobToKzgCommitment(o)));return n==="bytes"?r:r.map(o=>J(o))}function Me(e){const{kzg:t}=e,n=e.to??(typeof e.blobs[0]=="string"?"hex":"bytes"),s=typeof e.blobs[0]=="string"?e.blobs.map(i=>U(i)):e.blobs,r=typeof e.commitments[0]=="string"?e.commitments.map(i=>U(i)):e.commitments,o=[];for(let i=0;i<s.length;i++){const a=s[i],c=r[i];o.push(Uint8Array.from(t.computeBlobKzgProof(a,c)))}return n==="bytes"?o:o.map(i=>J(i))}function Xt(e,t,n,s){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,s);const r=BigInt(32),o=BigInt(4294967295),i=Number(n>>r&o),a=Number(n&o),c=s?4:0,u=s?0:4;e.setUint32(t+c,i,s),e.setUint32(t+u,a,s)}function Yt(e,t,n){return e&t^~e&n}function Zt(e,t,n){return e&t^e&n^t&n}class en extends nt{constructor(t,n,s,r){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=s,this.isLE=r,this.buffer=new Uint8Array(t),this.view=oe(this.buffer)}update(t){be(this),t=st(t),rt(t);const{view:n,buffer:s,blockLen:r}=this,o=t.length;for(let i=0;i<o;){const a=Math.min(r-this.pos,o-i);if(a===r){const c=oe(t);for(;r<=o-i;i+=r)this.process(c,i);continue}s.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===r&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){be(this),ot(t,this),this.finished=!0;const{buffer:n,view:s,blockLen:r,isLE:o}=this;let{pos:i}=this;n[i++]=128,le(this.buffer.subarray(i)),this.padOffset>r-i&&(this.process(s,0),i=0);for(let d=i;d<r;d++)n[d]=0;Xt(s,r-8,BigInt(this.length*8),o),this.process(s,0);const a=oe(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],o)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const s=t.slice(0,n);return this.destroy(),s}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:s,length:r,finished:o,destroyed:i,pos:a}=this;return t.destroyed=i,t.finished=o,t.length=r,t.pos=a,r%n&&t.buffer.set(s),t}clone(){return this._cloneInto()}}const F=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),tn=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),N=new Uint32Array(64);class nn extends en{constructor(t=32){super(64,t,8,!1),this.A=F[0]|0,this.B=F[1]|0,this.C=F[2]|0,this.D=F[3]|0,this.E=F[4]|0,this.F=F[5]|0,this.G=F[6]|0,this.H=F[7]|0}get(){const{A:t,B:n,C:s,D:r,E:o,F:i,G:a,H:c}=this;return[t,n,s,r,o,i,a,c]}set(t,n,s,r,o,i,a,c){this.A=t|0,this.B=n|0,this.C=s|0,this.D=r|0,this.E=o|0,this.F=i|0,this.G=a|0,this.H=c|0}process(t,n){for(let d=0;d<16;d++,n+=4)N[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const f=N[d-15],g=N[d-2],m=v(f,7)^v(f,18)^f>>>3,b=v(g,17)^v(g,19)^g>>>10;N[d]=b+N[d-7]+m+N[d-16]|0}let{A:s,B:r,C:o,D:i,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const f=v(a,6)^v(a,11)^v(a,25),g=l+f+Yt(a,c,u)+tn[d]+N[d]|0,b=(v(s,2)^v(s,13)^v(s,22))+Zt(s,r,o)|0;l=u,u=c,c=a,a=i+g|0,i=o,o=r,r=s,s=g+b|0}s=s+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(s,r,o,i,a,c,u,l)}roundClean(){le(N)}destroy(){this.set(0,0,0,0,0,0,0,0),le(this.buffer)}}const sn=it(()=>new nn),rn=sn;function on(e,t){const n=t||"hex",s=rn(ue(e,{strict:!1})?at(e):e);return n==="bytes"?s:de(s)}function an(e){const{commitment:t,version:n=1}=e,s=e.to??(typeof t=="string"?"hex":"bytes"),r=on(t,"bytes");return r.set([n],0),s==="bytes"?r:J(r)}function cn(e){const{commitments:t,version:n}=e,s=e.to??(typeof t[0]=="string"?"hex":"bytes"),r=[];for(const o of t)r.push(an({commitment:o,to:s,version:n}));return r}const Pe=6,Ue=32,ge=4096,Se=Ue*ge,Ee=Se*Pe-1-1*ge*Pe;class un extends P{constructor({maxSize:t,size:n}){super("Blob size is too large.",{metaMessages:[`Max: ${t} bytes`,`Given: ${n} bytes`],name:"BlobSizeTooLargeError"})}}class dn extends P{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}}function fn(e){const t=e.to??(typeof e.data=="string"?"hex":"bytes"),n=typeof e.data=="string"?U(e.data):e.data,s=Be(n);if(!s)throw new dn;if(s>Ee)throw new un({maxSize:Ee,size:s});const r=[];let o=!0,i=0;for(;o;){const a=Te(new Uint8Array(Se));let c=0;for(;c<ge;){const u=n.slice(i,i+(Ue-1));if(a.pushByte(0),a.pushBytes(u),u.length<31){a.pushByte(128),o=!1;break}c++,i+=31}r.push(a)}return t==="bytes"?r.map(a=>a.bytes):r.map(a=>J(a.bytes))}function ln(e){const{data:t,kzg:n,to:s}=e,r=e.blobs??fn({data:t,to:s}),o=e.commitments??De({blobs:r,kzg:n,to:s}),i=e.proofs??Me({blobs:r,commitments:o,kzg:n,to:s}),a=[];for(let c=0;c<r.length;c++)a.push({blob:r[c],commitment:o[c],proof:i[c]});return a}function hn(e){if(e.type)return e.type;if(typeof e.authorizationList<"u")return"eip7702";if(typeof e.blobs<"u"||typeof e.blobVersionedHashes<"u"||typeof e.maxFeePerBlobGas<"u"||typeof e.sidecars<"u")return"eip4844";if(typeof e.maxFeePerGas<"u"||typeof e.maxPriorityFeePerGas<"u")return"eip1559";if(typeof e.gasPrice<"u")return typeof e.accessList<"u"?"eip2930":"legacy";throw new ct({transaction:e})}const ze=["blobVersionedHashes","chainId","fees","gas","nonce","type"],Ce=new Map;async function He(e,t){const{account:n=e.account,blobs:s,chain:r,gas:o,kzg:i,nonce:a,nonceManager:c,parameters:u=ze,type:l}=t,d=n&&X(n),f={...t,...d?{from:d==null?void 0:d.address}:{}};let g;async function m(){return g||(g=await x(e,se,"getBlock")({blockTag:"latest"}),g)}let b;async function I(){return b||(r?r.id:typeof t.chainId<"u"?t.chainId:(b=await x(e,$e,"getChainId")({}),b))}if(u.includes("nonce")&&typeof a>"u"&&d)if(c){const h=await I();f.nonce=await c.consume({address:d.address,chainId:h,client:e})}else f.nonce=await x(e,Jt,"getTransactionCount")({address:d.address,blockTag:"pending"});if((u.includes("blobVersionedHashes")||u.includes("sidecars"))&&s&&i){const h=De({blobs:s,kzg:i});if(u.includes("blobVersionedHashes")){const p=cn({commitments:h,to:"hex"});f.blobVersionedHashes=p}if(u.includes("sidecars")){const p=Me({blobs:s,commitments:h,kzg:i}),E=ln({blobs:s,commitments:h,proofs:p,to:"hex"});f.sidecars=E}}if(u.includes("chainId")&&(f.chainId=await I()),(u.includes("fees")||u.includes("type"))&&typeof l>"u")try{f.type=hn(f)}catch{let h=Ce.get(e.uid);if(typeof h>"u"){const p=await m();h=typeof(p==null?void 0:p.baseFeePerGas)=="bigint",Ce.set(e.uid,h)}f.type=h?"eip1559":"legacy"}if(u.includes("fees"))if(f.type!=="legacy"&&f.type!=="eip2930"){if(typeof f.maxFeePerGas>"u"||typeof f.maxPriorityFeePerGas>"u"){const h=await m(),{maxFeePerGas:p,maxPriorityFeePerGas:E}=await xe(e,{block:h,chain:r,request:f});if(typeof t.maxPriorityFeePerGas>"u"&&t.maxFeePerGas&&t.maxFeePerGas<E)throw new Mt({maxPriorityFeePerGas:E});f.maxPriorityFeePerGas=E,f.maxFeePerGas=p}}else{if(typeof t.maxFeePerGas<"u"||typeof t.maxPriorityFeePerGas<"u")throw new me;if(typeof t.gasPrice>"u"){const h=await m(),{gasPrice:p}=await xe(e,{block:h,chain:r,request:f,type:"legacy"});f.gasPrice=p}}return u.includes("gas")&&typeof o>"u"&&(f.gas=await x(e,Qt,"estimateGas")({...f,account:d&&{address:d.address,type:"json-rpc"}})),he(f),delete f.parameters,f}async function mn(e,{serializedTransaction:t}){return e.request({method:"eth_sendRawTransaction",params:[t]},{retryCount:0})}const ce=new ut(128);async function gn(e,t){var p,E,Y,Z;const{account:n=e.account,chain:s=e.chain,accessList:r,authorizationList:o,blobs:i,data:a,gas:c,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:f,nonce:g,type:m,value:b,...I}=t;if(typeof n>"u")throw new Le({docsPath:"/docs/actions/wallet/sendTransaction"});const h=n?X(n):null;try{he(t);const C=await(async()=>{if(t.to)return t.to;if(t.to!==null&&o&&o.length>0)return await _e({authorization:o[0]}).catch(()=>{throw new P("`to` is required. Could not infer from `authorizationList`.")})})();if((h==null?void 0:h.type)==="json-rpc"||h===null){let _;s!==null&&(_=await x(e,$e,"getChainId")({}),$t({currentChainId:_,chain:s}));const G=(Y=(E=(p=e.chain)==null?void 0:p.formatters)==null?void 0:E.transactionRequest)==null?void 0:Y.format,ee=(G||Fe)({...Ne(I,{format:G}),accessList:r,authorizationList:o,blobs:i,chainId:_,data:a,from:h==null?void 0:h.address,gas:c,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:f,nonce:g,to:C,type:m,value:b}),H=ce.get(e.uid),ye=H?"wallet_sendTransaction":"eth_sendTransaction";try{return await e.request({method:ye,params:[ee]},{retryCount:0})}catch(q){if(H===!1)throw q;const A=q;if(A.name==="InvalidInputRpcError"||A.name==="InvalidParamsRpcError"||A.name==="MethodNotFoundRpcError"||A.name==="MethodNotSupportedRpcError")return await e.request({method:"wallet_sendTransaction",params:[ee]},{retryCount:0}).then($=>(ce.set(e.uid,!0),$)).catch($=>{const L=$;throw L.name==="MethodNotFoundRpcError"||L.name==="MethodNotSupportedRpcError"?(ce.set(e.uid,!1),A):L});throw A}}if((h==null?void 0:h.type)==="local"){const _=await x(e,He,"prepareTransactionRequest")({account:h,accessList:r,authorizationList:o,blobs:i,chain:s,data:a,gas:c,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:f,nonce:g,nonceManager:h.nonceManager,parameters:[...ze,"sidecars"],type:m,value:b,...I,to:C}),G=(Z=s==null?void 0:s.serializers)==null?void 0:Z.transaction,z=await h.signTransaction(_,{serializer:G});return await x(e,mn,"sendRawTransaction")({serializedTransaction:z})}throw(h==null?void 0:h.type)==="smart"?new ae({metaMessages:["Consider using the `sendUserOperation` Action instead."],docsPath:"/docs/actions/bundler/sendUserOperation",type:"smart"}):new ae({docsPath:"/docs/actions/wallet/sendTransaction",type:h==null?void 0:h.type})}catch(C){throw C instanceof ae?C:Ot(C,{...t,account:h,chain:t.chain||void 0})}}async function yn(e,t){const{abi:n,account:s=e.account,address:r,args:o,dataSuffix:i,functionName:a,...c}=t;if(typeof s>"u")throw new Le({docsPath:"/docs/contract/writeContract"});const u=s?X(s):null,l=dt({abi:n,args:o,functionName:a});try{return await x(e,gn,"sendTransaction")({data:`${l}${i?i.replace("0x",""):""}`,to:r,account:u,...c})}catch(d){throw ft(d,{abi:n,address:r,args:o,docsPath:"/docs/contract/writeContract",functionName:a,sender:u==null?void 0:u.address})}}function bn(e,t={}){const{key:n="custom",methods:s,name:r="Custom Provider",retryDelay:o}=t;return({retryCount:i})=>lt({key:n,methods:s,name:r,request:e.request.bind(e),retryCount:t.retryCount??i,retryDelay:o,type:"custom"})}async function pn(e,t={}){let n;if(t.connector){const{connector:u}=t;if(e.state.status==="reconnecting"&&!u.getAccounts&&!u.getChainId)throw new ht({connector:u});const[l,d]=await Promise.all([u.getAccounts().catch(f=>{if(t.account===null)return[];throw f}),u.getChainId()]);n={accounts:l,chainId:d,connector:u}}else n=e.state.connections.get(e.state.current);if(!n)throw new mt;const s=t.chainId??n.chainId,r=await n.connector.getChainId();if(r!==n.chainId)throw new gt({connectionChainId:n.chainId,connectorChainId:r});const o=n.connector;if(o.getClient)return o.getClient({chainId:s});const i=X(t.account??n.accounts[0]);if(i&&(i.address=yt(i.address)),t.account&&!n.accounts.some(u=>u.toLowerCase()===i.address.toLowerCase()))throw new bt({address:i.address,connector:o});const a=e.chains.find(u=>u.id===s),c=await n.connector.getProvider({chainId:s});return pt({account:i,chain:a,name:"Connector Client",transport:u=>bn(c)({...u,retryCount:0})})}async function wn(e,t){const{account:n,chainId:s,connector:r,...o}=t;let i;return typeof n=="object"&&(n==null?void 0:n.type)==="local"?i=e.getClient({chainId:s}):i=await pn(e,{account:n??void 0,chainId:s,connector:r}),await wt(i,yn,"writeContract")({...o,...n?{account:n}:{},chain:s?{id:s}:null})}function xn(e){return{mutationFn(t){return wn(e,t)},mutationKey:["writeContract"]}}function Fn(e={}){const{mutation:t}=e,n=xt(e),s=xn(n),{mutate:r,mutateAsync:o,...i}=Pt({...t,...s});return{...i,writeContract:r,writeContractAsync:o}}function re(e){let t="Transaction failed. Please try again.";try{if(!e)return{message:t,originalError:e};if(typeof e=="string")return{message:e,originalError:e};if(e.reason)t=e.reason;else if(e.message)if(e.message.includes("user rejected transaction"))t="Transaction was rejected in wallet";else if(e.message.includes("execution reverted")){const n=e.message.match(/execution reverted: (.*?)"/);t=n?`Transaction reverted: ${n[1]}`:"Transaction reverted by the contract"}else e.message.includes("insufficient funds")?t="Insufficient funds for transaction":e.message.includes("gas required exceeds")?t="Transaction would run out of gas. Try increasing gas limit.":e.message.includes("nonce too high")?t="Transaction nonce issue. Please refresh the page and try again.":e.message.includes("replacement fee too low")?t="Gas price too low to replace pending transaction":e.message.includes("already known")?t="Transaction already submitted":e.message.includes("network changed")?t="Network changed unexpectedly. Please refresh.":e.message.includes("cannot estimate gas")?t="Could not estimate gas. The transaction may fail.":e.message.includes("timeout")?t="Request timed out. The network may be congested.":t=e.message.replace(/\(action="[^"]*", data=null, reason=null, code=[^,]+, version=[^,]+, [^)]*\)/,"");else if(e.code)switch(e.code){case 4001:t="Transaction rejected by user";break;case-32602:t="Invalid transaction parameters";break;case-32603:t="Internal error processing transaction";break;default:t=`Error code ${e.code}`}return t=t.length>120?t.substring(0,117)+"...":t,{message:t,originalError:e}}catch(n){return console.error("Error while parsing Ethers error:",n),{message:"An unexpected error occurred",originalError:e}}}async function D(e,t=[],n="Contract Error"){try{return await e(...t)}catch(s){const r=re(s),o=`${n}: ${r.message}`;throw console.error(o,s),new Error(o,{cause:s})}}async function V(e,t=[],n={}){const{errorPrefix:s="Transaction Error",confirmations:r=1,onSubmitted:o,onConfirmed:i,onError:a}=n;try{const c=await e(...t);o&&o(c);const u=await c.wait(r);return i&&i(u),u}catch(c){const u=re(c),l=`${s}: ${u.message}`;throw console.error(l,c),a&&a(c),new Error(l,{cause:c})}}function ne(e,t=18,n=2){if(e==null)return"0";try{const s=Et(e,t);return Ct(parseFloat(s),n)}catch(s){return console.warn("Error formatting big number:",s),"0"}}var j=(e=>(e.INFO="info",e.WARNING="warning",e.ERROR="error",e.CRITICAL="critical",e))(j||{}),w=(e=>(e.BLOCKCHAIN="blockchain",e.CONTRACT="contract",e.NETWORK="network",e.USER_INPUT="user_input",e.AUTHENTICATION="authentication",e.API="api",e.NAVIGATION="navigation",e.UI="ui",e.UNKNOWN="unknown",e))(w||{});class Pn{constructor(){this.errorLog=[],this.maxLogSize=50,this.errorListeners=[]}registerErrorListener(t){return this.errorListeners.push(t),()=>{this.errorListeners=this.errorListeners.filter(n=>n!==t)}}notifyListeners(t){this.errorListeners.forEach(n=>{try{n(t)}catch(s){console.error("Error in error listener:",s)}})}logError(t){this.errorLog.unshift(t),this.errorLog.length>this.maxLogSize&&(this.errorLog=this.errorLog.slice(0,this.maxLogSize))}getErrorLog(){return[...this.errorLog]}clearErrorLog(){this.errorLog=[]}createError(t,n="unknown",s="error",r,o,i){return{message:t,category:n,severity:s,timestamp:Date.now(),details:r,originalError:o,code:i}}handleError(t,n="An unexpected error occurred",s="unknown",r="error"){let o;if(t instanceof Error)o=this.createError(t.message||n,s,r,{stack:t.stack},t);else if(typeof t=="string")o=this.createError(t,s,r);else if(t&&typeof t=="object"){const i=t.message||t.reason||t.error||n;o=this.createError(i,s,r,t,t)}else o=this.createError(n,s,r);return this.logError(o),this.notifyListeners(o),o}handleBlockchainError(t,n="Blockchain transaction failed"){const{message:s,originalError:r}=re(t);let o="error";(s.includes("reject")||s.includes("denied")||s.includes("canceled"))&&(o="warning");const i=this.createError(s||n,"blockchain",o,{originalMessage:t.message},r);return this.logError(i),this.notifyListeners(i),i}handleContractError(t,n="Contract",s="interaction"){const r=`Error during ${n} ${s}`,{message:o,originalError:i}=re(t),a=this.createError(o||r,"contract","error",{contract:n,method:s},i);return this.logError(a),this.notifyListeners(a),a}handleValidationError(t,n="input"){let s=`Invalid ${n}`;typeof t=="string"?s=t:t!=null&&t.message&&(s=t.message);const r=this.createError(s,"user_input","warning",{field:n},t);return this.logError(r),this.notifyListeners(r),r}handleNetworkError(t){let n="Network connection issue";const s="error";t!=null&&t.message&&(t.message.includes("timeout")?n="Request timed out. Please check your connection.":t.message.includes("Network Error")?n="Network connection lost. Please check your internet connection.":t.message.includes("Failed to fetch")?n="Failed to connect to server. Please try again later.":n=t.message);const r=this.createError(n,"network",s,{},t);return this.logError(r),this.notifyListeners(r),r}}const M=new Pn;function k(e,t="unknown",n){switch(t){case"blockchain":return M.handleBlockchainError(e,n);case"contract":return M.handleContractError(e);case"network":return M.handleNetworkError(e);case"user_input":return M.handleValidationError(e);default:return M.handleError(e,n,t)}}class En{constructor(){this.isInitialized=!1,this.handleAppError=t=>{let n;switch(t.severity){case j.CRITICAL:case j.ERROR:n="error";break;case j.WARNING:n="warning";break;case j.INFO:default:n="info";break}let s="Error",r=5e3;switch(t.category){case w.BLOCKCHAIN:s="Blockchain Error",r=6e3;break;case w.CONTRACT:s="Smart Contract Error",r=6e3;break;case w.NETWORK:s="Network Error",r=4e3;break;case w.USER_INPUT:s="Validation Error",r=4e3;break;case w.AUTHENTICATION:s="Authentication Error",r=5e3;break;case w.API:s="API Error",r=5e3;break;default:s="Error",r=5e3}this.notify({title:s,description:t.message,type:n,closeAfterMs:r,autoClose:!0})}}initialize(){this.isInitialized||(M.registerErrorListener(this.handleAppError),this.isInitialized=!0)}success(t,n={}){this.notify({description:t,type:"success",autoClose:!0,closeAfterMs:4e3,...n})}info(t,n={}){this.notify({description:t,type:"info",autoClose:!0,closeAfterMs:4e3,...n})}warning(t,n={}){this.notify({description:t,type:"warning",autoClose:!0,closeAfterMs:5e3,...n})}error(t,n={}){this.notify({description:t,type:"error",autoClose:!0,closeAfterMs:6e3,...n})}transaction(t,n="sepolia",s={}){const o=`${n==="mainnet"?"https://etherscan.io":`https://${n}.etherscan.io`}/tx/${t}`;return B.loading("Transaction pending. Click to view on Etherscan.",{duration:1/0,position:"bottom-right",onClick:()=>{window.open(o,"_blank")},...s})}updateTransaction(t,n,s){switch(n){case"success":B.success(s||"Transaction confirmed!",{id:t,duration:5e3});break;case"error":B.error(s||"Transaction failed",{id:t,duration:7e3});break;case"loading":B.loading(s||"Transaction in progress...",{id:t,duration:1/0});break}}notify(t){const{title:n,description:s,type:r="info",autoClose:o=!0,closeAfterMs:i=4e3,...a}=t;let c;switch(r){case"success":c=B.success;break;case"error":c=B.error;break;case"warning":c=(l,d)=>B(l,{...d,icon:"⚠️"});break;case"info":default:c=B;break}const u=n?`${n}: ${s}`:s;c(u,{duration:o?i:1/0,position:"bottom-center",...a})}dismissAll(){B.dismiss()}}const y=new En;y.initialize();const Cn={"0x05b366778566e93abfb8e4a9b794e4ad006446b4":{symbol:"DLOOP",name:"D-Loop Token",decimals:18},"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48":{symbol:"USDC",name:"USD Coin",decimals:6},"0x2260fac5e5542a773aa44fbcfedf7c193bc2c599":{symbol:"WBTC",name:"Wrapped Bitcoin",decimals:8},"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2":{symbol:"WETH",name:"Wrapped Ether",decimals:18},"0xda9d4f9b69ac6c22e444ed9af0cfc043b7a7f53f":{symbol:"USDC",name:"USD Coin (Sepolia)",decimals:6},"0x3e622317f8c93f7328350cf0b56d9ed4c620c5d6":{symbol:"WBTC",name:"Wrapped Bitcoin (Sepolia)",decimals:8}};class vn{constructor(t=Cn){this.provider=null,this.cache=new Map,this.tokenRegistry={...t}}setProvider(t){this.provider=t}getERC20ABI(){return["function symbol() view returns (string)","function name() view returns (string)","function decimals() view returns (uint8)"]}registerToken(t,n){const s=t.toLowerCase();return this.tokenRegistry[s]=n,this.cache.set(s,n),n}updateToken(t,n){const s=t.toLowerCase();return this.tokenRegistry[s]?(this.tokenRegistry[s]={...this.tokenRegistry[s],...n},this.cache.set(s,this.tokenRegistry[s]),this.tokenRegistry[s]):null}getTokenInfo(t){if(!t)return null;const n=t.toLowerCase();if(this.cache.has(n))return this.cache.get(n)||null;const s=this.tokenRegistry[n];return s?(this.cache.set(n,s),s):null}getTokenSymbol(t){if(!t)return"Unknown";if(!t.startsWith("0x")||t.length!==42)return t;const n=this.getTokenInfo(t);return n?n.symbol:(this.fetchTokenInfoAsync(t),this.formatUnknownToken(t))}formatUnknownToken(t){return t?`${t.substring(0,6)}...${t.substring(t.length-4)}`:"Unknown"}async fetchTokenInfoAsync(t){if(!this.provider||!t||!t.startsWith("0x"))return null;const n=t.toLowerCase();try{const s=new Ge(t,this.getERC20ABI(),this.provider),[r,o,i]=await Promise.all([s.symbol(),s.name(),s.decimals()]),a={symbol:r,name:o,decimals:i};return this.registerToken(n,a),a}catch(s){return console.error(`Failed to fetch token info for ${t}:`,s),null}}formatAmount(t,n,s=18){const r=this.getTokenInfo(n),o=(r==null?void 0:r.decimals)??s;try{const i=typeof t=="number"?t:parseFloat(t);return isNaN(i)?"0":i.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:o})}catch(i){return console.warn(`Error formatting amount for token ${n}:`,i),t.toString()}}clearCache(){this.cache.clear()}}const ve=new vn;var An=(e=>(e[e.Investment=0]="Investment",e[e.Divestment=1]="Divestment",e[e.ParameterChange=2]="ParameterChange",e[e.Other=3]="Other",e))(An||{}),Bn=(e=>(e[e.Pending=0]="Pending",e[e.Active=1]="Active",e[e.Defeated=2]="Defeated",e[e.Succeeded=3]="Succeeded",e[e.Queued=4]="Queued",e[e.Executed=5]="Executed",e[e.Expired=6]="Expired",e[e.Canceled=7]="Canceled",e))(Bn||{});const Tn=e=>{const t=Number(e.state||e.status||0),n=e.forVotes||e.yesVotes||0,s=e.againstVotes||e.noVotes||0;return{id:Number(e.id||0),proposer:e.proposer||pe,description:e.description||"",proposalType:Number(e.proposalType||0),token:e.token||e.assetAddress||pe,amount:parseFloat(ne(e.amount||0,18,6)),createdAt:new Date(Number(e.createdAt||0)*1e3),votingEnds:new Date(Number(e.votingEnds||0)*1e3),forVotes:parseFloat(ne(n,18,6)),againstVotes:parseFloat(ne(s,18,6)),executed:!!e.executed,canceled:!!e.canceled,state:t}},Nn={async getProposalDetails(e,t){try{const n=T("AssetDAO",e),s=await D(n.getProposal,[t],"Error fetching proposal details");return Tn(s)}catch(n){const s=k(n,w.CONTRACT,`Failed to fetch proposal #${t}`);throw new Error(s.message,{cause:n})}},async createInvestmentProposal(e,t,n,s){try{const r=T("AssetDAO",e);if(!ie(t))throw new Error("Invalid token address format");return y.info("Preparing investment proposal transaction..."),await V(r.propose,[0,t,n,s],{errorPrefix:"Investment Proposal Error",onSubmitted:o=>{y.transaction(o.hash,"sepolia",{title:"Investment Proposal"})},onConfirmed:()=>{y.success("Investment proposal created successfully!");try{const o=new Ge(t,["function symbol() view returns (string)","function decimals() view returns (uint8)"],e);o.symbol().then(i=>{ve.registerToken(t,{symbol:i,name:i,decimals:18}),o.decimals().then(a=>{ve.updateToken(t,{decimals:a})}).catch(()=>{})}).catch(()=>{})}catch{}}})}catch(r){throw k(r,w.CONTRACT),r}},async createDivestmentProposal(e,t,n,s){try{const r=T("AssetDAO",e);if(!ie(t))throw new Error("Invalid token address format");return y.info("Preparing divestment proposal transaction..."),await V(r.propose,[1,t,n,s],{errorPrefix:"Divestment Proposal Error",onSubmitted:o=>{y.transaction(o.hash,"sepolia",{title:"Divestment Proposal"})},onConfirmed:()=>{y.success("Divestment proposal created successfully!")}})}catch(r){throw k(r,w.CONTRACT),r}},async createParameterChangeProposal(e,t,n,s){try{const r=T("AssetDAO",e);if(!ie(t))throw new Error("Invalid parameter address format");return y.info("Preparing parameter change proposal transaction..."),await V(r.propose,[2,t,n,s],{errorPrefix:"Parameter Change Proposal Error",onSubmitted:o=>{y.transaction(o.hash,"sepolia",{title:"Parameter Change Proposal"})},onConfirmed:()=>{y.success("Parameter change proposal created successfully!")}})}catch(r){throw k(r,w.CONTRACT),r}},async voteOnProposal(e,t,n){try{const s=T("AssetDAO",e),r=n?"For":"Against";try{const o=await D(s.getProposalCount,[],"Proposal Validation Error");if(!t||t<=0||t>o)throw new Error(`Invalid proposal ID: ${t}. Valid range is 1-${o}.`);try{await D(s.getProposal,[t],"Proposal Validation Error")}catch{throw new Error(`Proposal #${t} cannot be accessed. It may be corrupted or invalid.`)}}catch(o){throw y.error(`Cannot vote: ${o.message}`),o}y.info(`Preparing to vote ${r} proposal #${t}...`);try{return await V((...i)=>s.vote(...i),[t,n],{errorPrefix:"Voting Error",onSubmitted:i=>{y.transaction(i.hash,"sepolia",{title:`Vote ${r}`})},onConfirmed:()=>{y.success(`Successfully voted ${r} proposal #${t}`)}})}catch(o){if(o.message&&(o.message.includes("has no method")||o.message.includes("not a function")||o.message.includes("unknown function")))return console.log("vote() function not found, trying castVote()..."),await V(s.castVote,[t,n],{errorPrefix:"Voting Error",onSubmitted:i=>{y.transaction(i.hash,"sepolia",{title:`Vote ${r}`})},onConfirmed:()=>{y.success(`Successfully voted ${r} proposal #${t}`)}});throw o}}catch(s){throw k(s,w.CONTRACT),s}},async checkVotingStatus(e,t,n){try{const s=T("AssetDAO",e);if(s&&typeof s.getReceipt=="function")try{const r=await D(s.getReceipt,[t,n],"Error checking vote receipt");return{hasVoted:r.hasVoted,support:r.support,votes:parseFloat(ne(r.votes,18,6))}}catch(r){console.warn("Error using getReceipt method, falling back to alternative",r)}try{return s&&typeof s.hasVoted=="function"?{hasVoted:await D(s.hasVoted,[t,n],"Error checking voting status")}:(console.warn("No voting check methods available on contract"),{hasVoted:!1})}catch(r){return console.error("Error in fallback voting check:",r),{hasVoted:!1}}}catch(s){return k(s,w.CONTRACT),{hasVoted:!1}}},async executeProposal(e,t){try{const n=T("AssetDAO",e);return y.info(`Preparing to execute proposal #${t}...`),await V(n.executeProposal,[t],{errorPrefix:"Execution Error",onSubmitted:s=>{y.transaction(s.hash,"sepolia",{title:"Execute Proposal"})},onConfirmed:()=>{y.success(`Successfully executed proposal #${t}`)}})}catch(n){throw k(n,w.CONTRACT),n}},async cancelProposal(e,t){try{const n=T("AssetDAO",e);return y.info(`Preparing to cancel proposal #${t}...`),await V(n.cancelProposal,[t],{errorPrefix:"Cancellation Error",onSubmitted:s=>{y.transaction(s.hash,"sepolia",{title:"Cancel Proposal"})},onConfirmed:()=>{y.success(`Successfully canceled proposal #${t}`)}})}catch(n){throw k(n,w.CONTRACT),n}},async getAllProposals(e,t={}){try{const{limit:n=50,offset:s=0}=t,r=T("AssetDAO",e),o=await D(r.getProposalCount,[],"Error fetching proposal count"),i=Number(o),a=Math.max(0,i-s-n),c=Math.max(0,i-s),u=[];for(let l=a;l<c;l++)u.push(this.getProposalDetails(e,l));return await Promise.all(u)}catch(n){return k(n,w.CONTRACT,"Failed to fetch proposals"),[]}}};function Gn(){const{address:e,isConnected:t,isConnecting:n}=vt(),{disconnect:s,isPending:r}=At(),o=Bt(),{data:i}=Tt({address:e,query:{enabled:!!e}}),{connect:a,isNetworkSupported:c,switchToSepolia:u}=kt();return{address:e||null,isConnected:t,isConnecting:n,isDisconnecting:r,chainId:o,balance:i?i.formatted:null,isNetworkSupported:o===It.id,connect:a,disconnect:s,switchToSepolia:u,usingWagmi:!0}}function Ln(e){let t=0,n=0;const s=e.tokenDecimals||18,r=(o,i=18)=>{if(o==null)return 0;try{if(typeof o=="bigint"){const a=K(o,i);return Math.max(0,Number(a))}if(typeof o=="string"&&o!==""){if(o.trim()==="0"||o.trim()==="")return 0;if(o.startsWith("0x")){const c=K(BigInt(o),i);return Math.max(0,Number(c))}if(/^\d{11,}$/.test(o)){const c=K(BigInt(o),i);return Math.max(0,Number(c))}const a=parseFloat(o);return Math.max(0,isNaN(a)?0:a)}if(typeof o=="number"){if(o>1e15){const a=K(BigInt(Math.floor(o)),i);return Math.max(0,Number(a))}return Math.max(0,o)}if(typeof o=="object"&&o.toString){const a=o.toString();if(a.startsWith("0x")||/^\d{11,}$/.test(a)){const u=K(BigInt(a),i);return Math.max(0,Number(u))}const c=parseFloat(a);return Math.max(0,isNaN(c)?0:c)}}catch(a){console.warn("Error converting vote value:",a,{value:o,type:typeof o,decimals:i,stringified:JSON.stringify(o)})}return 0};return e.forVotes!==void 0&&e.forVotes!==null?t=r(e.forVotes,s):e.for_votes!==void 0&&e.for_votes!==null?t=r(e.for_votes,s):e.votesFor!==void 0&&e.votesFor!==null?t=r(e.votesFor,s):e.votes_for!==void 0&&e.votes_for!==null&&(t=r(e.votes_for,s)),e.againstVotes!==void 0&&e.againstVotes!==null?n=r(e.againstVotes,s):e.against_votes!==void 0&&e.against_votes!==null?n=r(e.against_votes,s):e.votesAgainst!==void 0&&e.votesAgainst!==null?n=r(e.votesAgainst,s):e.votes_against!==void 0&&e.votes_against!==null&&(n=r(e.votes_against,s)),{forVotes:t,againstVotes:n}}function Rn(e,t){const n=isNaN(e)?0:Math.max(0,e),s=isNaN(t)?0:Math.max(0,t),r=n+s,o=r>0?n/r*100:0,i=r>0?s/r*100:0;return{totalVotes:r,forPercentage:o,againstPercentage:i,hasVotes:r>0,forVotes:n,againstVotes:s}}function Vn(e){if(!e||typeof e!="object")return{hasVoted:!1};const t=!!e.hasVoted;let n;return t&&(e.support!==void 0&&e.support!==null?n=!!e.support:e.vote!==void 0&&e.vote!==null?n=e.vote===1||e.vote==="1"||e.vote===!0:e.choice!==void 0&&e.choice!==null?typeof e.choice=="boolean"?n=e.choice:typeof e.choice=="number"?n=e.choice===1:typeof e.choice=="string"&&(n=e.choice.toLowerCase()==="for"||e.choice==="1"):e.voteChoice!==void 0&&e.voteChoice!==null&&(n=e.voteChoice===1||e.voteChoice==="1"||e.voteChoice===!0)),{hasVoted:t,support:n}}export{Ut as B,Nn as E,Bn as P,ve as T,An as a,Fn as b,Rn as c,Ln as e,zt as f,se as g,sn as s,St as t,Gn as u,Vn as v};
