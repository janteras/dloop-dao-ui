import{c as H,r,u as he,w as ue,j as e,O as t,g as n,P as R,Q as F,C as v,s as f,a as ge}from"./index-e1be7c10.js";import{C as Z,a as K,b as pe,B as S,c as _,F as fe,A as je,S as i}from"./badge-89e0588b.js";import{P as Ne}from"./page-header-ce70d00b.js";import{u as ve,U as $,D as ye,a as we}from"./undelegate-tokens-modal-3deb5cf7.js";import{u as be,P as Ce}from"./PageContainer-8e534529.js";import{T as q}from"./trending-up-38ad7eff.js";import{C as y}from"./chevron-up-a937d1d5.js";import{L as W}from"./loader-circle-4ab48cad.js";import"./types-4adccaac.js";import"./label-89400795.js";import"./contracts-3445139a.js";import"./tokenDelegationService-08217fd4.js";import"./useTokenInfo-41555799.js";import"./activity-6a1b6971.js";import"./circle-check-big-e37d016f.js";import"./api-utils-216de986.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=H("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=H("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=H("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function ke({index:l=0}){return e.jsx(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:l*.05,ease:[.4,0,.2,1]},children:e.jsxs(Z,{className:"overflow-hidden border-l-4 border-l-gray-300 dark:border-l-gray-700",children:[e.jsx(K,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(i,{className:"h-12 w-12 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"h-5 w-40"}),e.jsx(i,{className:"h-4 w-28"})]})]}),e.jsx(i,{className:"h-8 w-14 rounded-full"})]})}),e.jsxs(_,{children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[1,2,3,4].map(w=>e.jsxs("div",{className:"p-2 rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(i,{className:"h-4 w-4"}),e.jsx(i,{className:"h-3 w-20"})]}),e.jsx(i,{className:"h-5 w-24"})]},w))}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(i,{className:"h-9 w-24 rounded-md"}),e.jsx(i,{className:"h-9 w-20 rounded-md"})]})]})]})})}function Pe(){const[l,w]=r.useState("votingPower"),[o,I]=r.useState("desc"),[m,b]=r.useState("all"),[x,J]=r.useState(null),[X,L]=r.useState(!1),[C,ee]=r.useState({}),[j,se]=r.useState(null),[ae,U]=r.useState(!1),{isConnected:d,balance:Te,address:D}=he(),{toast:g}=be(),[N,O]=r.useState(3),z=r.useRef(null),{data:k,isLoading:te}=ue({queryKey:["dao-portfolio"],queryFn:async()=>({dloopBalance:1e3,daiBalance:250,delegatedDloop:350,pendingRewards:25,totalVotingPower:1350}),enabled:d}),p=(k==null?void 0:k.dloopBalance)||0,{participants:le,delegations:P,isLoading:re,delegateTokens:Ae,undelegateTokens:Se,isDelegating:ne}=ve(),T=re||te,ie=Object.fromEntries((P||[]).map(s=>{var a;return[((a=s.from)==null?void 0:a.toLowerCase())||"",s.to]})),B=(le||[]).map(s=>{var a;return{...s,delegatedTo:s.address?ie[s.address.toLowerCase()||""]:void 0,delegatedToName:s.address?(a=(P||[]).find(u=>{var c,E;return((c=u.from)==null?void 0:c.toLowerCase())===((E=s.address)==null?void 0:E.toLowerCase())}))==null?void 0:a.toName:void 0,isCurrentUser:s.isCurrentUser||!1}}),h=[...m==="all"?B:B.filter(s=>s.type===m)].sort((s,a)=>o==="asc"?s[l]-a[l]:a[l]-s[l]),M=h.slice(0,N),de=()=>{setTimeout(()=>{O(s=>{const a=s+3;return Math.min(a,h.length)})},300)};r.useEffect(()=>{const s=new IntersectionObserver(u=>{const[c]=u;c.isIntersecting&&N<h.length&&de()},{threshold:.1}),a=z.current;return a&&s.observe(a),()=>{a&&s.unobserve(a)}},[N,h.length]),r.useEffect(()=>{O(3)},[m,l,o]);const A=s=>{l===s?I(o==="asc"?"desc":"asc"):(w(s),I("desc"))},V=s=>{if(!d){g({title:"Wallet Not Connected",description:"Please connect your wallet to delegate tokens.",variant:"destructive"});return}if(p<=0){g({title:"Insufficient Balance",description:"You do not have any DLOOP tokens available to delegate.",variant:"destructive"});return}J(s),L(!0)},ce=()=>{if(!d){g({title:"Wallet Not Connected",description:"Please connect your wallet.",variant:"destructive"});return}if(!D)return;const s=P.find(a=>a.from.toLowerCase()===D.toLowerCase());s&&(se(s),U(!0))},oe=s=>{ee(a=>({...a,[s]:!a[s]}))},me={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},xe={hidden:{y:20,opacity:0},show:{y:0,opacity:1,transition:{type:"spring",stiffness:300,damping:24}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(t.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.4},children:e.jsx(Ne,{title:"Governance Leaderboard",description:"Track top performers and most accurate AI governance nodes"})}),e.jsxs(t.div,{className:"flex flex-wrap justify-between gap-4 mb-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(t.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(n,{variant:m==="all"?"default":"outline",size:"sm",onClick:()=>b("all"),className:"flex items-center gap-1 h-10 px-4",children:[e.jsx(R,{className:"h-4 w-4"})," All"]})}),e.jsx(t.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(n,{variant:m==="Human"?"default":"outline",size:"sm",onClick:()=>b("Human"),className:"flex items-center gap-1 h-10 px-4",children:[e.jsx($,{className:"h-4 w-4"})," Humans"]})}),e.jsx(t.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(n,{variant:m==="AI Node"?"default":"outline",size:"sm",onClick:()=>b("AI Node"),className:"flex items-center gap-1 h-10 px-4",children:[e.jsx(F,{className:"h-4 w-4"})," AI Nodes"]})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(t.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(n,{variant:l==="votingPower"?"default":"outline",size:"sm",onClick:()=>A("votingPower"),className:"flex items-center gap-1 h-10 px-4",children:[e.jsx(q,{className:"h-4 w-4"})," Voting Power",l==="votingPower"&&(o==="asc"?e.jsx(y,{className:"h-4 w-4"}):e.jsx(v,{className:"h-4 w-4"}))]})}),e.jsx(t.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(n,{variant:l==="performance"?"default":"outline",size:"sm",onClick:()=>A("performance"),className:"flex items-center gap-1 h-10 px-4",children:[e.jsx(Q,{className:"h-4 w-4"})," Performance",l==="performance"&&(o==="asc"?e.jsx(y,{className:"h-4 w-4"}):e.jsx(v,{className:"h-4 w-4"}))]})}),e.jsx(t.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(n,{variant:l==="accuracy"?"default":"outline",size:"sm",onClick:()=>A("accuracy"),className:"flex items-center gap-1 h-10 px-4",children:[e.jsx(Y,{className:"h-4 w-4"})," Accuracy",l==="accuracy"&&(o==="asc"?e.jsx(y,{className:"h-4 w-4"}):e.jsx(v,{className:"h-4 w-4"}))]})})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",e.jsx("span",{className:"font-medium",children:M.length})," of"," ",e.jsx("span",{className:"font-medium",children:h.length})," participants"]}),T&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(W,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Loading participants..."})]})]}),e.jsxs(t.div,{className:"grid gap-4",variants:me,initial:"hidden",animate:"show",children:[T?Array.from({length:3}).map((s,a)=>e.jsx(ke,{index:a},a)):M.map((s,a)=>{var u,c;return e.jsx(t.div,{variants:xe,whileHover:{scale:1.01,transition:{duration:.2}},layout:!0,children:e.jsxs(Z,{className:`overflow-hidden transition-all duration-300 ${s.isCurrentUser?"border-primary":s.type==="AI Node"?"border-l-4 border-l-purple-500":"border-l-4 border-l-blue-500"} hover:shadow-md`,children:[e.jsx(K,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(t.div,{className:`flex h-12 w-12 items-center justify-center rounded-full ${s.type==="AI Node"?"bg-purple-100 text-purple-500 dark:bg-purple-900/20 dark:text-purple-300":"bg-blue-100 text-blue-500 dark:bg-blue-900/20 dark:text-blue-300"}`,whileHover:{scale:1.1,rotate:10},children:s.type==="AI Node"?e.jsx(F,{className:"h-6 w-6"}):e.jsx($,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsxs(pe,{className:"text-base flex items-center gap-2",children:[s.name||f(s.address),s.isCurrentUser&&e.jsx(t.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,delay:.2},children:e.jsx(S,{variant:"outline",className:"ml-1",children:"You"})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-1",children:[e.jsx("span",{children:f(s.address)}),e.jsx(S,{variant:s.type==="AI Node"?"info":"secondary",className:s.type==="AI Node"?"bg-purple-100/50 dark:bg-purple-900/50":"",children:s.type})]})]})]}),e.jsxs(t.div,{className:"text-right bg-muted/50 px-3 py-1 rounded-full flex items-center gap-1",whileHover:{scale:1.05,backgroundColor:s.type==="AI Node"?"rgba(147, 51, 234, 0.1)":"rgba(59, 130, 246, 0.1)"},children:[e.jsx(R,{className:"h-4 w-4 text-yellow-500"}),e.jsxs("div",{className:"font-bold",children:["#",a+1]})]})]})}),e.jsxs(_,{children:[e.jsxs(t.div,{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[e.jsxs(t.div,{className:"p-2 rounded-lg bg-muted/30 hover:bg-muted/50 transition-colors",whileHover:{scale:1.03},children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"h-4 w-4 text-green-500"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Voting Power"})]}),e.jsxs("p",{className:"font-medium text-base",children:[ge(s.votingPower)," DLOOP"]})]}),e.jsxs(t.div,{className:"p-2 rounded-lg bg-muted/30 hover:bg-muted/50 transition-colors",whileHover:{scale:1.03},children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"h-4 w-4 text-amber-500"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Performance"})]}),e.jsxs("p",{className:"font-medium text-green-500 text-base",children:["+",(s.performance||0).toFixed(1),"%"]})]}),e.jsxs(t.div,{className:"p-2 rounded-lg bg-muted/30 hover:bg-muted/50 transition-colors",whileHover:{scale:1.03},children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"h-4 w-4 text-red-500"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Accuracy"})]}),e.jsxs("p",{className:"font-medium text-base",children:[s.accuracy,"%"]})]}),e.jsxs(t.div,{className:"p-2 rounded-lg bg-muted/30 hover:bg-muted/50 transition-colors",whileHover:{scale:1.03},children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fe,{className:"h-4 w-4 text-blue-500"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Proposals"})]}),e.jsxs("p",{className:"font-medium text-base",children:[s.proposalsCreated," created / ",s.proposalsVoted," voted"]})]})]}),C[s.address]&&e.jsx(t.div,{className:"mt-4 p-4 bg-muted/20 rounded-lg border border-muted",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Governance Activity"}),e.jsxs("ul",{className:"space-y-1 text-sm",children:[e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Proposals Created:"}),e.jsx("span",{children:s.proposalsCreated})]}),e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Proposals Voted:"}),e.jsx("span",{children:s.proposalsVoted})]}),e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Voting Success Rate:"}),e.jsxs("span",{className:"text-green-500",children:[s.accuracy,"%"]})]})]})]}),s.type==="AI Node"&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"AI Node Stats"}),e.jsxs("ul",{className:"space-y-1 text-sm",children:[e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Strategy Type:"}),e.jsx("span",{children:(u=s.name)!=null&&u.includes("Alpha")?"Aggressive":(c=s.name)!=null&&c.includes("Beta")?"Balanced":"Conservative"})]}),e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Performance YTD:"}),e.jsxs("span",{className:"text-green-500",children:["+",s.performance.toFixed(1),"%"]})]}),e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Prediction Accuracy:"}),e.jsxs("span",{children:[s.accuracy,"%"]})]})]})]})]})}),s.delegatedTo&&e.jsxs(t.div,{className:"mt-2 text-sm flex items-center p-2 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-900",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:[e.jsx(G,{className:"h-4 w-4 text-blue-500 mr-2"}),e.jsx("span",{className:"text-muted-foreground mr-2",children:"Delegated to:"}),e.jsx(S,{variant:"outline",className:"bg-blue-100/50 dark:bg-blue-900/50",children:s.delegatedToName||f(s.delegatedTo)})]}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(t.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>oe(s.address),className:"flex items-center gap-1 h-10 px-4",children:[C[s.address]?"Less Details":"More Details",C[s.address]?e.jsx(y,{className:"h-4 w-4"}):e.jsx(v,{className:"h-4 w-4"})]})}),e.jsx(t.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:s.type==="AI Node"?e.jsxs(n,{size:"sm",className:`relative group overflow-hidden h-10 px-4 ${!d||p<=0?"opacity-70":""}`,onClick:()=>V(s),disabled:!d||p<=0,children:[e.jsxs("span",{className:"relative z-10 flex items-center gap-1",children:["Delegate Tokens",e.jsx(G,{className:"h-4 w-4"})]}),e.jsx("span",{className:"absolute inset-0 bg-primary/10 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left"})]}):e.jsxs(n,{variant:"outline",size:"sm",className:"flex items-center gap-1 h-10 px-4",onClick:()=>V(s),disabled:!d||p<=0,children:[e.jsx("span",{className:"relative z-10 flex items-center gap-1",children:"Delegate to this User"}),e.jsx("span",{className:"absolute inset-0 bg-blue-100 dark:bg-blue-900/20 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left"})]})}),s.isCurrentUser&&s.delegatedTo&&e.jsx(t.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(n,{variant:"outline",size:"sm",className:"flex items-center gap-1 h-10 px-4",onClick:ce,disabled:!d||ne,children:e.jsxs("span",{className:"relative z-10 flex items-center gap-1",children:["Undelegate",e.jsx(je,{className:"h-4 w-4"})]})})})]})]})]})},s.address)}),!T&&N<h.length&&e.jsx("div",{ref:z,className:"flex justify-center p-4",children:e.jsx(W,{className:"h-6 w-6 animate-spin text-primary"})})]}),x&&e.jsx(ye,{isOpen:X,onClose:()=>L(!1),recipientAddress:x.address,recipientName:x.name,recipientType:x.type,availableBalance:p,onSuccess:()=>{g({title:"Tokens Delegated",description:`Successfully delegated tokens to ${x.name||f(x.address)}`})}}),j&&e.jsx(we,{isOpen:ae,onClose:()=>U(!1),delegation:j,onSuccess:()=>{g({title:"Tokens Undelegated",description:`Successfully undelegated tokens from ${j.toName||f(j.to)}`})}})]})}function Ge(){return e.jsx(Ce,{children:e.jsx(Pe,{})})}export{Ge as default};
