import{k as y,D as A}from"./index-971aa118.js";import{u as k}from"./useWallet-793e28b3.js";import{d as f}from"./contracts-444c63f0.js";class v{getAllNodes(){return[{id:"node-1",name:"AI.Gov#01",address:"0x3639D1F746A977775522221f53D0B1eA5749b8b9",strategy:"Balanced",delegatedAmount:285e3,accuracy:87.5,performance:24.3,performance90d:21.8,proposalsCreated:32,proposalsPassed:28,tradingThesis:{description:"AI.Gov#01 utilizes a balanced approach to optimize for consistent returns in varied market conditions.",points:["Employs multi-factor analysis for asset allocation","Monitors market sentiment and on-chain indicators","Adapts strategy based on volatility regimes"],conclusion:"Well-suited for both bull and bear markets with an emphasis on capital preservation."},recentActivity:[{title:"Created Proposal: USDC reallocation",date:"2 days ago",status:"Passed"},{title:"Voted: ETH DeFi exposure",date:"5 days ago",status:"For"},{title:"Created Proposal: Risk parameters update",date:"2 weeks ago",status:"Passed"}]},{id:"node-2",name:"AI.Gov#02",address:"0x8Fc6C4F5d70C84c4BFf9a12a796F8940614FDCDb",strategy:"Growth",delegatedAmount:41e4,accuracy:82.1,performance:31.5,performance90d:28.7,proposalsCreated:27,proposalsPassed:23,tradingThesis:{description:"AI.Gov#02 focuses on high growth potential assets with a longer time horizon.",points:["Targets emerging sectors with exponential growth potential","Employs technical analysis for entry/exit timing","Uses on-chain data to identify early adoption trends"],conclusion:"Best suited for bull markets and investors with higher risk tolerance."},recentActivity:[{title:"Created Proposal: Increase L2 exposure",date:"3 days ago",status:"Passed"},{title:"Voted: Reduce stablecoin allocation",date:"1 week ago",status:"For"},{title:"Created Proposal: New DeFi protocol onboarding",date:"3 weeks ago",status:"Passed"}]},{id:"node-3",name:"AI.Gov#03",address:"0x2f384bDD6bBa4c8ABE151237C6bEA1F1C9995d17",strategy:"Conservative",delegatedAmount:195e3,accuracy:91.3,performance:18.2,performance90d:16.5,proposalsCreated:19,proposalsPassed:18,tradingThesis:{description:"AI.Gov#03 prioritizes capital preservation with a focus on stable assets and lower volatility.",points:["Maintains significant stablecoin allocation","Favors established blue-chip assets","Implements strict risk management protocols"],conclusion:"Optimized for defensive positioning during market uncertainty."},recentActivity:[{title:"Created Proposal: Increase USDC reserves",date:"4 days ago",status:"Passed"},{title:"Voted: Reduce altcoin exposure",date:"1 week ago",status:"For"},{title:"Created Proposal: Hedging strategy implementation",date:"2 weeks ago",status:"Passed"}]},{id:"node-4",name:"AI.Gov#04",address:"0x9a67F1940164d0318612b497E8e6038f902a3cBb",strategy:"Momentum",delegatedAmount:325e3,accuracy:79.8,performance:29.7,performance90d:26.2,proposalsCreated:24,proposalsPassed:21,tradingThesis:{description:"AI.Gov#04 capitalizes on market momentum and trend-following strategies.",points:["Uses advanced technical indicators to identify trends","Implements dynamic position sizing based on market strength","Focuses on assets with strong relative strength"],conclusion:"Effective in trending markets with clear directional bias."},recentActivity:[{title:"Created Proposal: Increase ETH allocation",date:"2 days ago",status:"Passed"},{title:"Voted: Enter new altcoin positions",date:"1 week ago",status:"For"},{title:"Created Proposal: Reduce BTC exposure",date:"3 weeks ago",status:"Failed"}]},{id:"node-5",name:"AI.Gov#05",address:"0x6B175474E89094C44Da98b954EedeAC495271d0F",strategy:"Adaptive",delegatedAmount:275e3,accuracy:85.2,performance:26.8,performance90d:24.1,proposalsCreated:28,proposalsPassed:25,tradingThesis:{description:"AI.Gov#05 uses adaptive algorithms to switch between different strategies based on market conditions.",points:["Employs regime detection to identify market states","Dynamically allocates between growth and defensive assets","Leverages multiple timeframes for decision making"],conclusion:"Well-balanced approach that adapts to changing market environments."},recentActivity:[{title:"Created Proposal: Rebalance portfolio",date:"5 days ago",status:"Passed"},{title:"Voted: Add new yield farming strategy",date:"2 weeks ago",status:"Against"},{title:"Created Proposal: Risk parameter update",date:"3 weeks ago",status:"Passed"}]},{id:"node-6",name:"AI.Gov#06",address:"0x4Fabb145d64652a948d72533023f6E7A623C7C53",strategy:"Value",delegatedAmount:23e4,accuracy:88.7,performance:22.1,performance90d:19.8,proposalsCreated:21,proposalsPassed:19,tradingThesis:{description:"AI.Gov#06 focuses on fundamental value and undervalued assets with strong growth potential.",points:["Analyzes on-chain metrics to identify undervalued assets","Focuses on protocols with strong fundamentals and adoption","Prioritizes assets with sustainable tokenomics"],conclusion:"Best suited for accumulation phases and long-term investment horizons."},recentActivity:[{title:"Created Proposal: Increase Layer 1 allocation",date:"3 days ago",status:"Passed"},{title:"Voted: Accumulate undervalued DeFi tokens",date:"1 week ago",status:"For"},{title:"Created Proposal: Reduce meme coin exposure",date:"2 weeks ago",status:"Passed"}]},{id:"node-7",name:"AI.Gov#07",address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",strategy:"Technical",delegatedAmount:31e4,accuracy:80.5,performance:28.3,performance90d:25.6,proposalsCreated:26,proposalsPassed:22,tradingThesis:{description:"AI.Gov#07 relies heavily on technical analysis and pattern recognition for trading decisions.",points:["Employs advanced chart pattern recognition","Uses indicator-based trading signals","Focuses on high-probability technical setups"],conclusion:"Optimized for active trading in volatile market conditions."},recentActivity:[{title:"Created Proposal: Short-term BTC position",date:"2 days ago",status:"Passed"},{title:"Voted: Exit altcoin positions",date:"1 week ago",status:"For"},{title:"Created Proposal: Implement trailing stops",date:"3 weeks ago",status:"Passed"}]},{id:"node-8",name:"AI.Gov#08",address:"0xdAC17F958D2ee523a2206206994597C13D831ec7",strategy:"Quantitative",delegatedAmount:295e3,accuracy:86.9,performance:25.4,performance90d:23.1,proposalsCreated:29,proposalsPassed:26,tradingThesis:{description:"AI.Gov#08 leverages quantitative models and statistical arbitrage for decision making.",points:["Uses statistical analysis to identify market inefficiencies","Employs machine learning for pattern detection","Focuses on data-driven decision making"],conclusion:"Well-suited for exploiting short-term market inefficiencies."},recentActivity:[{title:"Created Proposal: Arbitrage strategy implementation",date:"4 days ago",status:"Passed"},{title:"Voted: New correlation trading approach",date:"2 weeks ago",status:"For"},{title:"Created Proposal: Optimize position sizing",date:"3 weeks ago",status:"Passed"}]},{id:"node-9",name:"AI.Gov#09",address:"0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599",strategy:"Fundamental",delegatedAmount:255e3,accuracy:89.2,performance:23.8,performance90d:21.2,proposalsCreated:22,proposalsPassed:20,tradingThesis:{description:"AI.Gov#09 focuses on fundamental analysis and protocol-level research.",points:["Evaluates protocol fundamentals and tokenomics","Analyzes developer activity and community growth","Monitors on-chain activity for usage trends"],conclusion:"Best suited for long-term investment based on protocol fundamentals."},recentActivity:[{title:"Created Proposal: Increase allocation to emerging L1s",date:"5 days ago",status:"Passed"},{title:"Voted: Reduce exposure to governance tokens",date:"2 weeks ago",status:"Against"},{title:"Created Proposal: New fundamental analysis framework",date:"4 weeks ago",status:"Passed"}]},{id:"node-10",name:"AI.Gov#10",address:"0x7D1AfA7B718fb893dB30A3aBc0Cfc608AaCfeBB0",strategy:"Meta",delegatedAmount:35e4,accuracy:84.6,performance:27.5,performance90d:24.8,proposalsCreated:31,proposalsPassed:27,tradingThesis:{description:"AI.Gov#10 aggregates signals from other AI nodes to create a meta-strategy.",points:["Analyzes proposals and voting patterns across nodes","Weights decisions based on historical performance","Attempts to capture the best strategies from all nodes"],conclusion:"Provides diversified exposure to multiple AI node strategies."},recentActivity:[{title:"Created Proposal: Optimize strategy weighting",date:"3 days ago",status:"Passed"},{title:"Voted: Adopt new cross-node collaboration",date:"1 week ago",status:"For"},{title:"Created Proposal: Meta-governance framework",date:"3 weeks ago",status:"Passed"}]}]}getNodeById(e){return this.getAllNodes().find(t=>t.id===e)||null}}const h=new v;class b{async getTokenById(e,a){try{if(!a)throw new Error("Provider is required");const t=f("SoulboundNFT",a),n=await t.getTokenDetails(e),r=await t.isTokenValid(e),c={id:e,owner:n.tokenOwner,uri:n.uri,mintedAt:Number(n.mintedAt),revoked:n.revoked,valid:r};try{try{const o=await fetch(n.uri,{mode:"cors"});if(o.ok)c.metadata=await o.json();else throw new Error(`Failed to fetch metadata: ${o.status}`)}catch{console.warn(`CORS error fetching metadata, using fallback for token ${e}`),c.metadata=this.getFallbackMetadata(e)}}catch(o){console.error(`Error processing metadata for token ${e}:`,o),c.metadata=this.getFallbackMetadata(e)}return c}catch(t){return console.error(`Error fetching token ${e}:`,t),null}}getFallbackMetadata(e){return{name:`AI Node NFT #${e}`,description:"This AI Node NFT represents ownership of an AI governance node in the DLoop ecosystem.",image:`/nft-fallback-${e%5+1}.png`,attributes:[{trait_type:"Generation",value:"Genesis"},{trait_type:"Type",value:"Governance"},{trait_type:"Node ID",value:`node-${e}`},{trait_type:"Rarity",value:e<=3?"Legendary":e<=7?"Rare":"Common"}]}}async getTokensByOwner(e,a){try{if(!a)throw new Error("Provider is required");const n=await f("SoulboundNFT",a).getTokensByOwner(e),r=[];for(const c of n){const o=await this.getTokenById(Number(c),a);o&&r.push(o)}return r}catch(t){return console.error(`Error fetching tokens for owner ${e}:`,t),[]}}async getAllAINodeNFTs(e){try{if(!e)throw new Error("Provider is required");const a="0x3639D1F746A977775522221f53D0B1eA5749b8b9",t=[];for(let n=1;n<=10;n++){const r=await this.getTokenById(n,e);r&&t.push(r)}return t}catch(a){return console.error("Error fetching all AI Node NFTs:",a),[]}}async hasValidToken(e,a){try{if(!a)throw new Error("Provider is required");return await f("SoulboundNFT",a).hasValidToken(e)}catch(t){return console.error(`Error checking valid token for ${e}:`,t),!1}}}const I=new b;class F{constructor(){this.manifest=null,this.tokens=[],this.contractAbi=["function ownerOf(uint256 tokenId) external view returns (address)","function tokenURI(uint256 tokenId) external view returns (string)","function isTokenValid(uint256 tokenId) external view returns (bool)"],this.isDevelopmentMode=window.location.hostname==="localhost"}async fetchManifest(){if(this.manifest)return this.manifest;try{if(this.isDevelopmentMode)try{const e=new AbortController,a=setTimeout(()=>e.abort(),2e3),t=await fetch("https://d-loop.io/identity/identity.json",{signal:e.signal,mode:"cors",cache:"no-store"});if(clearTimeout(a),!t.ok)throw new Error(`Failed to fetch manifest: ${t.status}`);const r=(await t.json()).SoulboundNFT;return this.manifest=r,r}catch{return console.log("Development mode - Using fallback SoulboundNFT manifest"),this.getFallbackManifest()}else{const e=await fetch("https://d-loop.io/identity/identity.json",{cache:"no-store",mode:"cors"});if(e.ok){const t=(await e.json()).SoulboundNFT;return this.manifest=t,t}else throw new Error(`Failed to fetch manifest: ${e.status}`)}}catch(e){return this.isDevelopmentMode||console.error("Error fetching SoulboundNFT manifest:",e),this.getFallbackManifest()}}getFallbackManifest(){const e={address:"0x6391C14631b2Be5374297fA3110687b80233104c",args:["DLoop Identity Token","DLOOP-ID","https://d-loop.io/identity/",Array.from({length:10},(a,t)=>t+1)]};return this.manifest=e,e}async getAllTokens(e){this.manifest||await this.fetchManifest();const[a,t,n,r]=this.manifest.args,c=this.manifest.address,o=[],s=e?new y(c,this.contractAbi,e):null;for(const i of r){const u=`${n}${i}.json`,l={id:i,uri:u};if(s)try{l.owner=await s.ownerOf(i)}catch(d){console.warn(`Could not fetch owner for token ${i}:`,d)}try{if(this.isDevelopmentMode)try{const d=new AbortController,w=setTimeout(()=>d.abort(),1e3),p=await fetch(u,{signal:d.signal,mode:"cors"});if(clearTimeout(w),p.ok)l.metadata=await p.json();else throw new Error(`Error status: ${p.status}`)}catch{l.metadata=this.getFallbackMetadata(i)}else{const d=await fetch(u,{mode:"cors"});if(d.ok)l.metadata=await d.json();else throw new Error(`Error fetching metadata: ${d.status}`)}}catch{this.isDevelopmentMode||console.warn(`CORS or fetch error for token ${i}, using fallback metadata`),l.metadata=this.getFallbackMetadata(i)}o.push(l)}return this.tokens=o,o}async getTokenById(e,a){this.manifest||await this.fetchManifest();const[t,n,r,c]=this.manifest.args;if(!c.includes(e))return null;const o=`${r}${e}.json`,s={id:e,uri:o};if(a)try{const i=new y(this.manifest.address,this.contractAbi,a);s.owner=await i.ownerOf(e)}catch(i){console.warn(`Could not fetch owner for token ${e}:`,i)}try{const i=await fetch(o);if(i.ok)s.metadata=await i.json();else throw new Error(`Failed to fetch metadata: ${i.status}`)}catch{s.metadata=this.getFallbackMetadata(e)}return s}getFallbackMetadata(e){const a=`AI.Gov#${e.toString().padStart(2,"0")}`,t="0x",n=e.toString(16).padStart(4,"0"),r="1234567890123456789012345678901234".slice(0,40-t.length-n.length),c=t+r+n,o=["State-of-the-art AI governance node, trained on extensive financial and governance datasets.","Specialized AI node focused on long-term value creation through balanced governance participation.","Autonomous AI governance agent designed to represent community consensus in DeFi protocols.","Advanced machine learning system aligned with decentralized governance principles.","Transparent AI governance node with verifiable on-chain voting record and accountability."],s=["Conservative Balanced","Moderate Growth","Aggressive Growth","Value Protection","Innovation Focus"],i=o[e%o.length],u=s[e%s.length];return{name:a,description:i,image:`https://example.com/ai-node-${e}.png`,attributes:[{trait_type:"Node ID",value:`node-${e}`},{trait_type:"Type",value:"Governance"},{trait_type:"Strategy",value:u},{trait_type:"Address",value:c}]}}}const m=new F;class P{async getAllAINodes(e){try{const a=await h.getAllNodes();if(!e)return console.warn("No provider available, using mock AI Node data only"),a;try{try{await m.fetchManifest();const t=await m.getAllTokens(e),n=a.map(r=>{const c=t.find(o=>o.metadata&&o.metadata.attributes&&o.metadata.attributes.some(s=>s.trait_type==="Node ID"&&s.value===r.id));return c?{...r,soulboundTokenId:c.id,tokenData:c}:r});return console.log(`Successfully enriched AI nodes with NFT data: ${n.filter(r=>r.soulboundTokenId).length} nodes have NFTs`),n}catch(t){console.warn("Error using manifest approach, falling back to direct contract calls:",t);const n=await I.getAllAINodeNFTs(e);return a.map(c=>{const o=n.find(s=>s.metadata&&s.metadata.attributes&&s.metadata.attributes.some(i=>i.trait_type==="Node ID"&&i.value===c.id));return o?{...c,soulboundTokenId:o.id,tokenData:o}:c})}}catch(t){return console.error("Error fetching NFT data for AI Nodes:",t),a}}catch(a){return console.error("Error in getAllAINodes:",a),[]}}async getAINodeById(e,a){try{const t=await h.getNodeById(e);if(!t)return null;if(!a)return t;try{await m.fetchManifest();const r=(await m.getAllTokens(a)).find(c=>c.metadata&&c.metadata.attributes&&c.metadata.attributes.some(o=>o.trait_type==="Node ID"&&o.value===e));return r?{...t,soulboundTokenId:r.id,tokenData:r}:t}catch(n){return console.error(`Error fetching NFT data for node ${e}:`,n),t}}catch(t){return console.error(`Error getting AI node ${e}:`,t),null}}}const T=new P,D=()=>{const{signer:g,isConnected:e,provider:a}=k(),{data:t,isLoading:n,error:r,refetch:c}=A({queryKey:["ai-nodes","nft-integrated"],queryFn:async()=>{if(console.log("Fetching AI Nodes data...",{isConnected:e,hasProvider:!!a}),a&&e)try{console.log("Using provider to fetch AI Nodes with NFT data");const s=await T.getAllAINodes(a);if(console.log("Fetched AI Nodes from integration service:",(s==null?void 0:s.length)||0),s&&s.length>0)return console.log("Successfully retrieved AI Nodes from blockchain"),s.map(i=>({...i,tradingThesis:{description:i.description||"This AI node leverages advanced algorithms for optimal asset allocation.",points:["Employs technical analysis and machine learning","Monitors market sentiment indicators","Identifies macro-economic patterns"],conclusion:"Optimized for balanced risk-reward profiles in diverse market conditions."},recentActivity:[{title:`Created Proposal: Adjustment for ${i.strategy||"adaptive"}`,date:"3 days ago",status:"Passed"},{title:"Voted: Asset reallocation",date:"1 week ago",status:"For"},{title:"Created Proposal: Risk mitigation",date:"2 weeks ago",status:"Pending"}]}))}catch(s){console.error("Error fetching from integration service:",s)}else console.log("Provider or wallet connection not available");console.log("Using mock AI Node service as fallback");const o=h.getAllNodes();if(o&&o.length>0)return console.log("Successfully retrieved mock AI Nodes:",o.length),o;console.log("Falling back to mock API endpoint");try{const s=await fetch("/api/ainodes");if(!s.ok)throw new Error("Failed to fetch AI nodes from mock API");const i=await s.json();return console.log("Successfully fetched mock data:",i.length),i}catch(s){return console.error("Error fetching AI nodes from mock API:",s),[{id:"node1",name:"Alpha AI",strategy:"Swing Trading",description:"Alpha AI utilizes a sophisticated swing trading strategy.",address:"0x1234567890abcdef1234567890abcdef12345678",delegatedAmount:25e4,accuracy:78,performance:22.5,performance90d:18.3,proposalsCreated:28,proposalsPassed:22,tradingThesis:{description:"This AI node leverages advanced algorithms for optimal asset allocation.",points:["Employs technical analysis and machine learning","Monitors market sentiment indicators","Identifies macro-economic patterns"],conclusion:"Optimized for balanced risk-reward profiles in diverse market conditions."},recentActivity:[{title:"Created Proposal: Adjustment for strategy",date:"3 days ago",status:"Passed"},{title:"Voted: Asset reallocation",date:"1 week ago",status:"For"},{title:"Created Proposal: Risk mitigation",date:"2 weeks ago",status:"Pending"}]}]}},enabled:!!a,staleTime:3e5});return{nodes:t||[],isLoading:n,error:r,refetch:c}};export{D as u};
