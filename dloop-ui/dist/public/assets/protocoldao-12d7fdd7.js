import{e as ge,u as Ae,r as m,j as e,B as A,s as ye,O as We,a8 as _,a6 as le,i as J,M as Ye,a4 as fe,$ as ke,a3 as ze,o as Je,a9 as Be,aa as Ke,D as we}from"./index-971aa118.js";import{C as Q,c as Z}from"./card-66a343e3.js";import{u as Te,P as Ge}from"./PageContainer-a070ff6e.js";import{z as P,u as Qe,t as Ze,C as Xe}from"./index-e4e6a023.js";import{D as X,a as ee,b as te,c as re,d as oe,e as ce,I as se,h as et,R as tt,u as rt,F as ot,i as st,P as at,j as nt}from"./label-d4220aab.js";import{F as it,a as S,b as O,c as I,d as D,e as R,f as F}from"./form-45811920.js";import{S as de,a as ue,b as me,c as pe,d as V,e as Ee,A as Se,C as lt,f as ct,R as dt}from"./select-fd573888.js";import{T as ae}from"./textarea-5192e8e4.js";import{A as U,a as q,b as H}from"./alert-1bf7cad7.js";import{a as ut,u as xe,c as mt,b as B}from"./contracts-444c63f0.js";import{ADDRESSES as he}from"./contracts-7ce1c1bb.js";import{C as Ne}from"./circle-alert-23fc46ab.js";import{L as Ce}from"./loader-circle-8b712afc.js";import{I as Pe}from"./info-b2324884.js";import{C as pt}from"./copy-943806b5.js";import{C as ht}from"./countdown-timer-c1dc32bd.js";import"./index-cf00c244.js";import"./chevron-up-4957186b.js";import"./clock-6db2a81c.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=ge("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=ge("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=ge("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),W=P.object({title:P.string().min(5,"Title must be at least 5 characters").max(100,"Title cannot exceed 100 characters"),description:P.string().min(20,"Description must be at least 20 characters").max(2e3,"Description cannot exceed 2000 characters"),proposalType:P.enum(["parameter-update","token-whitelist","role-management","custom-execution"]),parameterType:P.enum(["voting-period","execution-delay","quorum"]).optional(),parameterValue:P.string().optional(),tokenAddress:P.string().optional(),isWhitelisted:P.boolean().optional(),roleType:P.enum(["treasury","admin","owner"]).optional(),newAddress:P.string().optional(),targets:P.string().optional(),values:P.string().optional(),calldatas:P.string().optional()}),vt=t=>t==="parameter-update"?W.refine(r=>!!r.parameterType&&!!r.parameterValue,{message:"Parameter type and value are required for parameter update proposals",path:["parameterType","parameterValue"]}):t==="token-whitelist"?W.refine(r=>!!r.tokenAddress&&J(r.tokenAddress)&&r.isWhitelisted!==void 0,{message:"Valid token address and whitelist status are required for token whitelist proposals",path:["tokenAddress","isWhitelisted"]}):t==="role-management"?W.refine(r=>!!r.roleType&&!!r.newAddress&&J(r.newAddress),{message:"Role type and valid new address are required for role management proposals",path:["roleType","newAddress"]}):t==="custom-execution"?W.refine(r=>!!r.targets&&!!r.values&&!!r.calldatas,{message:"Targets, values, and calldatas are required for custom execution proposals",path:["targets","values","calldatas"]}):W;function jt({isOpen:t,onClose:r}){const{isConnected:a,address:i,signer:s}=Ae(),{toast:l}=Te(),[h,c]=m.useState(null),[n,g]=m.useState(null),[f,j]=m.useState("form"),p=Qe({resolver:Ze(W),defaultValues:{title:"",description:"",proposalType:"parameter-update",parameterType:"voting-period",parameterValue:"",tokenAddress:"",isWhitelisted:!0,roleType:"treasury",newAddress:"",targets:"",values:"",calldatas:""}}),u=p.watch("proposalType");m.useEffect(()=>{p.clearErrors()},[u,p]);const $=()=>{p.reset(),c(null),g(null),j("form")},k=()=>{$(),r()},z=async d=>{const x=d;if(!a||!s){c("Please connect your wallet to create a proposal");return}const G=vt(x.proposalType);try{G.parse(x)}catch(o){if(o instanceof P.ZodError){const w=o.flatten().fieldErrors,y=Object.values(w).flat()[0]||"Invalid form data";c(y);return}}try{if(j("submitting"),c(null),s){const o=ut("ProtocolDAO",s);let w=`${x.title}

${x.description}`,y=[],T=[],E=[];if(x.proposalType==="parameter-update"){if(!x.parameterType||!x.parameterValue)throw new Error("Parameter type and value are required");y=[he.ProtocolDAO],T=["0"];let v,b,N;const C=We(x.parameterValue,0);switch(x.parameterType){case"voting-period":v="updateVotingPeriod",b="updateVotingPeriod(uint256)",N=_.defaultAbiCoder().encode(["uint256"],[C]);break;case"execution-delay":v="updateExecutionDelay",b="updateExecutionDelay(uint256)",N=_.defaultAbiCoder().encode(["uint256"],[C]);break;case"quorum":v="updateQuorum",b="updateQuorum(uint256)",N=_.defaultAbiCoder().encode(["uint256"],[C]);break;default:throw new Error("Invalid parameter type")}const M=le(b).slice(0,10),be=M+N.slice(2);E=[be],console.log("Parameter update calldata:",{functionSignature:b,functionSelector:M,encodedParams:N,fullCalldata:be}),w+=`

Parameter: ${x.parameterType}, Value: ${x.parameterValue}`}else if(x.proposalType==="token-whitelist"){if(!x.tokenAddress||!J(x.tokenAddress))throw new Error("Valid token address is required");y=[he.ProtocolDAO],T=["0"];const v="whitelistToken(address,bool)",b=_.defaultAbiCoder().encode(["address","bool"],[x.tokenAddress,x.isWhitelisted]),N=le(v).slice(0,10),C=N+b.slice(2);E=[C],console.log("Token whitelist calldata:",{functionSignature:v,functionSelector:N,encodedParams:b,fullCalldata:C}),w+=`

Token Address: ${x.tokenAddress}, Whitelist Status: ${x.isWhitelisted?"Add to whitelist":"Remove from whitelist"}`}else if(x.proposalType==="role-management"){if(!x.roleType||!x.newAddress||!J(x.newAddress))throw new Error("Role type and valid address are required");y=[he.ProtocolDAO],T=["0"];let v,b,N;switch(x.roleType){case"treasury":v="updateTreasury",b="updateTreasury(address)",N=_.defaultAbiCoder().encode(["address"],[x.newAddress]);break;case"admin":v="updateAdmin",b="updateAdmin(address)",N=_.defaultAbiCoder().encode(["address"],[x.newAddress]);break;case"owner":v="transferOwnership",b="transferOwnership(address)",N=_.defaultAbiCoder().encode(["address"],[x.newAddress]);break;default:throw new Error("Invalid role type")}const C=le(b).slice(0,10),M=C+N.slice(2);E=[M],console.log("Role management calldata:",{functionSignature:b,functionSelector:C,encodedParams:N,fullCalldata:M}),w+=`

Role: ${x.roleType}, New Address: ${x.newAddress}`}else if(x.proposalType==="custom-execution"){if(!x.targets||!x.values||!x.calldatas)throw new Error("Targets, values, and calldatas are required for custom execution");try{y=JSON.parse(x.targets);const v=JSON.parse(x.values);if(E=JSON.parse(x.calldatas),T=v.map(b=>b),y.length!==T.length||T.length!==E.length)throw new Error("Targets, values, and calldatas arrays must have the same length");for(const b of y)if(!J(b))throw new Error(`Invalid target address: ${b}`);w+=`

Custom Execution with ${y.length} action(s)`}catch(v){throw v.message.includes("JSON")?new Error('Invalid JSON format in targets, values, or calldatas. Use proper array format, e.g., ["0x123..."]'):v}}console.log("Creating protocol proposal:",{description:w,targets:y,values:T,calldatas:E});try{if(console.log("Submitting proposal with:",{description:w,targets:y,values:T,calldatas:E,proposalType:x.proposalType}),E.length===0)throw new Error("No calldata provided for proposal execution");const v=T.map(C=>{try{return Ye(C)}catch(M){throw console.error(`Error parsing value: ${C}`,M),l({title:"Value Error",description:`Error parsing ETH value: ${C}. Make sure values are valid ETH amounts.`,variant:"destructive"}),new Error(`Invalid ETH value format: ${C}`)}}),b=await o.createProposal(w,y,v,E,{gasLimit:1e6});if(g(b.hash),l({title:"Proposal Submitted",description:"Your proposal has been submitted to the blockchain."}),(await b.wait()).status===0)throw new Error("Transaction failed");j("confirmation"),l({title:"Proposal Created Successfully",description:"Your proposal has been successfully created and is now open for voting."})}catch(v){if(console.error("Contract interaction error:",v),v.message.includes("user rejected transaction"))throw new Error("Transaction was rejected in your wallet.");if(v.message.includes("insufficient funds"))throw new Error("You don't have enough ETH to cover gas fees for this transaction.");if(v.message.includes("execution reverted")){const b=v.message.match(/reason="([^"]+)"/),N=b?b[1]:"Unknown reason";throw N.includes("not enough voting power")?new Error("You don't have enough DLOOP tokens staked to create this proposal. You need to have DLOOP tokens staked for voting power."):new Error(`Transaction would fail: ${N}`)}else throw new Error(`Contract error: ${v.message}`)}}}catch(o){console.error("Error submitting proposal:",o),c(o.message||"Failed to create proposal"),j("form")}};return a?f==="submitting"?e.jsx(X,{open:t,onOpenChange:k,children:e.jsxs(ee,{className:"bg-dark-gray text-white border-gray max-w-md",children:[e.jsxs(te,{children:[e.jsx(re,{className:"text-2xl font-bold text-white",children:"Submitting Transaction"}),e.jsx(oe,{className:"text-gray",children:"Your proposal is being submitted to the blockchain."})]}),e.jsxs("div",{className:"space-y-4 py-4 flex flex-col items-center justify-center",children:[e.jsx(Ce,{className:"h-8 w-8 animate-spin text-primary"}),n?e.jsxs(U,{variant:"default",className:"bg-primary/20 border-primary",children:[e.jsx(q,{children:"Transaction Submitted"}),e.jsxs(H,{className:"overflow-auto",children:["Transaction Hash: ",e.jsx("a",{href:`https://sepolia.etherscan.io/tx/${n}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline break-all",children:ye(n,8)})]})]}):e.jsx("p",{className:"text-sm text-gray",children:"Please confirm the transaction in your wallet..."}),e.jsx("p",{className:"text-sm text-gray",children:"This may take a minute. Please don't close this window."})]})]})}):f==="confirmation"&&n?e.jsx(X,{open:t,onOpenChange:k,children:e.jsxs(ee,{className:"bg-dark-gray text-white border-gray max-w-md",children:[e.jsxs(te,{children:[e.jsx(re,{className:"text-2xl font-bold text-white",children:"Proposal Created!"}),e.jsx(oe,{className:"text-gray",children:"Your protocol proposal has been successfully submitted to the blockchain."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs(U,{variant:"default",className:"bg-green-600/20 border-green-600",children:[e.jsx(q,{children:"Transaction Confirmed"}),e.jsxs(H,{className:"overflow-auto",children:["Transaction Hash: ",e.jsx("a",{href:`https://sepolia.etherscan.io/tx/${n}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline break-all",children:ye(n,8)})]})]}),e.jsx("p",{className:"text-sm text-gray",children:"Your proposal will now be available for voting by DAO members. You can track its status on the proposals page."})]}),e.jsx(ce,{children:e.jsx(A,{onClick:k,children:"Close"})})]})}):e.jsx(X,{open:t,onOpenChange:d=>{console.log("Main form dialog onOpenChange called with:",d),d||k()},children:e.jsxs(ee,{className:"modal-content max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(te,{children:[e.jsx(re,{className:"text-2xl font-bold",children:"Create Protocol Proposal"}),e.jsx(oe,{className:"text-muted-foreground",children:"Submit a governance proposal for the Protocol DAO. This can include adding new assets, upgrading contracts, or adjusting parameters."})]}),e.jsxs(U,{variant:"default",className:"bg-primary/10 border-primary/20",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx(q,{children:"Important Information"}),e.jsx(H,{className:"text-sm",children:"To create a protocol proposal, you need to have DLOOP tokens staked in the DAO for voting power. Protocol proposals require higher voting power thresholds than Asset DAO proposals."})]}),h&&e.jsxs(U,{variant:"destructive",className:"bg-destructive/20 border-destructive",children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsx(q,{children:"Error"}),e.jsx(H,{children:h})]}),e.jsx(it,{...p,children:e.jsxs("form",{onSubmit:p.handleSubmit(z),className:"space-y-6",children:[e.jsx(S,{control:p.control,name:"title",render:({field:d})=>e.jsxs(O,{className:"form-group",children:[e.jsx(I,{children:"Proposal Title"}),e.jsx(D,{children:e.jsx(se,{...d,placeholder:"E.g., Add LINK Token Support"})}),e.jsx(R,{className:"text-muted-foreground",children:"Clearly state the purpose of your proposal"}),e.jsx(F,{})]})}),e.jsx(S,{control:p.control,name:"description",render:({field:d})=>e.jsxs(O,{className:"form-group",children:[e.jsx(I,{children:"Proposal Description"}),e.jsx(D,{children:e.jsx(ae,{...d,className:"min-h-32 resize-y",placeholder:"Describe your proposal in detail, including its rationale and expected impact..."})}),e.jsx(R,{className:"text-muted-foreground",children:"Provide a detailed explanation of your proposal"}),e.jsx(F,{})]})}),e.jsx(S,{control:p.control,name:"proposalType",render:({field:d})=>e.jsxs(O,{className:"form-group",children:[e.jsx(I,{children:"Proposal Type"}),e.jsxs(de,{onValueChange:d.onChange,defaultValue:d.value,children:[e.jsx(D,{children:e.jsx(ue,{children:e.jsx(me,{placeholder:"Select proposal type"})})}),e.jsxs(pe,{children:[e.jsx(V,{value:"parameter-update",children:"Parameter Update"}),e.jsx(V,{value:"token-whitelist",children:"Token Whitelist"}),e.jsx(V,{value:"role-management",children:"Role Management"}),e.jsx(V,{value:"custom-execution",children:"Custom Execution"})]})]}),e.jsxs(R,{className:"text-muted-foreground",children:[d.value==="parameter-update"&&"Update governance parameters like voting period, execution delay, and quorum",d.value==="token-whitelist"&&"Add or remove ERC-20 tokens from the protocol's approved list",d.value==="role-management"&&"Update key on-chain addresses (treasury, admin, owner)",d.value==="custom-execution"&&"Bundle arbitrary calls across any contracts into a single governance action"]}),e.jsx(F,{})]})}),u==="parameter-update"&&e.jsxs(e.Fragment,{children:[e.jsx(S,{control:p.control,name:"parameterType",render:({field:d})=>e.jsxs(O,{className:"form-group",children:[e.jsx(I,{children:"Parameter Type"}),e.jsxs(de,{onValueChange:d.onChange,defaultValue:d.value,children:[e.jsx(D,{children:e.jsx(ue,{children:e.jsx(me,{placeholder:"Select parameter type"})})}),e.jsxs(pe,{children:[e.jsx(V,{value:"voting-period",children:"Voting Period"}),e.jsx(V,{value:"execution-delay",children:"Execution Delay"}),e.jsx(V,{value:"quorum",children:"Quorum"})]})]}),e.jsxs(R,{className:"text-muted-foreground",children:[d.value==="voting-period"&&"Duration in blocks for proposal voting (e.g., 40320 blocks ≈ 1 week)",d.value==="execution-delay"&&"Delay before a passed proposal can be executed (e.g., 5760 blocks ≈ 1 day)",d.value==="quorum"&&"Minimum votes required to pass a proposal (e.g., 1000000 = 1M DLOOP)"]}),e.jsx(F,{})]})}),e.jsx(S,{control:p.control,name:"parameterValue",render:({field:d})=>e.jsxs(O,{className:"form-group",children:[e.jsx(I,{children:"Parameter Value"}),e.jsx(D,{children:e.jsx(se,{...d,placeholder:"e.g., 40320"})}),e.jsx(R,{className:"text-muted-foreground",children:"The new value you propose (integer format only, no decimals)"}),e.jsx(F,{})]})})]}),u==="token-whitelist"&&e.jsxs(e.Fragment,{children:[e.jsx(S,{control:p.control,name:"tokenAddress",render:({field:d})=>e.jsxs(O,{className:"form-group",children:[e.jsx(I,{children:"Token Contract Address"}),e.jsx(D,{children:e.jsx(se,{...d,className:"font-mono",placeholder:"0x..."})}),e.jsx(R,{className:"text-muted-foreground",children:"The ERC-20 token contract address to whitelist or remove"}),e.jsx(F,{})]})}),e.jsx(S,{control:p.control,name:"isWhitelisted",render:({field:d})=>e.jsxs(O,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border border-[hsl(var(--border))] p-4",children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:d.value,onChange:x=>d.onChange(x.target.checked),className:"rounded border-[hsl(var(--border))] h-4 w-4 text-[hsl(var(--primary))]"}),e.jsx("span",{children:"Add token to whitelist"})]})}),e.jsx(R,{className:"text-muted-foreground text-sm mt-1 ml-6",children:"Check to add token to whitelist, uncheck to remove from whitelist"}),e.jsx(F,{})]})})]}),u==="role-management"&&e.jsxs(e.Fragment,{children:[e.jsx(S,{control:p.control,name:"roleType",render:({field:d})=>e.jsxs(O,{className:"form-group",children:[e.jsx(I,{children:"Role Type"}),e.jsxs(de,{onValueChange:d.onChange,defaultValue:d.value,children:[e.jsx(D,{children:e.jsx(ue,{children:e.jsx(me,{placeholder:"Select role type"})})}),e.jsxs(pe,{children:[e.jsx(V,{value:"treasury",children:"Treasury"}),e.jsx(V,{value:"admin",children:"Admin"}),e.jsx(V,{value:"owner",children:"Owner"})]})]}),e.jsxs(R,{className:"text-muted-foreground",children:[d.value==="treasury"&&"The treasury address manages protocol assets",d.value==="admin"&&"The admin address has special permissions for protocol operation",d.value==="owner"&&"The owner address has the highest level of control (use with caution)"]}),e.jsx(F,{})]})}),e.jsx(S,{control:p.control,name:"newAddress",render:({field:d})=>e.jsxs(O,{className:"form-group",children:[e.jsx(I,{children:"New Address"}),e.jsx(D,{children:e.jsx(se,{...d,className:"font-mono",placeholder:"0x..."})}),e.jsx(R,{className:"text-muted-foreground",children:"The new account address to assign to this role"}),e.jsx(F,{})]})})]}),u==="custom-execution"&&e.jsxs(e.Fragment,{children:[e.jsxs(U,{className:"bg-amber-600/10 border-amber-600/20 mb-4",children:[e.jsx(Pe,{className:"h-4 w-4 text-amber-400"}),e.jsx(q,{children:"Advanced Use Only"}),e.jsx(H,{className:"text-sm",children:"Custom execution proposals allow you to execute arbitrary function calls on any contract. This is an advanced feature and requires detailed knowledge of smart contract interactions."})]}),e.jsx(S,{control:p.control,name:"targets",render:({field:d})=>e.jsxs(O,{className:"form-group",children:[e.jsx(I,{children:"Target Addresses"}),e.jsx(D,{children:e.jsx(ae,{...d,className:"font-mono",placeholder:'["0x1234...", "0x5678..."]'})}),e.jsx(R,{className:"text-muted-foreground",children:"JSON array of target contract addresses"}),e.jsx(F,{})]})}),e.jsx(S,{control:p.control,name:"values",render:({field:d})=>e.jsxs(O,{className:"form-group",children:[e.jsx(I,{children:"ETH Values"}),e.jsx(D,{children:e.jsx(ae,{...d,className:"font-mono",placeholder:'["0", "0"]'})}),e.jsx(R,{className:"text-muted-foreground",children:'JSON array of ETH values to send with each call (usually ["0", "0"])'}),e.jsx(F,{})]})}),e.jsx(S,{control:p.control,name:"calldatas",render:({field:d})=>e.jsxs(O,{className:"form-group",children:[e.jsx(I,{children:"Calldata"}),e.jsx(D,{children:e.jsx(ae,{...d,className:"font-mono",placeholder:'["0x1234abcd...", "0x5678efgh..."]'})}),e.jsx(R,{className:"text-muted-foreground",children:"JSON array of ABI-encoded function calls"}),e.jsx(F,{})]})})]}),e.jsxs(ce,{className:"pt-4 border-t border-[hsl(var(--border))] gap-2",children:[e.jsx(A,{type:"button",variant:"outline",onClick:k,disabled:p.formState.isSubmitting,children:"Cancel"}),e.jsx(A,{type:"submit",variant:"default",className:"bg-[hsl(var(--primary))] text-[hsl(var(--primary-foreground))] hover:bg-[hsl(var(--primary))]",disabled:p.formState.isSubmitting,children:p.formState.isSubmitting?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]}):"Create Proposal"})]})]})})]})}):(console.log("Rendering wallet connection dialog"),e.jsx(X,{open:t,onOpenChange:d=>{console.log("Dialog onOpenChange called with:",d),d||k()},children:e.jsxs(ee,{className:"bg-dark-gray text-white border-gray max-w-md",children:[e.jsxs(te,{children:[e.jsx(re,{className:"text-2xl font-bold text-white",children:"Connect Wallet"}),e.jsx(oe,{className:"text-gray",children:"You need to connect your wallet to create a protocol proposal."})]}),e.jsxs(U,{variant:"destructive",className:"bg-destructive/20 border-destructive",children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsx(q,{children:"Not Connected"}),e.jsx(H,{children:"Please connect your wallet to the Sepolia testnet to continue."})]}),e.jsx(ce,{children:e.jsx(A,{onClick:k,children:"Close"})})]})}))}function bt(t,r){return m.useReducer((a,i)=>r[a][i]??a,t)}var ve=t=>{const{present:r,children:a}=t,i=yt(r),s=typeof a=="function"?a({present:i.isPresent}):m.Children.only(a),l=fe(i.ref,wt(s));return typeof a=="function"||i.isPresent?m.cloneElement(s,{ref:l}):null};ve.displayName="Presence";function yt(t){const[r,a]=m.useState(),i=m.useRef(null),s=m.useRef(t),l=m.useRef("none"),h=t?"mounted":"unmounted",[c,n]=bt(h,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return m.useEffect(()=>{const g=ne(i.current);l.current=c==="mounted"?g:"none"},[c]),xe(()=>{const g=i.current,f=s.current;if(f!==t){const p=l.current,u=ne(g);t?n("MOUNT"):u==="none"||(g==null?void 0:g.display)==="none"?n("UNMOUNT"):n(f&&p!==u?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,n]),xe(()=>{if(r){let g;const f=r.ownerDocument.defaultView??window,j=u=>{const k=ne(i.current).includes(u.animationName);if(u.target===r&&k&&(n("ANIMATION_END"),!s.current)){const z=r.style.animationFillMode;r.style.animationFillMode="forwards",g=f.setTimeout(()=>{r.style.animationFillMode==="forwards"&&(r.style.animationFillMode=z)})}},p=u=>{u.target===r&&(l.current=ne(i.current))};return r.addEventListener("animationstart",p),r.addEventListener("animationcancel",j),r.addEventListener("animationend",j),()=>{f.clearTimeout(g),r.removeEventListener("animationstart",p),r.removeEventListener("animationcancel",j),r.removeEventListener("animationend",j)}}else n("ANIMATION_END")},[r,n]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:m.useCallback(g=>{i.current=g?getComputedStyle(g):null,a(g)},[])}}function ne(t){return(t==null?void 0:t.animationName)||"none"}function wt(t){var i,s;let r=(i=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:i.get,a=r&&"isReactWarning"in r&&r.isReactWarning;return a?t.ref:(r=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,a=r&&"isReactWarning"in r&&r.isReactWarning,a?t.props.ref:t.props.ref||t.ref)}var Nt=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Oe=Nt.reduce((t,r)=>{const a=ke(`Primitive.${r}`),i=m.forwardRef((s,l)=>{const{asChild:h,...c}=s,n=h?a:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(n,{...c,ref:l})});return i.displayName=`Primitive.${r}`,{...t,[r]:i}},{}),Ct=ze[" useInsertionEffect ".trim().toString()]||xe;function Pt({prop:t,defaultProp:r,onChange:a=()=>{},caller:i}){const[s,l,h]=At({defaultProp:r,onChange:a}),c=t!==void 0,n=c?t:s;{const f=m.useRef(t!==void 0);m.useEffect(()=>{const j=f.current;j!==c&&console.warn(`${i} is changing from ${j?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=c},[c,i])}const g=m.useCallback(f=>{var j;if(c){const p=kt(f)?f(t):f;p!==t&&((j=h.current)==null||j.call(h,p))}else l(f)},[c,t,l,h]);return[n,g]}function At({defaultProp:t,onChange:r}){const[a,i]=m.useState(t),s=m.useRef(a),l=m.useRef(r);return Ct(()=>{l.current=r},[r]),m.useEffect(()=>{var h;s.current!==a&&((h=l.current)==null||h.call(l,a),s.current=a)},[a,s]),[a,i,l]}function kt(t){return typeof t=="function"}var ie="Popover",[De,ur]=mt(ie,[Ee]),K=Ee(),[Tt,L]=De(ie),Re=t=>{const{__scopePopover:r,children:a,open:i,defaultOpen:s,onOpenChange:l,modal:h=!1}=t,c=K(r),n=m.useRef(null),[g,f]=m.useState(!1),[j,p]=Pt({prop:i,defaultProp:s??!1,onChange:l,caller:ie});return e.jsx(dt,{...c,children:e.jsx(Tt,{scope:r,contentId:nt(),triggerRef:n,open:j,onOpenChange:p,onOpenToggle:m.useCallback(()=>p(u=>!u),[p]),hasCustomAnchor:g,onCustomAnchorAdd:m.useCallback(()=>f(!0),[]),onCustomAnchorRemove:m.useCallback(()=>f(!1),[]),modal:h,children:a})})};Re.displayName=ie;var Fe="PopoverAnchor",Et=m.forwardRef((t,r)=>{const{__scopePopover:a,...i}=t,s=L(Fe,a),l=K(a),{onCustomAnchorAdd:h,onCustomAnchorRemove:c}=s;return m.useEffect(()=>(h(),()=>c()),[h,c]),e.jsx(Se,{...l,...i,ref:r})});Et.displayName=Fe;var Ie="PopoverTrigger",$e=m.forwardRef((t,r)=>{const{__scopePopover:a,...i}=t,s=L(Ie,a),l=K(a),h=fe(r,s.triggerRef),c=e.jsx(Oe.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":Ue(s.open),...i,ref:h,onClick:B(t.onClick,s.onOpenToggle)});return s.hasCustomAnchor?c:e.jsx(Se,{asChild:!0,...l,children:c})});$e.displayName=Ie;var je="PopoverPortal",[St,Ot]=De(je,{forceMount:void 0}),Ve=t=>{const{__scopePopover:r,forceMount:a,children:i,container:s}=t,l=L(je,r);return e.jsx(St,{scope:r,forceMount:a,children:e.jsx(ve,{present:a||l.open,children:e.jsx(at,{asChild:!0,container:s,children:i})})})};Ve.displayName=je;var Y="PopoverContent",Le=m.forwardRef((t,r)=>{const a=Ot(Y,t.__scopePopover),{forceMount:i=a.forceMount,...s}=t,l=L(Y,t.__scopePopover);return e.jsx(ve,{present:i||l.open,children:l.modal?e.jsx(Rt,{...s,ref:r}):e.jsx(Ft,{...s,ref:r})})});Le.displayName=Y;var Dt=ke("PopoverContent.RemoveScroll"),Rt=m.forwardRef((t,r)=>{const a=L(Y,t.__scopePopover),i=m.useRef(null),s=fe(r,i),l=m.useRef(!1);return m.useEffect(()=>{const h=i.current;if(h)return et(h)},[]),e.jsx(tt,{as:Dt,allowPinchZoom:!0,children:e.jsx(Me,{...t,ref:s,trapFocus:a.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:B(t.onCloseAutoFocus,h=>{var c;h.preventDefault(),l.current||(c=a.triggerRef.current)==null||c.focus()}),onPointerDownOutside:B(t.onPointerDownOutside,h=>{const c=h.detail.originalEvent,n=c.button===0&&c.ctrlKey===!0,g=c.button===2||n;l.current=g},{checkForDefaultPrevented:!1}),onFocusOutside:B(t.onFocusOutside,h=>h.preventDefault(),{checkForDefaultPrevented:!1})})})}),Ft=m.forwardRef((t,r)=>{const a=L(Y,t.__scopePopover),i=m.useRef(!1),s=m.useRef(!1);return e.jsx(Me,{...t,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var h,c;(h=t.onCloseAutoFocus)==null||h.call(t,l),l.defaultPrevented||(i.current||(c=a.triggerRef.current)==null||c.focus(),l.preventDefault()),i.current=!1,s.current=!1},onInteractOutside:l=>{var n,g;(n=t.onInteractOutside)==null||n.call(t,l),l.defaultPrevented||(i.current=!0,l.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const h=l.target;((g=a.triggerRef.current)==null?void 0:g.contains(h))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&s.current&&l.preventDefault()}})}),Me=m.forwardRef((t,r)=>{const{__scopePopover:a,trapFocus:i,onOpenAutoFocus:s,onCloseAutoFocus:l,disableOutsidePointerEvents:h,onEscapeKeyDown:c,onPointerDownOutside:n,onFocusOutside:g,onInteractOutside:f,...j}=t,p=L(Y,a),u=K(a);return rt(),e.jsx(ot,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:s,onUnmountAutoFocus:l,children:e.jsx(st,{asChild:!0,disableOutsidePointerEvents:h,onInteractOutside:f,onEscapeKeyDown:c,onPointerDownOutside:n,onFocusOutside:g,onDismiss:()=>p.onOpenChange(!1),children:e.jsx(lt,{"data-state":Ue(p.open),role:"dialog",id:p.contentId,...u,...j,ref:r,style:{...j.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),_e="PopoverClose",It=m.forwardRef((t,r)=>{const{__scopePopover:a,...i}=t,s=L(_e,a);return e.jsx(Oe.button,{type:"button",...i,ref:r,onClick:B(t.onClick,()=>s.onOpenChange(!1))})});It.displayName=_e;var $t="PopoverArrow",Vt=m.forwardRef((t,r)=>{const{__scopePopover:a,...i}=t,s=K(a);return e.jsx(ct,{...s,...i,ref:r})});Vt.displayName=$t;function Ue(t){return t?"open":"closed"}var Lt=Re,Mt=$e,_t=Ve,qe=Le;const Ut=Lt,qt=Mt,He=m.forwardRef(({className:t,align:r="center",sideOffset:a=4,...i},s)=>e.jsx(_t,{children:e.jsx(qe,{ref:s,align:r,sideOffset:a,className:Je("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",t),...i})}));He.displayName=qe.displayName;function Ht({title:t,description:r,url:a=window.location.href,variant:i="outline",size:s="default",compact:l=!1,platforms:h=["twitter","facebook","linkedin","discord","copy"]}){const[c,n]=m.useState(!1),g=r.length>100?r.substring(0,97)+"...":r,f=a,j={twitter:{url:`https://twitter.com/intent/tweet?text=${encodeURIComponent(t)}&url=${encodeURIComponent(f)}`,icon:e.jsx(Be,{className:"h-4 w-4"}),label:"Twitter",color:"hover:text-blue-400"},facebook:{url:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(f)}&quote=${encodeURIComponent(t)}`,icon:e.jsx(xt,{className:"h-4 w-4"}),label:"Facebook",color:"hover:text-blue-600"},linkedin:{url:`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(f)}`,icon:e.jsx(Ke,{className:"h-4 w-4"}),label:"LinkedIn",color:"hover:text-blue-700"},discord:{url:"https://discord.com/channels/@me",icon:e.jsx(gt,{className:"h-4 w-4"}),label:"Discord",color:"hover:text-purple-600"},copy:{action:()=>{navigator.clipboard.writeText(`${t}
${g}
${f}`),n(!0),setTimeout(()=>n(!1),2e3)},icon:c?e.jsx(Xe,{className:"h-4 w-4 text-green-500"}):e.jsx(pt,{className:"h-4 w-4"}),label:c?"Copied!":"Copy Link",color:c?"text-green-500":"hover:text-gray-700"}},p=h.map(u=>j[u]);return l?e.jsxs(Ut,{children:[e.jsx(qt,{asChild:!0,children:e.jsxs(A,{variant:i,size:s,className:"gap-2",children:[e.jsx(ft,{className:"h-4 w-4"}),s!=="icon"&&e.jsx("span",{children:"Share"})]})}),e.jsx(He,{className:"w-56 p-2",align:"end",children:e.jsx("div",{className:"grid gap-1",children:p.map((u,$)=>e.jsx("div",{children:u.action?e.jsxs(A,{variant:"ghost",size:"sm",className:`w-full justify-start ${u.color}`,onClick:u.action,children:[u.icon,e.jsx("span",{className:"ml-2",children:u.label})]}):e.jsxs(A,{variant:"ghost",size:"sm",className:`w-full justify-start ${u.color}`,onClick:()=>u.url&&window.open(u.url,"_blank"),children:[u.icon,e.jsx("span",{className:"ml-2",children:u.label})]})},$))})})]}):e.jsx("div",{className:"flex flex-wrap gap-2",children:p.map((u,$)=>u.action?e.jsxs(A,{variant:i,size:s,onClick:u.action,title:u.label,children:[u.icon,s!=="icon"&&e.jsx("span",{className:"ml-2",children:u.label})]},$):e.jsxs(A,{variant:i,size:s,onClick:()=>u.url&&window.open(u.url,"_blank"),title:u.label,children:[u.icon,s!=="icon"&&e.jsx("span",{className:"ml-2",children:u.label})]},$))})}const Wt=()=>{var x,G;const{isConnected:t}=Ae(),{toast:r}=Te(),[a,i]=m.useState(!1);console.log("Current isCreating state:",a);const[s,l]=m.useState(null),[h,c]=m.useState(null),{data:n,isLoading:g}=we({queryKey:["protocol-metrics"],queryFn:async()=>{try{const o=await fetch("/api/protocol/metrics");if(!o.ok)throw new Error("Failed to fetch protocol metrics");return await o.json()}catch(o){return console.error("Error fetching protocol metrics:",o),null}},staleTime:60*1e3}),{data:f,isLoading:j,error:p}=we({queryKey:["protocol-proposals"],queryFn:async()=>{try{const o=await fetch("/api/protocol/proposals");if(!o.ok)throw new Error("Failed to fetch protocol proposals");return await o.json()}catch(o){throw console.error("Error fetching protocol proposals:",o),o}},staleTime:60*1e3}),u=m.useMemo(()=>f?f.map(o=>{var E,v;const w=Math.floor(Date.now()/1e3);o.endTimestamp&&o.endTimestamp-w;const y=o.voteCount>0?Math.round(o.forVotes/o.voteCount*100):0,T=o.voteCount>0?Math.round(o.againstVotes/o.voteCount*100):0;return{...o,details:[{label:"Proposer",value:`${(E=o.proposer)==null?void 0:E.substring(0,6)}...${(v=o.proposer)==null?void 0:v.substring(o.proposer.length-4)}`,isHighlighted:!1},{label:"Created",value:new Date(o.createdAt*1e3).toLocaleDateString(),isHighlighted:!1},{label:"Status",value:o.status||"active",isHighlighted:o.status==="active"},{label:"For",value:`${y}%`,isHighlighted:y>50},{label:"Against",value:`${T}%`,isHighlighted:T>50}]}}):[],[f]),$=g||j,k=async(o,w)=>{if(t){l(o);try{r({title:"Vote Cast",description:"Your vote has been cast successfully on protocol proposal."})}catch(y){console.error("Error voting on protocol proposal:",y),r({title:"Vote Failed",description:y.message||"There was an error casting your vote. Please try again.",variant:"destructive"})}finally{l(null)}}},z=async o=>{if(t){c(o);try{r({title:"Proposal Executed",description:"The protocol proposal has been executed successfully."})}catch(w){console.error("Error executing protocol proposal:",w),r({title:"Execution Failed",description:w.message||"There was an error executing the proposal. Please try again.",variant:"destructive"})}finally{c(null)}}},d=o=>{switch(o){case"active":return"bg-primary/20 text-primary";case"passed":return"bg-green-500/20 text-green-500";case"failed":return"bg-destructive/20 text-destructive";case"executed":return"bg-blue-500/20 text-blue-500";default:return"bg-muted/20 text-muted-foreground"}};return e.jsx("section",{className:"page-transition",children:e.jsxs(Ge,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4",children:[e.jsxs("h1",{className:"text-3xl font-bold relative inline-block group",children:["Protocol DAO",e.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-0.5 bg-primary/80 transition-all duration-500 group-hover:w-full"})]}),e.jsxs(A,{className:"bg-primary text-primary-foreground font-medium transition-all duration-300 hover:shadow-md hover:bg-primary/90 relative overflow-hidden group",onClick:()=>{console.log("Create Proposal button clicked, setting isCreating to true"),i(!0)},disabled:!t,children:[e.jsx("span",{className:"relative z-10 transition-transform duration-300 group-hover:translate-x-1",children:"Create Proposal"}),e.jsx("span",{className:"absolute inset-0 bg-gradient-to-r from-primary/0 via-primary/30 to-primary/0 opacity-0 group-hover:opacity-100 transition-opacity duration-500 group-hover:animate-pulse"})]})]}),e.jsx(jt,{isOpen:a,onClose:()=>{console.log("Modal onClose callback triggered"),i(!1)}}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(Q,{className:"metric-card transition-all duration-300 hover:shadow-md hover:translate-y-[-2px] group",children:e.jsxs(Z,{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-muted-foreground mb-2 group-hover:text-foreground transition-colors duration-300",children:e.jsxs("span",{className:"relative",children:["Total Value Locked",e.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-0.5 bg-primary/40 transition-all duration-500 group-hover:w-full"})]})}),e.jsxs("div",{className:"text-3xl font-bold mono transition-all duration-300 group-hover:text-primary group-hover:scale-[1.02]",children:["$",((x=n==null?void 0:n.tvl)==null?void 0:x.toLocaleString())||"0"]}),e.jsxs("div",{className:"mt-2 text-sm text-muted-foreground flex items-center",children:[e.jsxs("span",{className:"text-primary mr-1 transition-all duration-300 group-hover:scale-110 group-hover:font-bold",children:["↑ ",(n==null?void 0:n.tvlChange)||"0","%"]}),e.jsx("span",{children:"since last month"})]})]})}),e.jsx(Q,{className:"metric-card transition-all duration-300 hover:shadow-md hover:translate-y-[-2px] group",children:e.jsxs(Z,{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-muted-foreground mb-2 group-hover:text-foreground transition-colors duration-300",children:e.jsxs("span",{className:"relative",children:["DLOOP Price",e.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-0.5 bg-primary/40 transition-all duration-500 group-hover:w-full"})]})}),e.jsxs("div",{className:"text-3xl font-bold mono transition-all duration-300 group-hover:text-primary group-hover:scale-[1.02]",children:["$",((G=n==null?void 0:n.dloopPrice)==null?void 0:G.toFixed(2))||"0.00"]}),e.jsxs("div",{className:"mt-2 text-sm text-muted-foreground flex items-center",children:[e.jsxs("span",{className:`mr-1 transition-all duration-300 group-hover:scale-110 group-hover:font-bold
                    ${n!=null&&n.priceChange&&n.priceChange>=0?"text-primary group-hover:text-green-500":"text-destructive group-hover:text-red-400"}`,children:[n!=null&&n.priceChange&&n.priceChange>=0?"↑":"↓",Math.abs((n==null?void 0:n.priceChange)||0),"%"]}),e.jsx("span",{children:"24h change"})]})]})}),e.jsx(Q,{className:"metric-card transition-all duration-300 hover:shadow-md hover:translate-y-[-2px] group",children:e.jsxs(Z,{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-muted-foreground mb-2 group-hover:text-foreground transition-colors duration-300",children:e.jsxs("span",{className:"relative",children:["Active Participants",e.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-0.5 bg-primary/40 transition-all duration-500 group-hover:w-full"})]})}),e.jsx("div",{className:"text-3xl font-bold mono transition-all duration-300 group-hover:text-primary group-hover:scale-[1.02]",children:(n==null?void 0:n.activeParticipants)||"0"}),e.jsxs("div",{className:"mt-2 text-sm text-muted-foreground flex items-center",children:[e.jsxs("span",{className:"text-primary mr-1 transition-all duration-300 group-hover:scale-110 group-hover:font-bold",children:["↑ ",(n==null?void 0:n.newParticipants)||"0"]}),e.jsx("span",{children:"new this week"})]})]})})]}),e.jsx(Q,{className:"transition-all duration-300 hover:shadow-md",children:e.jsxs(Z,{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-bold mb-6 relative inline-block group",children:["Protocol Governance Proposals",e.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-0.5 bg-primary/60 transition-all duration-500 group-hover:w-full"})]}),$?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):p?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h3",{className:"text-xl text-destructive mb-2",children:"Error Loading Proposals"}),e.jsx("p",{className:"text-muted-foreground",children:p.message})]}):!u||u.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h3",{className:"text-xl mb-2",children:"No protocol proposals found"}),e.jsx("p",{className:"text-muted-foreground",children:"There are no protocol governance proposals at this time."})]}):e.jsx("div",{className:"space-y-6",children:u.map(o=>e.jsxs("div",{className:"border border-border rounded-xl p-5 hover:border-primary/40 hover:shadow-md transition-all duration-300 group/proposal relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-transparent opacity-0 group-hover/proposal:opacity-100 transition-opacity duration-500 pointer-events-none"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start mb-4 relative",children:[e.jsxs("div",{className:"mb-3 md:mb-0",children:[e.jsx("h3",{className:"text-lg font-medium transition-colors duration-300 group-hover/proposal:text-primary",children:o.title}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1 transition-colors duration-300 group-hover/proposal:text-muted-foreground/80",children:o.description})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded transition-all duration-300 group-hover/proposal:scale-105 ${d(o.status)}`,children:o.status.charAt(0).toUpperCase()+o.status.slice(1)}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["ID: ",o.id]}),e.jsx(Ht,{title:`D-Loop Protocol Proposal: ${o.title}`,url:`${window.location.origin}/protocoldao?proposal=${o.id}`,description:`Check out this Protocol DAO proposal: ${o.description}`,platforms:["twitter","linkedin","copy"],size:"icon",compact:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-4 relative",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm group/item transition-all duration-300 hover:translate-x-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Proposer"}),e.jsx("span",{className:"font-medium mono truncate max-w-[200px] transition-colors duration-300 group-hover/item:text-primary",children:o.proposer})]}),e.jsxs("div",{className:"flex justify-between text-sm group/item transition-all duration-300 hover:translate-x-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Proposed"}),e.jsx("span",{className:"font-medium transition-colors duration-300 group-hover/item:text-primary",children:new Date(o.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between text-sm group/item transition-all duration-300 hover:translate-x-1",children:[e.jsx("span",{className:"text-muted-foreground",children:o.status==="active"?"Ends":o.status==="executed"?"Executed":"Ended"}),e.jsx("span",{className:"font-medium transition-colors duration-300 group-hover/item:text-primary",children:o.status==="active"?o.endsAt:new Date(o.updatedAt).toLocaleDateString()})]}),o.status==="active"&&o.endTimeISO&&e.jsx("div",{className:"mt-2 text-sm border border-border rounded-md p-2 bg-secondary/30 transition-all duration-300 group-hover/item:border-primary/30",children:e.jsx(ht,{endTime:o.endTimeISO,className:"w-full",onComplete:()=>console.log(`Proposal ${o.id} voting has ended`)})})]}),e.jsx("div",{className:"space-y-3",children:o.details.map((w,y)=>e.jsxs("div",{className:"flex justify-between text-sm group/detail transition-all duration-300 hover:translate-x-1",children:[e.jsx("span",{className:"text-muted-foreground",children:w.label}),e.jsx("span",{className:`${w.isHighlighted?"text-primary font-medium":"font-medium"} transition-colors duration-300 group-hover/detail:text-primary/90`,children:w.value})]},y))})]}),e.jsxs("div",{className:"mb-4 relative",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:o.status==="active"?"Votes":"Final Result"}),e.jsxs("span",{className:"text-sm font-medium transition-all duration-300 group-hover/proposal:text-primary group-hover/proposal:font-semibold",children:[o.forVotes,"% Yes (",o.voteCount.toLocaleString()," DLOOP)"]})]}),e.jsx("div",{className:"w-full bg-secondary rounded-full h-2.5 transition-all duration-300 group-hover/proposal:h-3",children:e.jsx("div",{className:`rounded-full transition-all duration-500 ${o.status==="passed"?"bg-green-500 group-hover/proposal:bg-green-400":o.status==="failed"?"bg-destructive group-hover/proposal:bg-destructive/80":o.status==="executed"?"bg-blue-500 group-hover/proposal:bg-blue-400":"bg-primary group-hover/proposal:bg-primary/80"}`,style:{width:`${o.forVotes}%`,height:"100%"}})})]}),o.status==="active"?e.jsxs("div",{className:"grid grid-cols-2 gap-3 relative",children:[e.jsx(A,{className:"bg-primary text-primary-foreground font-medium transition-all duration-300 hover:bg-primary/90 hover:shadow-sm",onClick:()=>k(o.id),disabled:s===o.id||!t,children:s===o.id?"...":"Yes"}),e.jsx(A,{variant:"outline",className:"font-medium transition-all duration-300 hover:bg-muted/50 hover:border-primary/30",onClick:()=>k(o.id),disabled:s===o.id||!t,children:s===o.id?"...":"No"})]}):o.status==="passed"?e.jsxs(A,{className:"w-full bg-primary text-primary-foreground font-medium relative overflow-hidden group-hover/proposal:shadow-md transition-all duration-300",onClick:()=>z(o.id),disabled:h===o.id||!t,children:[e.jsx("span",{className:"relative z-10",children:h===o.id?"Executing...":"Execute Proposal"}),e.jsx("span",{className:"absolute inset-0 bg-gradient-to-r from-primary/0 via-primary/30 to-primary/0 opacity-0 group-hover/proposal:opacity-100 transition-opacity duration-500 group-hover/proposal:animate-pulse"})]}):e.jsx(A,{variant:"outline",className:"w-full font-medium cursor-not-allowed transition-all duration-300 group-hover/proposal:bg-muted/30",disabled:!0,children:o.status==="executed"?"Execution Complete":"Failed"})]},o.id))})]})})]})})},Yt=Wt;function mr(){return e.jsx(Yt,{})}export{mr as default};
