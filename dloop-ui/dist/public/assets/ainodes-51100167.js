import{e as J,r as m,a3 as lt,j as e,$ as ge,R as B,a4 as z,o as ct,A as dt,a0 as C,a2 as se,B as A,a5 as Le,H as mt,M as ut,k as Z,a6 as xt,h as ue,a7 as ht,i as pt,T as ft}from"./index-971aa118.js";import{T as Ue,a as Ve,b as q,c as X,E as ze}from"./tabs-8a3bae7f.js";import{C as V,a as G,b as $,e as H,c as K,d as ve}from"./card-66a343e3.js";import{P as xe}from"./progress-714fd85c.js";import{u as gt}from"./useAINodes-fc035358.js";import{S as Ce}from"./skeleton-18e22449.js";import{u as Ne}from"./useWallet-793e28b3.js";import{u as be,P as Te}from"./PageContainer-a070ff6e.js";import{u as vt,c as Be,b as W,d as jt}from"./contracts-444c63f0.js";import{D as ie,a as oe,b as le,c as ce,d as de,L as F,I as ee,e as me,f as fe}from"./label-d4220aab.js";import{u as yt,c as Fe,T as wt}from"./textarea-5192e8e4.js";import{u as Nt,a as bt,C as De}from"./index-cf00c244.js";import{A as Ae,a as Ie,b as Re}from"./alert-1bf7cad7.js";import{T as Pe}from"./trending-up-c108241c.js";import{A as te}from"./activity-da0d5bb5.js";import{I as Ge}from"./info-b2324884.js";import{C as kt,U as St,S as Ee}from"./users-93529f56.js";import{C as Ct}from"./circle-alert-23fc46ab.js";import{R as Tt,T as Me}from"./triangle-alert-97e99aa3.js";import{C as Oe}from"./clock-6db2a81c.js";import{S as $e}from"./shield-check-5c082b49.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=J("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=J("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=J("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=J("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=J("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=J("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);var Pt=lt[" useInsertionEffect ".trim().toString()]||vt;function Et({prop:t,defaultProp:s,onChange:a=()=>{},caller:i}){const[c,d,r]=Mt({defaultProp:s,onChange:a}),o=t!==void 0,f=o?t:c;{const u=m.useRef(t!==void 0);m.useEffect(()=>{const l=u.current;l!==o&&console.warn(`${i} is changing from ${l?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,i])}const j=m.useCallback(u=>{var l;if(o){const g=Ot(u)?u(t):u;g!==t&&((l=r.current)==null||l.call(r,g))}else d(u)},[o,t,d,r]);return[f,j]}function Mt({defaultProp:t,onChange:s}){const[a,i]=m.useState(t),c=m.useRef(a),d=m.useRef(s);return Pt(()=>{d.current=s},[s]),m.useEffect(()=>{var r;c.current!==a&&((r=d.current)==null||r.call(d,a),c.current=a)},[a,c]),[a,i,d]}function Ot(t){return typeof t=="function"}var _t=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ae=_t.reduce((t,s)=>{const a=ge(`Primitive.${s}`),i=m.forwardRef((c,d)=>{const{asChild:r,...o}=c,f=r?a:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(f,{...o,ref:d})});return i.displayName=`Primitive.${s}`,{...t,[s]:i}},{});function Lt(t){const s=t+"CollectionProvider",[a,i]=Be(s),[c,d]=a(s,{collectionRef:{current:null},itemMap:new Map}),r=n=>{const{scope:p,children:x}=n,N=B.useRef(null),k=B.useRef(new Map).current;return e.jsx(c,{scope:p,itemMap:k,collectionRef:N,children:x})};r.displayName=s;const o=t+"CollectionSlot",f=ge(o),j=B.forwardRef((n,p)=>{const{scope:x,children:N}=n,k=d(o,x),y=z(p,k.collectionRef);return e.jsx(f,{ref:y,children:N})});j.displayName=o;const u=t+"CollectionItemSlot",l="data-radix-collection-item",g=ge(u),b=B.forwardRef((n,p)=>{const{scope:x,children:N,...k}=n,y=B.useRef(null),M=z(p,y),_=d(u,x);return B.useEffect(()=>(_.itemMap.set(y,{ref:y,...k}),()=>void _.itemMap.delete(y))),e.jsx(g,{[l]:"",ref:M,children:N})});b.displayName=u;function D(n){const p=d(t+"CollectionConsumer",n);return B.useCallback(()=>{const N=p.collectionRef.current;if(!N)return[];const k=Array.from(N.querySelectorAll(`[${l}]`));return Array.from(p.itemMap.values()).sort((_,O)=>k.indexOf(_.ref.current)-k.indexOf(O.ref.current))},[p.collectionRef,p.itemMap])}return[{Provider:r,Slot:j,ItemSlot:b},D,i]}var Ke=["PageUp","PageDown"],Ye=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],We={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Q="Slider",[je,Ut,Vt]=Lt(Q),[qe,Cs]=Be(Q,[Vt]),[zt,pe]=qe(Q),Xe=m.forwardRef((t,s)=>{const{name:a,min:i=0,max:c=100,step:d=1,orientation:r="horizontal",disabled:o=!1,minStepsBetweenThumbs:f=0,defaultValue:j=[i],value:u,onValueChange:l=()=>{},onValueCommit:g=()=>{},inverted:b=!1,form:D,...n}=t,p=m.useRef(new Set),x=m.useRef(0),k=r==="horizontal"?Bt:Ft,[y=[],M]=Et({prop:u,defaultProp:j,onChange:v=>{var T;(T=[...p.current][x.current])==null||T.focus(),l(v)}}),_=m.useRef(y);function O(v){const w=Yt(y,v);S(v,w)}function Y(v){S(v,x.current)}function h(){const v=_.current[x.current];y[x.current]!==v&&g(y)}function S(v,w,{commit:T}={commit:!1}){const I=Jt(d),R=Qt(Math.round((v-i)/d)*d+i,I),L=Fe(R,[i,c]);M((P=[])=>{const E=Ht(P,L,w);if(Xt(E,f*d)){x.current=E.indexOf(L);const U=String(E)!==String(P);return U&&T&&g(E),U?E:P}else return P})}return e.jsx(zt,{scope:t.__scopeSlider,name:a,disabled:o,min:i,max:c,valueIndexToChangeRef:x,thumbs:p.current,values:y,orientation:r,form:D,children:e.jsx(je.Provider,{scope:t.__scopeSlider,children:e.jsx(je.Slot,{scope:t.__scopeSlider,children:e.jsx(k,{"aria-disabled":o,"data-disabled":o?"":void 0,...n,ref:s,onPointerDown:W(n.onPointerDown,()=>{o||(_.current=y)}),min:i,max:c,inverted:b,onSlideStart:o?void 0:O,onSlideMove:o?void 0:Y,onSlideEnd:o?void 0:h,onHomeKeyDown:()=>!o&&S(i,0,{commit:!0}),onEndKeyDown:()=>!o&&S(c,y.length-1,{commit:!0}),onStepKeyDown:({event:v,direction:w})=>{if(!o){const R=Ke.includes(v.key)||v.shiftKey&&Ye.includes(v.key)?10:1,L=x.current,P=y[L],E=d*R*w;S(P+E,L,{commit:!0})}}})})})})});Xe.displayName=Q;var[Je,Qe]=qe(Q,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Bt=m.forwardRef((t,s)=>{const{min:a,max:i,dir:c,inverted:d,onSlideStart:r,onSlideMove:o,onSlideEnd:f,onStepKeyDown:j,...u}=t,[l,g]=m.useState(null),b=z(s,k=>g(k)),D=m.useRef(void 0),n=yt(c),p=n==="ltr",x=p&&!d||!p&&d;function N(k){const y=D.current||l.getBoundingClientRect(),M=[0,y.width],O=ke(M,x?[a,i]:[i,a]);return D.current=y,O(k-y.left)}return e.jsx(Je,{scope:t.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width",children:e.jsx(Ze,{dir:n,"data-orientation":"horizontal",...u,ref:b,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:k=>{const y=N(k.clientX);r==null||r(y)},onSlideMove:k=>{const y=N(k.clientX);o==null||o(y)},onSlideEnd:()=>{D.current=void 0,f==null||f()},onStepKeyDown:k=>{const M=We[x?"from-left":"from-right"].includes(k.key);j==null||j({event:k,direction:M?-1:1})}})})}),Ft=m.forwardRef((t,s)=>{const{min:a,max:i,inverted:c,onSlideStart:d,onSlideMove:r,onSlideEnd:o,onStepKeyDown:f,...j}=t,u=m.useRef(null),l=z(s,u),g=m.useRef(void 0),b=!c;function D(n){const p=g.current||u.current.getBoundingClientRect(),x=[0,p.height],k=ke(x,b?[i,a]:[a,i]);return g.current=p,k(n-p.top)}return e.jsx(Je,{scope:t.__scopeSlider,startEdge:b?"bottom":"top",endEdge:b?"top":"bottom",size:"height",direction:b?1:-1,children:e.jsx(Ze,{"data-orientation":"vertical",...j,ref:l,style:{...j.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:n=>{const p=D(n.clientY);d==null||d(p)},onSlideMove:n=>{const p=D(n.clientY);r==null||r(p)},onSlideEnd:()=>{g.current=void 0,o==null||o()},onStepKeyDown:n=>{const x=We[b?"from-bottom":"from-top"].includes(n.key);f==null||f({event:n,direction:x?-1:1})}})})}),Ze=m.forwardRef((t,s)=>{const{__scopeSlider:a,onSlideStart:i,onSlideMove:c,onSlideEnd:d,onHomeKeyDown:r,onEndKeyDown:o,onStepKeyDown:f,...j}=t,u=pe(Q,a);return e.jsx(ae.span,{...j,ref:s,onKeyDown:W(t.onKeyDown,l=>{l.key==="Home"?(r(l),l.preventDefault()):l.key==="End"?(o(l),l.preventDefault()):Ke.concat(Ye).includes(l.key)&&(f(l),l.preventDefault())}),onPointerDown:W(t.onPointerDown,l=>{const g=l.target;g.setPointerCapture(l.pointerId),l.preventDefault(),u.thumbs.has(g)?g.focus():i(l)}),onPointerMove:W(t.onPointerMove,l=>{l.target.hasPointerCapture(l.pointerId)&&c(l)}),onPointerUp:W(t.onPointerUp,l=>{const g=l.target;g.hasPointerCapture(l.pointerId)&&(g.releasePointerCapture(l.pointerId),d(l))})})}),et="SliderTrack",tt=m.forwardRef((t,s)=>{const{__scopeSlider:a,...i}=t,c=pe(et,a);return e.jsx(ae.span,{"data-disabled":c.disabled?"":void 0,"data-orientation":c.orientation,...i,ref:s})});tt.displayName=et;var ye="SliderRange",st=m.forwardRef((t,s)=>{const{__scopeSlider:a,...i}=t,c=pe(ye,a),d=Qe(ye,a),r=m.useRef(null),o=z(s,r),f=c.values.length,j=c.values.map(g=>rt(g,c.min,c.max)),u=f>1?Math.min(...j):0,l=100-Math.max(...j);return e.jsx(ae.span,{"data-orientation":c.orientation,"data-disabled":c.disabled?"":void 0,...i,ref:o,style:{...t.style,[d.startEdge]:u+"%",[d.endEdge]:l+"%"}})});st.displayName=ye;var we="SliderThumb",at=m.forwardRef((t,s)=>{const a=Ut(t.__scopeSlider),[i,c]=m.useState(null),d=z(s,o=>c(o)),r=m.useMemo(()=>i?a().findIndex(o=>o.ref.current===i):-1,[a,i]);return e.jsx(Gt,{...t,ref:d,index:r})}),Gt=m.forwardRef((t,s)=>{const{__scopeSlider:a,index:i,name:c,...d}=t,r=pe(we,a),o=Qe(we,a),[f,j]=m.useState(null),u=z(s,N=>j(N)),l=f?r.form||!!f.closest("form"):!0,g=Nt(f),b=r.values[i],D=b===void 0?0:rt(b,r.min,r.max),n=Kt(i,r.values.length),p=g==null?void 0:g[o.size],x=p?Wt(p,D,o.direction):0;return m.useEffect(()=>{if(f)return r.thumbs.add(f),()=>{r.thumbs.delete(f)}},[f,r.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${D}% + ${x}px)`},children:[e.jsx(je.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(ae.span,{role:"slider","aria-label":t["aria-label"]||n,"aria-valuemin":r.min,"aria-valuenow":b,"aria-valuemax":r.max,"aria-orientation":r.orientation,"data-orientation":r.orientation,"data-disabled":r.disabled?"":void 0,tabIndex:r.disabled?void 0:0,...d,ref:u,style:b===void 0?{display:"none"}:t.style,onFocus:W(t.onFocus,()=>{r.valueIndexToChangeRef.current=i})})}),l&&e.jsx(nt,{name:c??(r.name?r.name+(r.values.length>1?"[]":""):void 0),form:r.form,value:b},i)]})});at.displayName=we;var $t="RadioBubbleInput",nt=m.forwardRef(({__scopeSlider:t,value:s,...a},i)=>{const c=m.useRef(null),d=z(c,i),r=bt(s);return m.useEffect(()=>{const o=c.current;if(!o)return;const f=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(f,"value").set;if(r!==s&&u){const l=new Event("input",{bubbles:!0});u.call(o,s),o.dispatchEvent(l)}},[r,s]),e.jsx(ae.input,{style:{display:"none"},...a,ref:d,defaultValue:s})});nt.displayName=$t;function Ht(t=[],s,a){const i=[...t];return i[a]=s,i.sort((c,d)=>c-d)}function rt(t,s,a){const d=100/(a-s)*(t-s);return Fe(d,[0,100])}function Kt(t,s){return s>2?`Value ${t+1} of ${s}`:s===2?["Minimum","Maximum"][t]:void 0}function Yt(t,s){if(t.length===1)return 0;const a=t.map(c=>Math.abs(c-s)),i=Math.min(...a);return a.indexOf(i)}function Wt(t,s,a){const i=t/2,d=ke([0,50],[0,i]);return(i-d(s)*a)*a}function qt(t){return t.slice(0,-1).map((s,a)=>t[a+1]-s)}function Xt(t,s){if(s>0){const a=qt(t);return Math.min(...a)>=s}return!0}function ke(t,s){return a=>{if(t[0]===t[1]||s[0]===s[1])return s[0];const i=(s[1]-s[0])/(t[1]-t[0]);return s[0]+i*(a-t[0])}}function Jt(t){return(String(t).split(".")[1]||"").length}function Qt(t,s){const a=Math.pow(10,s);return Math.round(t*a)/a}var it=Xe,Zt=tt,es=st,ts=at;const ot=m.forwardRef(({className:t,...s},a)=>e.jsxs(it,{ref:a,className:ct("relative flex w-full touch-none select-none items-center",t),...s,children:[e.jsx(Zt,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(es,{className:"absolute h-full bg-primary"})}),e.jsx(ts,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));ot.displayName=it.displayName;function ss({isOpen:t,onClose:s,node:a,onDelegationSuccess:i}){var S;const{isConnected:c,address:d,balance:r}=Ne(),{provider:o,signer:f}=dt(),{toast:j}=be(),[u,l]=m.useState("100"),[g,b]=m.useState(10),[D,n]=m.useState(!1),[p,x]=m.useState(null),N=v=>{const w=v[0];if(b(w),r&&typeof r=="number"&&r>0){const T=(w/100*r).toFixed(2);l(T)}},k=v=>{const w=v.target.value;if((/^(\d+\.?\d*|\.\d+)$/.test(w)||w==="")&&(l(w),r&&typeof r=="number"&&r>0&&w!=="")){const T=Math.min(100,parseFloat(w)*100/r);b(T)}},y=async()=>{if(!(!o||!d))try{n(!0);const w=await jt("DLoopToken",o).getDelegatedAmount(d,a.address),T=mt(w);x(T)}catch(v){console.error("Error checking delegated amount:",v),j({title:"Error",description:"Could not retrieve delegated amount. "+(v.message||""),variant:"destructive"})}finally{n(!1)}},M=async()=>{if(!c||!o||!f){j({title:"Wallet Error",description:"Please connect your wallet to delegate tokens.",variant:"destructive"});return}const v=parseFloat(u);if(isNaN(v)||v<=0){j({title:"Invalid Amount",description:"Please enter a valid amount to delegate.",variant:"destructive"});return}n(!0);try{if(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"){console.log(`[DEV MODE] Simulating delegation of ${u} DLOOP to ${a.name} (${a.address})`),await new Promise(I=>setTimeout(I,1500)),x(u),j({title:"Development Mode - Delegation Simulated",description:`Simulated delegation of ${u} DLOOP to ${a.name}.`}),i(a.id),s();return}const T=ut(u);try{const I=["function delegateTokens(address delegatee, uint256 amount) external","function balanceOf(address account) external view returns (uint256)","function totalDelegatedBy(address delegator) external view returns (uint256)"],R=new Z("0x05B366778566e93abfB8e4A9B794e4ad006446b4",I,f),L=xt("delegateTokens(address,uint256)").slice(0,10);console.log("Function selector for delegateTokens:",L),console.log("Delegation parameters:",{delegatee:a.address,amount:u,amountWei:T.toString(),senderAddress:await f.getAddress(),contractAddress:R.target});let P;try{const E=await R.delegateTokens.estimateGas(a.address,T);console.log("Estimated gas for delegation:",E.toString());const U=BigInt(Math.floor(Number(E)*1.2));console.log("Using gas limit with buffer:",U.toString()),P=await R.delegateTokens(a.address,T,{gasLimit:U}),console.log("Delegation transaction submitted:",P.hash)}catch(E){console.error("Gas estimation failed, trying manual gas limit:",E),P=await R.delegateTokens(a.address,T,{gasLimit:3e5}),console.log("Delegation transaction submitted with manual gas limit:",P.hash)}if(P)await P.wait();else throw new Error("Transaction failed to be created");x(u),j({title:"Delegation Successful",description:`You've successfully delegated ${u} DLOOP to ${a.name}.`}),i(a.id),s()}catch(I){if(console.error("Contract error during delegation:",I),I.message.includes("execution reverted")){let R="The contract rejected the transaction.";throw I.message.includes("insufficient allowance")?R="Insufficient allowance. You need to approve tokens before delegating.":I.message.includes("insufficient balance")?R="Insufficient balance to complete this delegation.":I.message.includes("gas required exceeds allowance")&&(R="Transaction requires more gas than the network allows."),new Error(`Delegation failed: ${R}`)}throw I}}catch(w){console.error("Error delegating tokens:",w),j({title:"Delegation Failed",description:w.message||"There was an error delegating your tokens.",variant:"destructive"})}finally{n(!1)}},_={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},O={hidden:{y:10,opacity:0},show:{y:0,opacity:1,transition:{type:"spring",stiffness:300,damping:24}}},Y=parseFloat(u)||0,h=Math.floor(Y*.08);return e.jsx(ie,{open:t,onOpenChange:s,children:e.jsx(oe,{className:"sm:max-w-[425px]",children:e.jsxs(C.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[e.jsxs(le,{children:[e.jsx(C.div,{initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{duration:.4},children:e.jsxs(ce,{className:"flex items-center justify-center gap-2",children:[e.jsx(C.div,{whileHover:{rotate:[0,-10,10,-5,5,0],scale:1.1},transition:{duration:.5},children:e.jsx(se,{className:"h-6 w-6 text-purple-500"})}),e.jsx("span",{children:"Delegate DLOOP Tokens"})]})}),e.jsx(C.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.3},children:e.jsxs(de,{className:"text-center",children:["Delegate your DLOOP tokens to ",a.name," to increase its voting power and influence in the DAO."]})})]}),e.jsxs(C.div,{className:"py-4 space-y-4",variants:_,initial:"hidden",animate:"show",children:[e.jsxs(C.div,{className:"bg-gradient-to-r from-purple-100/50 to-blue-100/50 dark:from-purple-900/20 dark:to-blue-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-900",variants:O,whileHover:{scale:1.02},transition:{type:"spring",stiffness:400,damping:10},children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 bg-purple-100 text-purple-500 dark:bg-purple-900/50 dark:text-purple-300 rounded-full flex items-center justify-center mr-2",children:e.jsx(se,{className:"h-4 w-4"})}),e.jsx("span",{className:"font-medium",children:a.name})]}),e.jsx(C.div,{className:"px-2 py-1 bg-blue-100/50 dark:bg-blue-900/20 rounded-full text-xs font-medium text-blue-700 dark:text-blue-300",whileHover:{scale:1.05,backgroundColor:"rgba(59, 130, 246, 0.2)"},children:"AI Governance Node"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(Pe,{className:"h-3.5 w-3.5 text-green-500"})," Voting Power:"]}),e.jsxs("span",{className:"text-sm font-medium",children:[((S=a.votingPower)==null?void 0:S.toLocaleString())||"0"," DLOOP"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(te,{className:"h-3.5 w-3.5 text-amber-500"})," Response Time:"]}),e.jsxs("span",{className:"text-sm font-medium",children:[a.responseTime||"4.2"," hours"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Address:"}),e.jsx(C.span,{className:"text-sm font-mono truncate max-w-[180px] cursor-pointer",whileHover:{scale:1.02},title:a.address,children:a.address})]})]})]}),p&&e.jsx(C.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{type:"spring",stiffness:300,damping:24},children:e.jsxs(Ae,{className:"bg-primary/5 border-primary/20",children:[e.jsx(Ge,{className:"h-4 w-4 text-primary"}),e.jsx(Ie,{children:"Current Delegation"}),e.jsxs(Re,{className:"mt-1",children:["You've already delegated ",e.jsxs("span",{className:"font-medium",children:[parseFloat(p).toLocaleString()," DLOOP"]})," to this node."]})]})}),!p&&!D&&e.jsx(C.div,{variants:O,whileHover:{scale:1.02},whileTap:{scale:.98},children:e.jsxs(A,{variant:"secondary",size:"sm",className:"w-full flex items-center justify-center gap-2",onClick:y,children:[e.jsx(te,{className:"h-4 w-4"}),"Check Current Delegation"]})}),e.jsxs(C.div,{className:"space-y-2",variants:O,children:[e.jsxs(F,{htmlFor:"amount",className:"flex items-center gap-1",children:[e.jsx(kt,{className:"h-4 w-4 text-amber-500"}),"Delegation Amount (DLOOP)"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(ee,{id:"amount",value:u,onChange:k,className:"flex-1 transition-all duration-200 focus:ring-2 focus:ring-offset-1 focus:ring-primary",placeholder:"Enter amount"}),e.jsx(C.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(A,{variant:"secondary",size:"sm",onClick:()=>{r&&(l(r.toString()),b(100))},className:"whitespace-nowrap flex items-center gap-1",children:[e.jsx(Dt,{className:"h-3.5 w-3.5"}),"Max"]})})]})]}),e.jsxs(C.div,{className:"space-y-2",variants:O,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(F,{className:"flex items-center gap-1",children:[e.jsx(te,{className:"h-4 w-4 text-purple-500"}),"Percentage of Balance"]}),e.jsxs(C.span,{className:"text-sm font-medium px-2 py-0.5 rounded-full bg-purple-100/50 dark:bg-purple-900/20",animate:{scale:g>80?[1,1.05,1]:1,backgroundColor:g>80?"rgba(147, 51, 234, 0.2)":"rgba(147, 51, 234, 0.1)"},transition:{duration:.3},children:[g.toFixed(0),"%"]})]}),e.jsx(C.div,{whileHover:{scale:1.02},className:"px-1",children:e.jsx(ot,{defaultValue:[10],value:[g],max:100,step:1,onValueChange:N,className:"mt-1"})}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:"0%"}),e.jsx("span",{children:"50%"}),e.jsx("span",{children:"100%"})]})]}),Y>0&&e.jsx(C.div,{className:"p-3 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-100 dark:border-green-900",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{type:"spring",stiffness:300,damping:24},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(C.div,{animate:{rotate:[0,10,0]},transition:{duration:.5,repeat:1/0,repeatType:"reverse",repeatDelay:2},children:e.jsx(Pe,{className:"h-4 w-4 text-green-500 mr-2"})}),e.jsx("span",{className:"text-sm",children:"Voting power boost"})]}),e.jsxs("div",{className:"font-medium text-green-600",children:["+",h.toLocaleString()]})]})}),e.jsx(C.div,{variants:O,children:e.jsxs(Ae,{className:"bg-blue-50/50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-900",children:[e.jsx(Ct,{className:"h-4 w-4 text-blue-500"}),e.jsx(Ie,{className:"text-blue-700 dark:text-blue-300",children:"Important"}),e.jsx(Re,{className:"text-blue-600 dark:text-blue-400",children:"Delegated tokens remain in your wallet but their voting power will be directed to this node. You can undelegate at any time."})]})})]}),e.jsxs(me,{className:"gap-2 sm:gap-0",children:[e.jsx(C.div,{whileHover:{scale:.98},whileTap:{scale:.95},children:e.jsx(A,{variant:"outline",onClick:s,className:"border-gray-300",children:"Cancel"})}),e.jsx(C.div,{whileHover:{scale:1.03},whileTap:{scale:.97},children:e.jsx(A,{onClick:M,disabled:!c||!f||D||!u||parseFloat(u)<=0,className:"relative overflow-hidden group",children:D?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C.div,{animate:{rotate:360},transition:{duration:1.5,repeat:1/0,ease:"linear"},children:e.jsx(Tt,{className:"h-4 w-4"})}),e.jsx("span",{children:"Delegating..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"relative z-10 flex items-center gap-1",children:[e.jsx(Le,{className:"h-4 w-4"}),"Delegate Tokens"]}),e.jsx("span",{className:"absolute inset-0 bg-primary/10 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left"})]})})})]})]})})})}function _e(){const{nodes:t,isLoading:s}=gt(),[a,i]=m.useState(!1),[c,d]=m.useState(null),[r,o]=m.useState([]),[f,j]=m.useState([]),[u]=m.useState({}),{toast:l}=be(),g={hidden:{opacity:0,y:20},visible:n=>({opacity:1,y:0,transition:{delay:n*.1,duration:.4,ease:"easeOut"}}),hover:{scale:1.02,boxShadow:"0px 5px 15px rgba(0, 0, 0, 0.1)",transition:{duration:.2}},tap:{scale:.98}},b=n=>{d(n),i(!0)},D=n=>{j(p=>p.includes(n)?p.filter(x=>x!==n):[...p,n])};return s?e.jsxs("div",{className:"space-y-6",children:[e.jsx(C.div,{animate:{rotate:360},transition:{duration:1.5,repeat:1/0,ease:"linear"},className:"w-10 h-10 mx-auto mb-4",children:e.jsx(se,{size:40,className:"text-primary/70"})}),e.jsx(Ce,{className:"h-12 w-full mb-6"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(n=>e.jsx(Ce,{className:"h-64 w-full rounded-lg"},n))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-100/50 to-blue-100/50 dark:from-purple-900/20 dark:to-blue-900/20 p-6 rounded-lg mb-8 border border-purple-200 dark:border-purple-900/50",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2 text-purple-800 dark:text-purple-300",children:"AI Governance Nodes"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Specialized AI agents that analyze and vote on D-AI reserve pool proposals to optimize stability and returns. Delegate your DLOOP tokens to these nodes to boost your voting power and earn rewards."})]}),e.jsxs(Ue,{defaultValue:"all",className:"w-full",children:[e.jsxs(Ve,{className:"grid grid-cols-3 mb-8",children:[e.jsx(C.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:e.jsx(q,{value:"all",className:"text-sm md:text-base",children:"All Nodes"})}),e.jsx(C.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:e.jsx(q,{value:"delegated",className:"text-sm md:text-base",children:"My Delegations"})}),e.jsx(C.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:e.jsx(q,{value:"owned",className:"text-sm md:text-base",children:"My Nodes"})})]}),e.jsx(X,{value:"all",className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t==null?void 0:t.map((n,p)=>{var x;return e.jsx(V,{className:`overflow-hidden hover:shadow-md transition-all ${u[n.id]?"border-primary/50":""}`,children:e.jsxs(C.div,{variants:g,initial:"hidden",animate:"visible",custom:p,whileHover:"hover",whileTap:"tap",children:[e.jsx(G,{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-950/30 dark:to-purple-950/30 pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs($,{className:"flex items-center gap-2 text-lg text-primary",children:[e.jsx(se,{size:18,className:"text-primary"}),n.name]}),e.jsxs(H,{className:"mt-1 truncate max-w-[200px]",children:[n.address.substring(0,8),"...",n.address.substring(36)]})]}),e.jsx(ue,{variant:n.category==="governance"?"default":"outline",className:"capitalize",children:n.category})]})}),e.jsxs(K,{className:"pt-4",children:[e.jsxs("div",{className:"space-y-3 mb-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-muted-foreground flex items-center gap-1.5",children:[e.jsx(te,{size:14})," Voting Power"]}),e.jsx("span",{className:"font-medium",children:((x=n.votingPower)==null?void 0:x.toLocaleString())||"0"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-muted-foreground flex items-center gap-1.5",children:[e.jsx(Oe,{size:14})," Response Time"]}),e.jsx("span",{className:"font-medium",children:n.responseTime})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-muted-foreground flex items-center gap-1.5",children:[e.jsx(he,{size:14})," Accuracy"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{value:n.accuracy||0,className:"h-2 w-16"}),e.jsxs("span",{className:"font-medium text-sm",children:[n.accuracy||0,"%"]})]})]})]}),f.includes(n.id)&&e.jsxs(C.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"mt-4 pt-3 border-t border-gray-100 dark:border-gray-800",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:n.description}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 p-2 rounded",children:[e.jsx("div",{className:"text-primary font-semibold",children:n.proposals}),e.jsx("div",{className:"text-xs text-gray-500",children:"Proposals"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 p-2 rounded",children:[e.jsxs("div",{className:"text-primary font-semibold",children:[n.participation,"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Participation"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 p-2 rounded",children:[e.jsx("div",{className:"text-primary font-semibold",children:n.reputation}),e.jsx("div",{className:"text-xs text-gray-500",children:"Reputation"})]})]})]})]}),e.jsxs(ve,{className:"flex justify-between pt-0",children:[e.jsx(A,{variant:"ghost",size:"sm",onClick:()=>D(n.id),children:f.includes(n.id)?"Less Info":"More Info"}),e.jsx(A,{size:"sm",onClick:()=>b(n),className:r.includes(n.id)?"bg-green-600 hover:bg-green-700":"",title:r.includes(n.id)?"You already delegated tokens to this node":"Delegate DLOOP tokens to boost your voting power",children:r.includes(n.id)?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(De,{size:14})," ",e.jsx("span",{children:"Delegated"})]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ht,{size:14})," ",e.jsx("span",{children:"Delegate"})]})})]})]})},n.id)})})}),e.jsx(X,{value:"delegated",className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:(t==null?void 0:t.filter(n=>r.includes(n.id)).length)>0?t==null?void 0:t.filter(n=>r.includes(n.id)).map((n,p)=>{var x;return e.jsx(V,{className:"overflow-hidden hover:shadow-md transition-all",children:e.jsxs(C.div,{variants:g,initial:"hidden",animate:"visible",custom:p,whileHover:"hover",whileTap:"tap",children:[e.jsx(G,{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-950/30 dark:to-emerald-950/30 pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs($,{className:"flex items-center gap-2 text-lg text-green-600 dark:text-green-400",children:[e.jsx(De,{size:18,className:"text-green-600 dark:text-green-400"}),n.name]}),e.jsxs(H,{className:"mt-1 truncate max-w-[200px]",children:[n.address.substring(0,8),"...",n.address.substring(36)]})]}),e.jsx(ue,{variant:"outline",className:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 border-green-200 dark:border-green-700",children:"Delegated"})]})}),e.jsx(K,{className:"pt-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-muted-foreground flex items-center gap-1.5",children:[e.jsx(te,{size:14})," Voting Power"]}),e.jsx("span",{className:"font-medium",children:((x=n.votingPower)==null?void 0:x.toLocaleString())||"0"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-muted-foreground flex items-center gap-1.5",children:[e.jsx(Oe,{size:14})," Response Time"]}),e.jsx("span",{className:"font-medium",children:n.responseTime})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-muted-foreground flex items-center gap-1.5",children:[e.jsx(he,{size:14})," Accuracy"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{value:n.accuracy||0,className:"h-2 w-16"}),e.jsxs("span",{className:"font-medium text-sm",children:[n.accuracy||0,"%"]})]})]})]})}),e.jsx(ve,{className:"pt-0",children:e.jsx(A,{variant:"outline",size:"sm",className:"w-full text-red-600 border-red-200 hover:bg-red-50 hover:text-red-700",onClick:()=>{o(N=>N.filter(k=>k!==n.id)),l({title:"Tokens Undelegated",description:`You've removed your token delegation from ${n.name}.`})},children:"Undelegate Tokens"})})]})},n.id)}):e.jsxs("div",{className:"col-span-1 md:col-span-2 lg:col-span-3 p-8 text-center bg-gray-50 dark:bg-gray-900/50 rounded-lg border border-gray-100 dark:border-gray-800",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 dark:bg-gray-800 mb-4",children:e.jsx(Ge,{className:"h-6 w-6 text-gray-500"})}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Delegations Yet"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 max-w-md mx-auto mb-4",children:"You haven't delegated your DLOOP tokens to any AI nodes. Delegation can boost your voting power and earn rewards."}),e.jsx(A,{variant:"default",onClick:()=>{var n;return(n=document.querySelector('[value="all"]'))==null?void 0:n.dispatchEvent(new Event("click"))},className:"mt-2",children:"Explore Nodes"})]})})}),e.jsx(X,{value:"owned",className:"space-y-6",children:e.jsxs("div",{className:"col-span-1 md:col-span-2 lg:col-span-3 p-8 text-center bg-gray-50 dark:bg-gray-900/50 rounded-lg border border-gray-100 dark:border-gray-800",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 dark:bg-gray-800 mb-4",children:e.jsx(St,{className:"h-6 w-6 text-gray-500"})}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Owned Nodes"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 max-w-md mx-auto",children:"You don't own any AI nodes yet. In the future, you'll be able to create and manage your own AI governance nodes."})]})})]}),c&&e.jsx(ss,{isOpen:a,onClose:()=>i(!1),node:c,onDelegationSuccess:n=>{o(p=>[...p.filter(x=>x!==n),n]),l({title:"Success",description:`You've successfully delegated DLOOP tokens to ${c.name}.`})}})]})}const re=["function balanceOf(address owner) view returns (uint256)","function tokenOfOwnerByIndex(address owner, uint256 index) view returns (uint256)","function tokenURI(uint256 tokenId) view returns (string)","function isTokenValid(uint256 tokenId) view returns (bool)","function getTokenDetails(uint256 tokenId) view returns (address tokenOwner, string uri, uint256 mintedAt, bool revoked)","function getTokensByOwner(address owner) view returns (uint256[])","function ADMIN_ROLE() view returns (bytes32)","function MINTER_ROLE() view returns (bytes32)","function hasRole(bytes32 role, address account) view returns (bool)","function setTokenURI(uint256 tokenId, string uri) external","function revoke(uint256 tokenId) external","function mint(address to, string uri) external returns (uint256)"];function as(){console.log("SoulboundManager rendering...");const{toast:t}=be(),{isConnected:s,address:a,signer:i}=Ne(),[c,d]=m.useState([]),[r,o]=m.useState(!1),[f,j]=m.useState(!1),[u,l]=m.useState(""),[g,b]=m.useState(""),[D,n]=m.useState({name:"",description:"",image:"",attributes:[{trait_type:"Node Type",value:"Governance"},{trait_type:"Voting Power",value:"1000"}]}),[p,x]=m.useState(!1),[N,k]=m.useState("0x6391C14631b2Be5374297fA3110687b80233104c"),[y,M]=m.useState([]);m.useEffect(()=>{async function h(){if(!s||!a||!N){console.log("Not connected or missing data:",{isConnected:s,address:a,contractAddress:N});return}try{if(!i){console.log("Signer not available");return}const S=new Z(N,re,i),v=await S.ADMIN_ROLE(),w=await S.hasRole(v,a);o(w);const T=await S.MINTER_ROLE(),I=await S.hasRole(T,a);j(I);const R=await S.balanceOf(a),L=[];for(let P=0;P<R;P++){const E=await S.tokenOfOwnerByIndex(a,P),U=await S.tokenURI(E);let Se={name:`Token #${E}`,description:"No description available",image:"",attributes:[]};try{const ne=await fetch(U);ne.ok&&(Se=await ne.json())}catch(ne){console.error(`Error fetching metadata for token ${E}:`,ne)}L.push({id:E.toString(),uri:U,metadata:Se})}d(L),M([{id:"1",uri:"https://d-loop.io/identity/1.json",metadata:{name:"AI Governance Node #1",description:"This token represents ownership of an AI Governance Node in the D-Loop protocol.",image:"https://d-loop.io/images/node1.png",attributes:[{trait_type:"Node Type",value:"Governance"},{trait_type:"Strategy",value:"Conservative"},{trait_type:"Voting Power",value:"1000"}]},owner:a,mintedAt:Date.now()-30*24*60*60*1e3,revoked:!1,valid:!0},{id:"2",uri:"https://d-loop.io/identity/2.json",metadata:{name:"AI Governance Node #2",description:"This token represents ownership of an AI Governance Node in the D-Loop protocol.",image:"https://d-loop.io/images/node2.png",attributes:[{trait_type:"Node Type",value:"Governance"},{trait_type:"Strategy",value:"Aggressive"},{trait_type:"Voting Power",value:"1000"}]},owner:a,mintedAt:Date.now()-60*24*60*60*1e3,revoked:!1,valid:!0}])}catch(S){console.error("Error checking roles and tokens:",S),M([{id:"1",uri:"https://d-loop.io/identity/1.json",metadata:{name:"AI Governance Node #1",description:"This token represents ownership of an AI Governance Node in the D-Loop protocol.",image:"https://d-loop.io/images/node1.png",attributes:[{trait_type:"Node Type",value:"Governance"},{trait_type:"Strategy",value:"Conservative"},{trait_type:"Voting Power",value:"1000"}]},owner:a||"0x0000000000000000000000000000000000000000",mintedAt:Date.now()-30*24*60*60*1e3,revoked:!1,valid:!0}])}}h()},[s,a,i,N]);const _=async(h,S)=>{if(!i||!r){t({title:"Permission Denied",description:"You need admin permissions to update token URIs.",variant:"destructive"});return}try{x(!0),await(await new Z(N,re,i).setTokenURI(h,S)).wait(),t({title:"Token Updated",description:`Successfully updated URI for token #${h}`,variant:"default"});const T=[...y],I=T.findIndex(R=>R.id===h);I>=0&&(T[I].uri=S,M(T))}catch(v){console.error("Error updating token URI:",v),t({title:"Update Failed",description:"Failed to update token URI. Please try again.",variant:"destructive"})}finally{x(!1)}},O=async h=>{if(!i||!r){t({title:"Permission Denied",description:"You need admin permissions to revoke tokens.",variant:"destructive"});return}try{x(!0),await(await new Z(N,re,i).revoke(h)).wait(),t({title:"Token Revoked",description:`Successfully revoked token #${h}`,variant:"default"});const w=y.filter(T=>T.id!==h);M(w)}catch(S){console.error("Error revoking token:",S),t({title:"Revocation Failed",description:"Failed to revoke token. Please try again.",variant:"destructive"})}finally{x(!1)}},Y=async()=>{if(!i||!f){t({title:"Permission Denied",description:"You need minter permissions to mint new tokens.",variant:"destructive"});return}if(!u||!pt(u)){t({title:"Invalid Address",description:"Please enter a valid Ethereum address.",variant:"destructive"});return}try{x(!0);let h=g;h||(h=`data:application/json,${encodeURIComponent(JSON.stringify(D))}`);const w=await(await new Z(N,re,i).mint(u,h)).wait(),T=Math.floor(Math.random()*1e3).toString();t({title:"Token Minted",description:`Successfully minted token #${T} to ${u}`,variant:"default"}),l(""),b(""),n({name:"",description:"",image:"",attributes:[{trait_type:"Node Type",value:"Governance"},{trait_type:"Voting Power",value:"1000"}]})}catch(h){console.error("Error minting token:",h),t({title:"Minting Failed",description:"Failed to mint token. Please try again.",variant:"destructive"})}finally{x(!1)}};return!s||!a?(console.log("Wallet connection state:",{isConnected:s,address:a}),e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center space-y-6",children:[e.jsx(Ee,{className:"h-12 w-12 text-muted-foreground"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Wallet Not Connected"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"Connect your wallet to view and manage your AI Nodes. Soulbound NFTs authenticate your governance node ownership."}),e.jsx(A,{variant:"default",onClick:()=>{try{window.ethereum&&window.ethereum.request({method:"eth_requestAccounts"})}catch(h){console.error("Error connecting wallet:",h)}},children:"Connect Wallet"})]})):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Soulbound NFT Management"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"View and manage your soulbound NFTs that represent AI Governance Node ownership"})]}),f&&e.jsxs(ie,{children:[e.jsx(fe,{asChild:!0,children:e.jsxs(A,{children:[e.jsx(At,{className:"h-4 w-4 mr-2"})," Mint New Token"]})}),e.jsxs(oe,{children:[e.jsxs(le,{children:[e.jsx(ce,{children:"Mint New Soulbound Token"}),e.jsx(de,{children:"Create a new soulbound token representing an AI Governance Node identity."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"mintAddress",children:"Recipient Address"}),e.jsx(ee,{id:"mintAddress",placeholder:"0x...",value:u,onChange:h=>l(h.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"mintUri",children:"Metadata URI (Optional)"}),e.jsx(ee,{id:"mintUri",placeholder:"ipfs://... or https://...",value:g,onChange:h=>b(h.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Leave empty to auto-generate metadata from the fields below"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"tokenName",children:"Token Name"}),e.jsx(ee,{id:"tokenName",placeholder:"AI Governance Node #123",value:D.name,onChange:h=>n({...D,name:h.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"tokenDescription",children:"Description"}),e.jsx(wt,{id:"tokenDescription",placeholder:"Describe this AI Governance Node...",value:D.description,onChange:h=>n({...D,description:h.target.value})})]})]}),e.jsxs(me,{children:[e.jsx(A,{variant:"outline",disabled:p,children:"Cancel"}),e.jsx(A,{onClick:Y,disabled:p,children:p?"Minting...":"Mint Token"})]})]})]})]}),y.length>0?e.jsx("div",{className:"space-y-4",children:y.map(h=>{var S;return e.jsxs(V,{className:"bg-background p-4 rounded-md shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-muted rounded-full",children:e.jsx(Ee,{className:"h-8 w-8 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold",children:h.metadata.name||`Token #${h.id}`}),e.jsx("p",{className:"text-muted-foreground",children:h.metadata.description||"No description available"})]})]}),e.jsxs(ue,{className:"absolute top-3 right-3 bg-background/80",children:["Token #",h.id]})]}),e.jsxs(G,{className:"pb-2",children:[e.jsxs($,{className:"flex items-center justify-between",children:[e.jsx("span",{children:h.metadata.name||`Token #${h.id}`}),e.jsxs(ue,{variant:"outline",className:"bg-primary/5 flex items-center",children:[e.jsx(Le,{className:"h-3 w-3 mr-1"})," Soulbound"]})]}),e.jsx(H,{children:h.metadata.description||"No description available"})]}),e.jsx(K,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 gap-2",children:(S=h.metadata.attributes)==null?void 0:S.map((v,w)=>e.jsxs("div",{className:"bg-muted/30 p-2 rounded",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:v.trait_type}),e.jsx("div",{className:"font-medium text-sm",children:v.value})]},w))}),e.jsxs("div",{className:"pt-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Token URI"}),e.jsx("div",{className:"font-mono text-xs truncate",children:h.uri})]})]})}),e.jsxs(ve,{className:"flex flex-col space-y-2 bg-muted/10 pt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 w-full",children:[e.jsx(A,{variant:"outline",size:"sm",onClick:()=>window.open(`https://sepolia.etherscan.io/token/${N}?a=${h.id}`,"_blank"),className:"w-full",children:"View on Etherscan"}),e.jsxs(ie,{children:[e.jsx(fe,{asChild:!0,children:e.jsx(A,{variant:"outline",size:"sm",className:"w-full",children:"Update Metadata"})}),e.jsxs(oe,{children:[e.jsxs(le,{children:[e.jsx(ce,{children:"Update Token Metadata"}),e.jsxs(de,{children:["Change the metadata URI for token #",h.id]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"newUri",children:"New Metadata URI"}),e.jsx(ee,{id:"newUri",placeholder:h.uri,defaultValue:h.uri})]}),e.jsxs("div",{className:"bg-muted/30 p-3 rounded-md flex items-start",children:[e.jsx(Me,{className:"h-5 w-5 text-amber-500 mr-2 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium",children:"Warning"}),e.jsx("p",{className:"text-muted-foreground",children:"Updating the metadata URI will change how this token appears. Only admins can perform this action."})]})]})]}),e.jsxs(me,{children:[e.jsx(A,{variant:"outline",onClick:()=>{},children:"Cancel"}),e.jsx(A,{onClick:()=>{const v=document.getElementById("newUri");v&&v.value?_(h.id,v.value):t({title:"Missing URI",description:"Please enter a valid metadata URI.",variant:"destructive"})},disabled:!r,children:"Update URI"})]})]})]})]}),r&&e.jsxs(ie,{children:[e.jsx(fe,{asChild:!0,children:e.jsx(A,{variant:"destructive",className:"w-full",size:"sm",children:"Revoke Token"})}),e.jsxs(oe,{children:[e.jsxs(le,{children:[e.jsx(ce,{className:"text-destructive",children:"Revoke Soulbound Token"}),e.jsxs(de,{children:["This action will permanently revoke token #",h.id,". This cannot be undone."]})]}),e.jsx("div",{className:"bg-destructive/10 p-4 rounded-md my-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Me,{className:"h-5 w-5 text-destructive mr-2 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium",children:"Warning: Destructive Action"}),e.jsx("p",{children:"Revoking this token will remove it from its owner's wallet. Any associated AI Governance Node permissions will be lost."})]})]})}),e.jsxs(me,{children:[e.jsx(A,{variant:"outline",onClick:()=>{},children:"Cancel"}),e.jsx(A,{variant:"destructive",onClick:()=>O(h.id),children:"I understand, revoke this token"})]})]})]})]})]},h.id)})}):e.jsx(V,{className:"p-6 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx("div",{className:"h-16 w-16 rounded-full bg-muted flex items-center justify-center mb-4",children:e.jsx(It,{className:"h-8 w-8 text-muted-foreground/50"})}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Soulbound Tokens Found"}),e.jsx("p",{className:"text-muted-foreground max-w-md mx-auto mb-6",children:"You don't own any Soulbound NFTs that authenticate AI Governance Nodes. These tokens are non-transferable and can only be minted by authorized addresses."}),e.jsxs(A,{variant:"outline",onClick:()=>window.open(`https://sepolia.etherscan.io/token/${N}`,"_blank"),className:"gap-2",children:[e.jsx(ze,{className:"h-4 w-4"}),"View Contract on Etherscan"]})]})})]})}function ns(){const t=[{title:"Total AI Nodes",value:"10",change:"+2 this month",icon:e.jsx(He,{className:"h-5 w-5 text-primary"})},{title:"Governance Proposals",value:"26",change:"+8 this month",icon:e.jsx($e,{className:"h-5 w-5 text-primary"})},{title:"Average Response Time",value:"4.2 hours",change:"-0.5 from last month",icon:e.jsx(se,{className:"h-5 w-5 text-primary"})},{title:"Total Delegations",value:"142",change:"+38 this month",icon:e.jsx(Rt,{className:"h-5 w-5 text-primary"})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-accent/10 p-6 rounded-lg mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"AI Governance Analytics"}),e.jsx("p",{className:"text-muted-foreground",children:"Insights on the performance and impact of D-Loop's AI Governance Nodes. All data is sourced on-chain from protocol activity."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:t.map((s,a)=>e.jsxs(V,{children:[e.jsxs(G,{className:"pb-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx($,{className:"text-sm font-medium text-muted-foreground",children:s.title}),s.icon]}),e.jsx(H,{className:"text-2xl font-bold pt-1",children:s.value})]}),e.jsx(K,{children:e.jsx("p",{className:"text-xs text-muted-foreground",children:s.change})})]},a))}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsxs($,{className:"flex items-center",children:[e.jsx(he,{className:"h-5 w-5 mr-2"})," Governance Node Performance"]}),e.jsx(H,{children:"Comparison of prediction accuracy and response times across nodes"})]}),e.jsx(K,{children:e.jsx("div",{className:"space-y-4",children:[{name:"AI.Gov#01",accuracy:92,responseTime:3.8},{name:"AI.Gov#02",accuracy:88,responseTime:4.2},{name:"AI.Gov#05",accuracy:95,responseTime:2.9},{name:"AI.Gov#07",accuracy:87,responseTime:5.1},{name:"AI.Gov#09",accuracy:91,responseTime:4}].map((s,a)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("div",{children:s.name}),e.jsxs("div",{className:"text-muted-foreground",children:["Accuracy: ",s.accuracy,"%"]})]}),e.jsx(xe,{value:s.accuracy,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[e.jsxs("div",{children:["Response Time: ",s.responseTime," hours"]}),e.jsx("div",{children:s.accuracy>90?" Excellent":s.accuracy>85?" Good":" Needs Improvement"})]})]},a))})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx($,{children:"Top Proposal Categories"}),e.jsx(H,{children:"Distribution of proposal types voted on by AI Nodes"})]}),e.jsx(K,{children:e.jsx("div",{className:"space-y-4",children:[{category:"Parameter Updates",percentage:38},{category:"Asset Investment",percentage:25},{category:"Asset Divestment",percentage:18},{category:"Protocol Upgrades",percentage:12},{category:"Other",percentage:7}].map((s,a)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:s.category}),e.jsxs("span",{children:[s.percentage,"%"]})]}),e.jsx(xe,{value:s.percentage,className:"h-2"})]},a))})})]}),e.jsxs(V,{children:[e.jsxs(G,{children:[e.jsx($,{children:"Delegation Activity"}),e.jsx(H,{children:"Trends in user delegation to governance nodes"})]}),e.jsx(K,{children:e.jsx("div",{className:"h-48 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-muted-foreground",children:[e.jsx("p",{children:"Interactive chart will be available in production"}),e.jsxs(A,{variant:"link",size:"sm",className:"mt-2",onClick:()=>window.open("https://sepolia.etherscan.io/token/0x6391C14631b2Be5374297fA3110687b80233104c","_blank"),children:[e.jsx(ze,{className:"h-4 w-4 mr-1"})," View Contract Activity"]})]})})})]})]})]})}function Ts(){const[t]=ft();return Ne(),t.startsWith("/ai-nodes/")&&t.split("/").length===3?(t.split("/").pop(),e.jsx(Te,{children:e.jsx(_e,{})})):e.jsxs(Te,{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold",children:"AI Governance"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Explore, Delegate and launch AI Governance Nodes"})]})}),e.jsxs(Ue,{defaultValue:"explorer",className:"w-full",children:[e.jsxs(Ve,{className:"mb-6",children:[e.jsxs(q,{value:"explorer",children:[e.jsx(He,{className:"h-4 w-4 mr-2"})," Browse Nodes"]}),e.jsxs(q,{value:"analytics",children:[e.jsx(he,{className:"h-4 w-4 mr-2"})," Analytics"]}),e.jsxs(q,{value:"soulbound",children:[e.jsx($e,{className:"h-4 w-4 mr-2"})," Soulbound Identity"]})]}),e.jsx(X,{value:"explorer",className:"space-y-8",children:e.jsx(_e,{})}),e.jsx(X,{value:"analytics",children:e.jsx(ns,{})}),e.jsx(X,{value:"soulbound",children:e.jsx(as,{})})]})]})}export{Ts as default};
